*** Settings ***
Library				RoboGalaxyLibrary
Library				FusionLibrary
Library				OperatingSystem
Library				BuiltIn
Library				Collections
Library				XML
Library		        SSHLibrary
Library				String
Library				Dialogs

*** Keywords ***

Get connectionTemplateUri
	[Documentation]	Retrieves the connectionTemplateUri from a given network {name} of a given {type} where:
	...             {name} is the name of the network
	...             {type} is the type of network: [ethernet, fc, fcoe], default=ethernet
	...             Returns: connectionTemplateUri string
	[Arguments]		${name}   ${type}=ethernet    ${VERIFY}=${FALSE}    ${STATUS_CODE}=200
    Set Log Level	DEBUG
    ${param} =      Set Variable    ?filter="'name'=='${name}'"
	${net} =		Run Keyword If          '${type}' == 'ethernet'      Fusion Api Get Ethernet Networks    param=${param}
	...             ELSE IF                 '${type}' == 'fc'            Fusion Api Get fc Networks          param=${param}
    ...             ELSE IF                 '${type}' == 'fcoe'          Fusion Api Get fcoe Networks        param=${param}
    ...             ELSE                    Log     Invalid network type specified for 'Get connectionTemplateUri'     WARN
	Run keyword if    '${VERIFY}'=='True'    Should Be Equal    '${net['status_code']}'   '${STATUS_CODE}'    msg=Status Code from Response Not Matching
	${ct_uri} =     Get From Dictionary      ${net['members'][0]}    connectionTemplateUri

    [Return]    ${ct_uri}


Get defaultConnectionTemplate
	[Documentation]	Retrieves the default connectionTemplate.
	...             Returns: connectionTemplateUri string
	[Arguments]		${VERIFY}=${FALSE}    ${STATUS_CODE}=200
	Log    verify is ${VERIFY}
	${dct_uri} =    fusion_api_get_default_connection_template
	Run keyword if    '${VERIFY}'=='True'    Should Be Equal    '${dct_uri['status_code']}'   '${STATUS_CODE}'    msg=Status Code from Response Not Matching
    [Return]    ${dct_uri}


Modify ConnectionTemplateURI
	[Documentation]	Modified the typicalBandwidth and maximumBandwidth values for a connectionTemplate of a given network.
	[Arguments]		${connectionTemplates}        ${VERIFY}=${FALSE}    ${STATUS_CODE}=200
	Log    verify is ${VERIFY}
	:FOR    ${eachCT}  IN  @{connectionTemplates}
    \    ${resp} =     Run keyword if    '${eachCT['name']}' != 'default'     Get connectionTemplateUri    ${eachCT['name']}    ${eachCT['type']} 
    \    ${respCT} =   Run keyword if    '${eachCT['name']}' != 'default'     fusion_api_get_connection_templates    ${resp}
    \    ...      ELSE    fusion_api_get_default_connection_template
    \    Remove From Dictionary    ${respCT}   status   category   created   status_code   state   modified   description   headers
    \    Set To Dictionary	${respCT}    bandwidth    ${eachCT['bandwidth']}
    \    ${respUpdate} =     fusion_api_update_connection_template    ${respCT}   ${respCT['uri']}
    \    Run keyword if    '${VERIFY}'=='True'    Should Be Equal    '${respUpdate['status_code']}'   '${STATUS_CODE}'    msg=Status Code from Response Not Matching
    \    Run keyword if    '${VERIFY}'=='True'    Should Be Equal    ${eachCT['bandwidth']['typicalBandwidth']}  ${respUpdate['bandwidth']['typicalBandwidth']}    msg=typicalBandwidth Not Matching
    \    Run keyword if    '${VERIFY}'=='True'    Should Be Equal    ${eachCT['bandwidth']['maximumBandwidth']}  ${respUpdate['bandwidth']['maximumBandwidth']}    msg=maximumBandwidth Not Matching
	[Return]    ${respUpdate}