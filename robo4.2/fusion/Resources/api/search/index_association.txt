*** Settings ***
Library             RoboGalaxyLibrary
Library             FusionLibrary
Library             OperatingSystem
Library             BuiltIn
Library             Collections
Library             XML
Library             SSHLibrary
Library             String
Library             Dialogs
Library             json
Library             copy

Resource            ../fusion_api_resource.txt


*** Keywords ***
Server Profile Template Should be Compliant
    [Documentation]    Profiles Status Should be expected
    [Arguments]    ${status}=OK
    ${spts} =    Fusion Api Get Server Profile Templates
    Run Keyword If  '${spts['count']}' == '0'  Fail  msg=No templates found
    :FOR  ${spt}  IN  @{spts['members']}
    \    ${spt_to_sps} =  fusion api get index association  ?start=0&count=1000&name=server_profile_template_to_server_profiles&parentUri=${spt['uri']}
    \    SPT To SP Should Be Compliant  ${spt_to_sps}

SPT To SP Should Be Compliant
    [Documentation]    Server Profile Template To Server Profile Should Be Compliant
    [Arguments]  ${spt_to_sps}
    :FOR  ${spt_to_sp}  IN  @{spt_to_sps['members']}
    \    Should Match  ${spt_to_sp['childResource']['attributes']['templateCompliance']}  Compliant  Name ${spt_to_sp['childResource']['name']}
