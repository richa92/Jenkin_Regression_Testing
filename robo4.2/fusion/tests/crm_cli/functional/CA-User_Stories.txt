*** Settings ***
Documentation     Comware Command Alias  - US31795, US31796, US31797, US31822
...    US31795 - Test A01 Can set and use a command alias when in a view
...    US31796 - Test A02 Can unset and no longer use an alias when in the view it was created in
...    US31797 - Test A03 Cannot use a valid command name as an alias
...    US31822 - Test A03 Cannot use a valid command name as an alias
...    = Usage =
...    | pybot | -L DEBUG | -v SWITCH_IP:<Your-Switch-IP> | CA-User_Storuies.txt | 
...    = Variables =
...    | SWITCH IP | Required; IP address or hostname of the Comware Switch |
...    = Preconditions =
...    None

Library           RoboGalaxyLibrary                                     # DVTs Robot Framework extensions
Library           FusionLibrary                # DVTs Robot Framework extensions

Library           String
Library           Collections
Resource         ../resources/defaults.txt
#Resource          ../resources/fusion_api.txt                          # Comet-DVT keyword extensions
Resource          ../resources/switch.txt                               # Comet-DVT keyword extensions
Force Tags        CometTest    LEVEL0                                   # All test cases get these tags
Suite Setup       Login to Switch via SSH    ${SWITCH_IP}
Suite Teardown    Logout of Switch via SSH

*** Variables ***
${systemView_prompt}      ]
${command}                display
${command1}               configuration
${alias}                  show

*** Test Cases ***

Verify Command Alias Can not Be Enabled in User View
	
	${output}=     Switch Execute Command    command-alias enable 
	Should Contain    ${output}    Unrecognized command
	
Enter System View
	
	Switch Execute Command    system-view    ${systemView_prompt}
	Set Suite Variable    ${SWITCH_PROMPT}    ${systemView_prompt}

Enable Command Alias

	${output}=    Switch Execute Command    command-alias enable    
    Should Not Contain    ${output}    Unrecognized command

Verify Command Alias is Enabled
	
    ${output}=    Switch Execute Command      display command-alias
	Should Contain    ${output}     Command alias is enabled

Set Command Alias
	[Documentation]    US31795
	${output}=    Switch Execute Command      display command-alias
	Log    ${output}
    #Undo the command alias mapping, if exists
	${lines}     Get Lines Containing String    ${output}    ${command}
	Log    ${lines}
	Run Keyword if    	'${lines}' != ''      Delete A Command Alias     ${command}
	#Map the command alias
	Switch Execute Command       command-alias mapping ${command} ${alias}
	${display_out}=    Switch Execute Command     ${command} command-alias    
	${alias_out}=    Switch Execute Command     ${alias} command-alias     
	Should Be Equal As Strings     ${display_out}    ${alias_out}

Verity The Same Alias Can Not Be Set By two Commands
    [Documentation]    US31822
	# ${alias} is already mapped by ${command} by previous task  
	${out}=    Switch Execute Command       command-alias mapping ${command1} ${alias}
	Should Contain    ${out}    The input alias is conflict or partly conflict with one of current alias

Unset Command Alias

     Switch Execute Command    undo command-alias mapping ${command}     
	 ${out}=    Switch Execute Command     display command-alias      
	 Should Not Contain    ${out}    ${command}

	 
Verify the the Command Alias Can not be Used after Unset
    [Documentation]    US31796
	${out}=    Switch Execute Command     ${alias} command-alias
	Should Contain    ${out}    Unrecognized command

Verify Valid Command cannot be set as an Alias
    [Documentation]    US31797
	${out}=     Switch Execute Command       command-alias mapping ${command} ${command1}
	Should Contain    ${out}    The alias is in conflict with one of current command keys

#Disable Command Alias

	#${output}=    Switch Execute Command    undo command-alias enable  
    #Should Not Contain    ${output}    Unrecognized command
	
	
*** Keywords ***

Delete A Command Alias
     [Arguments]    ${word}    
     Switch Execute Command    undo command-alias mapping ${word}     
	 ${out}=    Switch Execute Command     display command-alias      
	 Should Not Contain    ${out}    ${word}
	