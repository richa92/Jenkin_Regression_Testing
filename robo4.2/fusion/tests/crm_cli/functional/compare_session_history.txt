*** Settings ***
Documentation     US31790 SwitchHistory: Test G14 Commands in one session do not impact the history in another session
...    = Usage =
...    | pybot | -L DEBUG | -v SWITCH_IP:<Your-Switch-IP> | compare_session_history.txt | 
...    = Variables =
...    | SWITCH IP | Required; IP address or hostname of the Comware Switch |
...    = Preconditions =
...    None

Library           RoboGalaxyLibrary                                     # DVTs Robot Framework extensions
Library           FusionLibrary                                         # DVTs Robot Framework extensions

Library           String
Library           Collections
Resource          ../resources/defaults.txt                             # Comet-DVT default variables
Resource          ../resources/switch.txt                               # Comet-DVT keyword extensions
Force Tags        switch                                                # All test cases get these tags
Suite Setup       
Suite Teardown    Close All Connections

*** Variables ***
@{CmdSet1}=    display fan
...            display fips status
...            display cfd status
...            display dldp
...            display ecmp mode
...            display environment
...            display ddns policy

@{CmdSet2}=    display vlan
...            display rmon prialarm
...            display tcp
...            display user-group 
...            display system-working-mode

@{CmdSet3}=    display igmp-snooping
...            display mld-snooping 
...            display mpls ldp summary
...            display private-vlan 
...            display placement policy program default
...            display memory 
...            display scheduler schedule 
...            display port-security  
...            display storm-constrain 

*** Test Cases ***
Send Display Commands To Session 1 
  ${ConectionId1}=    Login to Switch via SSH
  Log    ${ConectionId1}
  Execute Switch Commands    ${CmdSet1}
  Set Suite Variable    ${ConectionId1}    ${ConectionId1}

Send Display Commands To Session 2  
  ${ConectionId2}=    Login to Switch via SSH
  Log    ${ConectionId2}
  Execute Switch Commands    ${CmdSet2}
  Set Suite Variable    ${ConectionId2}    ${ConectionId2}

Send Display Commands To Session 3  
  ${ConectionId3}=    Login to Switch via SSH
  Log    ${ConectionId3}
  Execute Switch Commands    ${CmdSet3}
  Set Suite Variable    ${ConectionId3}    ${ConectionId3}

Check History On Session 1  
  # Connect back to Session 1 -- ${ConectionId1} -- and get the history contents and compare with sent list
  ${PreviousConnection}=    Switch Connection    ${ConectionId1}     
  Log    ${PreviousConnection}
  ${HistoryList1}=    Get Command History
  Log List    ${HistoryList1}
  # Remove the last display history command from the list, before compare
  Remove From List    ${HistoryList1}   -1
  Log List    ${CmdSet1}
  Log List    ${HistoryList1}
  Lists should be equal  ${CmdSet1}  ${HistoryList1}	

Check History On Session 3
  # Connect back to Session 3 -- ${ConectionId3} -- and get the history contents and compare with sent list
  ${PreviousConnection}=    Switch Connection    ${ConectionId3}     
  Log    ${PreviousConnection}
  ${HistoryList3}=    Get Command History
  # Remove the last display history command from the list, before compare
  Remove From List    ${HistoryList3}   -1
  Log List    ${CmdSet3}
  Log List    ${HistoryList3}
  Lists should be equal  ${CmdSet3}  ${HistoryList3}	  
    
Check History On Session 2
  # Connect back to Session 2 -- ${ConectionId2} -- and get the history contents and compare with sent list
  ${PreviousConnection}=    Switch Connection    ${ConectionId2}     
  Log    ${PreviousConnection}
  ${HistoryList2}=    Get Command History
  # Remove the last display history command from the list, before compare
  Remove From List    ${HistoryList2}   -1
  Log List    ${CmdSet2}
  Log List    ${HistoryList2}
  Lists should be equal  ${CmdSet2}  ${HistoryList2}	  
  
 