*** Settings ***
Documentation      Continuous Integration Tests for RoboGalaxy dev Branch
Resource           F1290-OVAConfig.txt
Force Tags         Buildup
Suite Setup         Load Test Data and Open Browser
Suite Teardown      Logout And Close All Browsers

*** Variables ***
${network_xpath}      network-scope


*** Test Cases ***
Verifying User privileges on Scopes

    Set Log Level    TRACE
    Log Variables
    ${user} =  Get Data By Property  ${TestData.users}  name  Administrator
    Fusion UI Login to Appliance   ${user[0].name}


Pre-Requisites:Import Enc and create Network resources
    ${user} =  Get Data By Property  ${TestData.users}  name  Administrator
    Fusion UI Login to Appliance   ${user[0].name}
    Fusion UI Delete All Scopes
    Fusion UI Delete All Appliance Networks
    Fusion UI Remove User   @{TestData.users}
    Fusion UI Remove All Enclosures
    Fusion UI Remove All Enclosure Groups
    Fusion UI Remove All Logical Interconnect Groups
    Fusion UI Delete All Network Sets

Step1: Create less privileged users
    Fusion UI Create User   @{TestData.users}
    Log to console  \nUser Groups has been created

Step2: Create 5 scopes with maximum characters in name and description
    Fusion UI Create Scope  @{TestData.max_scopes}
    Log to console  \nStep2 completed successfully

Step3: Create Resources and assign it to scopes
    Fusion UI Create Ethernet Network   @{TestData.Ethernet_Networks}
    Fusion UI Create FC Network   @{TestData.FC_Networks}
    Fusion UI Create FCOE Network   @{TestData.FcoE_Networks}
    Fusion UI Create Network Set    @{TestData.NetworkSet}
    Fusion UI Create Logical Interconnect Group     @{TestData.ligs}
    Fusion UI Create Enclosure Group    @{TestData.encgroups}
    Fusion UI Add Enclosure     @{TestData.enclosures}

Assigning resources to scopes
    Fusion UI Edit Scope    @{TestData.max_scopes}
    Log to console  \nResources assigned to scopes successfully
    ${status}   Fusion UI Validate Resource Assigned To Scope     @{TestData.Validate_max_scopes}
    Run Keyword If  '${status}' == 'True'   Log to console  \nValidation completed successfully     ELSE    Fail
    Fusion UI Logout of Appliance


Step4 and Step5: Login as Server Admin and other less privileged user anf verify filter function
    ${Length} =     Get Length      ${TestData.users}
    :For    ${index}    IN Range    2   ${Length}
    \   Fusion UI Login to Appliance   ${TestData.users[${index}].name}
    \   ${Return}     Fusion UI Validate Privilege For Users
    \   Run Keyword If      '${Return}' == 'True'   Log to console  \n user: ${TestData.users[${index}].name} has no privilege on scope
    \   ...         ELSE    FAIL
    \   Log to Console  \nFiltering scopes in Networks page
    \   Fusion UI Navigate To Networks Page
    \   ${Return}    Fusion UI Filter by Any Scope    ${network_xpath}    @{TestData.Network_filter_by_Any}
    \   Run keyword If  '${Return}' == 'True'     Log to console  \nVerified the resources in filter
    \   ...         ELSE    Fail
    \   ${Return}     Fusion UI Filter by Scope    ${network_xpath}        @{TestData.Validate_max_scopes}
    \   Run keyword If  '${Return}' == 'True'     Log to console  \nVerified the resources in filter
    \   ...         ELSE    FAIL
    \   ${Return}    Fusion UI Filter by All Scope    ${network_xpath}    @{TestData.Network_filter_by_All}
    \   Run keyword If  '${Return}' == 'True'     Log to console  \nVerified the resources in filter
    \   ...         ELSE    FAIL
    \   Fusion UI Logout of Appliance
    ${user} =    Get Data By Property    ${TestData.users}  name  Administrator
    Fusion UI Login to Appliance   ${user[0].name}



