*** Settings ***
Documentation      Scope using FusionLibrary API keywords
Variables          ../F1290/data_variables.py
Resource	   ../F1290/resource.txt
Library            json
Library            FusionLibrary
Library            RoboGalaxyLibrary
Library            Collections
Library            SSHLibrary
#Suite Teardown		Suite Teardown

*** Variables ***
${APPLIANCE_IP}   15.245.131.62

*** Test Cases ***

1. Login 
 
    [Tags]  add   POSITIVE
    Set Log Level    TRACE
	
	${resp}		Fusion Api Login Appliance    ${APPLIANCE_IP}        ${admin_credentials_TB}
	Run Keyword If  '${resp[0]['status_code']}' != '200'  Fail	ELSE  Log to console  \nSuccessfully Logged into the appliance
	
	Remove All Scopes
		
2.Create Scope with maximum characters

	[Tags]  add   POSITIVE
    Set Log Level    TRACE
	
	:FOR	${i}	IN RANGE	0	10
	\	Set to Dictionary	${scope_1[0]}	name=Scopewith90charactersScopewith90charactersScopewith90charactersScopewith90charactersScopeScopeScope${i}
	\	${resp}		Fusion Api Create Scope		body=${scope_1[0]}
	\	Run Keyword If  '${resp['status_code']}' != '201'	Fail	\n\nFailed to create scope:${resp['message']}
	\	...				ELSE 	Log to console  \nSuccessfully created the scope with max characters: Scope${i}
	
3.Create Scope with Max lines of description

	[Tags]  add   POSITIVE
    Set Log Level    TRACE
		
	Set to Dictionary	${scope_1[1]}	description=Creating scopes with maximum of 1024 characters in description section-Creating scopes with maximum of 1024 characters in description section-Creating scopes with maximum of 1024 characters in description section-Creating scopes with maximum of 1024 characters in description section-Creating scopes with maximum of 1024 characters in description section-Creating scopes with maximum of 1024 characters in description section-Creating scopes with maximum of 1024 characters in description section-Creating scopes with maximum of 1024 characters in description section-Creating scopes with maximum of 1024 characters in description section-Creating scopes with maximum of 1024 characters in description section-Creating scopes with maximum of 1024 characters in description section-Creating scopes with maximum of 1024 characters in description section-Creating scopes with maximum of 1024 characters in description section-Creating scopes with maximum of 1024 characters in description section- Creating scopes with maximum 
	
	${resp}		Fusion Api Create Scope		body=${scope_1[1]}
	Run Keyword If  '${resp['status_code']}' != '201'	Fail	\n\nFailed to create scope: ${resp['message']}    
	...				ELSE 	Log to console  \nSuccessfully created the scope with max characters in description
	
4.Assigning Bulk no.of Resources to a scope

	[Tags]  add   POSITIVE
    Set Log Level    TRACE
	#Remove ALL Ethernet Networks
	
	${UriList} =	Create List
	#${body} =	Get Variable value	${Bulk_enet}
	#Set to Dictionary	${body}	vlanIdRange=2-1000
	
	#${resp}		Fusion Api Create Ethernet Bulk Networks	body=${body}
	#Log to console	\n response content ${resp}
	#${task} =	Wait For Task	${resp}		600s	60s
		
	${networks} = 	Fusion Api Get Ethernet Networks
	:FOR	${net}	IN	@{networks['members']}
	\		Append to List	${UriList}	${net['uri']}
	\	log to console	append list is:${UriList}
	
	${Scopeuri} =	Get Scope URI	S2
	${ScopeUri1} =  Catenate    SEPARATOR=/     ${Scopeuri}     resource-assignments
	Log to console	\nScope uri: ${Scopeuri}
	${body} =	Get Variable value	${scope_resources}
	Set to Dictionary	${body}		addedResourceUris=${UriList}
	log to console	thefinalbody is:${body}
	
	${resp}		fusion_api_patch_scope		body=${body}	uri=${ScopeUri1}
	log to console	thefinalresp is:${resp}
	${task} =	Wait For Task1	${resp}		820s	60s
		
	Log to console	\n-Displaying the assigned resources from scope
	${resp} =	Filter By	ethernet-networks	S2
	
	Remove All Scopes
	Remove ALL Ethernet Networks	