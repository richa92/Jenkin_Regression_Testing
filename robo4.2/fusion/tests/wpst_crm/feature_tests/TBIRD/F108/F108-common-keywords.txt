*** Settings ***
Documentation		Feature Test: F108 Switch Life Cycle for TClass
...					Usage:
...						BB58 ME: pybot -V bb58_me_variables.py -v APPLIANCE_IP:15.199.232.97 feature_test_F105.txt
...						DCS ME: pybot -V dcs_variables.py feature_test_F105.txt

Variables 		    data_variables.py

#Suite Setup   		Run FTS and test-specific setup
#Suite Teardown		Teardown

Resource            ../../../../resource/fusion_api_all_resource_files.txt

Library				Collections
Library             Dialogs
Library             json

*** Variables ***
${ICM_MODEL}                     Virtual Connect SE 40Gb F8 Module for Synergy

${SSH_PASS}           hpvse1
${FUSION_IP}					${APPLIANCE_IP}
${ENC1}               CN754406W7
${ENC2}               CN7544044C
${ENC3}               CN754406WT

${bay2}               2
${bay3}               3
${bay6}               6

${enc1bay2}           CN754406W7, interconnect 2
${enc1bay3}           CN754406W7, interconnect 3
${enc1bay5}           CN754406W7, interconnect 2
${enc1bay6}           CN754406W7, interconnect 3

${enc2bay2}           CN7544044C, interconnect 2
${enc2bay3}           CN7544044C, interconnect 3
${enc2bay5}           CN7544044C, interconnect 5
${enc2bay6}           CN7544044C, interconnect 6

${enc3bay2}           CN754406WT, interconnect 2
${enc3bay3}           CN754406WT, interconnect 3
${enc3bay5}           CN754406WT, interconnect 5
${enc3bay6}           CN754406WT, interconnect 6

${efuse_sleeptime}    120
${efuse_remove_sleeptime}    120
${efuse_add_sleeptime}    400

*** Test Cases ***

*** Keywords ***
Add Users, Networks and Login
	Set Log Level	DEBUG
    Get VM IP   ${VM}

   	Fusion Api Login Appliance 		${APPLIANCE_IP}		${admin_credentials}
    Add Users from variable     ${users}
    Add Ethernet Networks from variable		${ethernet_networks}
    Add FCoE Networks from variable		${fcoe_networks}
    Login all users     ${users}
    fusion api switch active user    user=Networkadmin

Get IC
    ${resp} =   fusion api get interconnect
    ${ics} =     Get From Dictionary     ${resp}    members
	${l} = 	Get Length	${ics}
	:FOR	${x}	IN RANGE	0	${l}
    \   ${ic} =     Get From List   ${ics}    ${x}
	\ 	Exit For Loop If 	'${ic['model']}' == '${ICM_MODEL}'
	[Return]    ${ic}

Get ICM state
	[Arguments]	${ICMlocation}

    Set Log Level  TRACE
    # Get ICM state ${enc1} ${bay2}

    :FOR  ${x}        IN            @{icms}
    \    ${resp} =    Fusion Api Get Interconnect    param=?filter="'name'=='${x}'"
    \    Log to console and logfile    \n${resp['members'][0]['name']} state:${resp['members'][0]['state']}

Get Profile status
	[Arguments]	${profilestatus}

    Set Log Level  TRACE

    ${3enc-server-profiles} =   json.loads    ["Enc1-CN754406W7-bay-1","Enc2-CN7544044C-bay-1","Enc2-CN7544044C-bay-4","Enc3-CN754406WT-bay-1","Enc3-CN754406WT-bay-4"]

    :FOR  ${x}        IN            @{3enc-server-profiles}
    \    ${resp} =    Fusion Api Get Server profiles  param=?filter="'name'=='${x}'"
    # \    Log to console and logfile    \n${resp['members'][0]['name']} state:${resp['members'][0]['state']}
    \    Should Be Equal As Strings    ${resp['members'][0]['status']}  ${profilestatus}
