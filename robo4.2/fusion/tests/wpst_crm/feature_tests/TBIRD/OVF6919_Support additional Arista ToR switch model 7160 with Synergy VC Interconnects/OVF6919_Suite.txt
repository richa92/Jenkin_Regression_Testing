**Settings***
Documentation   OVF6919
Library         json
Library         FusionLibrary
Library         RoboGalaxyLibrary
Library         Collections
Library         SSHLibrary
Library         String
Resource            ../../../../../Resources/api/fusion_api_resource.txt
Resource           OVF6919_keywords.txt
Library         Telnet
Library         backping.py
Library             Dialogs
Variables       datavariables_potash.py
Variables       datavariables_nitro.py
Suite Setup          Clean OV

***Test cases***
1 Login to Appliance
    [Documentation]    Login to Appliance
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    ${resp}    Fusion Api Login Appliance    ${APPLIANCE_IP}        ${appliance_credentials}

2 Creating Networks,LIG,EG,LE
    [Documentation]    Creating Networks,LIG,EG,LE
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Log    \n Creating setup for single potash with one switch     console=True
    Log    \n\n Creating Ethernet network    console=True
    Add Ethernet Networks from variable    ${ethernet_networks}

    Log   \n\n Creating LIG     console=True
    Add LIG from variable    ${lig}

    Log     \n\nCreating EG    console=True
    ${resp} =    Add Enclosure Group from variable    ${enc_group['EG']}
    Run Keyword If  ${resp['status_code']} != 201    fail    msg=\nUnable to create EG
    ...         ELSE    log    \nsuccessfully created EG

    Log     \n\n Creating LE     console=True
    Add Logical Enclosure from variable    ${LE['LE']}


3 Verifying Interconnect state and port status after creating LE
    [Documentation]    Verifying Interconnect state and port status after creating LE
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Log     \n\nVerifying the interconnects are in configured state    console=True
    :FOR    ${x}    IN    @{Interconnect_dto}
    \    Wait Until Keyword Succeeds    2 min    60s    Verify Interconnect    ${x}    state=Configured

    Log    Fetching ICM URI    console=True
    :FOR    ${icm}    IN    @{Interconnect_name}
    \    ${uri} =    Get IC URI    ${icm}
    \    Run Keyword If    '${icm}' == '${Interconnect_name[0]}'    Set Suite Variable    ${ICM2_uri}    ${uri}
    \    ...    ELSE IF    '${icm}' == '${Interconnect_name[1]}'    Set Suite Variable    ${ICM5_uri}    ${uri}

    Log    \n\nVerifying port status after creating LE    console=True
    :FOR    ${icm}    IN       @{UP_Ports_TC1}
    \    Wait Until Keyword Succeeds    15 min    20s     Verify Port    ${ICM2_uri}     ${icm}     status=OK     portStatus=Linked

4 Creating LSG
    [Documentation]    creating LSG
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Log    \n\nCreating LSG    console=True
    Add Logical Switch Group from variable    ${LSG1}

5 Creating LS in Monitored mode
    [Documentation]    Creating LS in Monitored mode
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Log    \n\nCreating LS in Monitored mode     console=True
    Add Logical Switch    ${LS1}

6 Edit LS to change from Monitored mode to Managed Mode
    [Documentation]    Editing LS to change from Monitored mode to Managed Mode
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Log    \n\nEditing LS to Managed mode    console=True
    ${resp}    Edit LS    ${LSG}    ${LS1_edit}
    Wait For Task2    ${resp}    20min    1min

6_ Login to switch and verify ports are enabled
    [Documentation]    Login to switch and verify ports are enabled
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro
    #Log    \nLogin to switch and verify all switch ports are in connected state    console=True
    Login to switch and enable switch port    ${switch1_info}

7 Verifying Interconnect state and Port status after creating LS
    [Documentation]    Verifying IC state and port status after creating LS
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Log     \n\nVerifying the interconnects are in configured state    console=True
    :FOR    ${x}    IN    @{Interconnect_dto}
    \    Wait Until Keyword Succeeds    5 min    60s    Verify Interconnect    ${x}    state=Configured

    Log    Fetching ICM URI    console=True
    :FOR    ${icm}    IN    @{Interconnect_name}
    \    ${uri} =    Get IC URI    ${icm}
    \    Run Keyword If    '${icm}' == '${Interconnect_name[0]}'    Set Suite Variable    ${ICM2_uri}    ${uri}
    \    ...    ELSE IF    '${icm}' == '${Interconnect_name[1]}'    Set Suite Variable    ${ICM5_uri}    ${uri}

    Log    \n\nVerifying port status after creating LS   console=True
    :FOR    ${icm}    IN       @{UP_Ports_TC1}
    \    Wait Until Keyword Succeeds    15 min    20s     Verify Port    ${ICM2_uri}     ${icm}     status=OK     portStatus=Linked

8 Validating stacking state of ls after creating LS
    [Documentation]     Validating stacking state of ls after creating LS
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Log    \n\nValidating stacking state of LS     console=True
    Wait Until Keyword Succeeds    3 min    20s    Verify Stacking state of LS

9 Validating stacking member id of Ls
    [Documentation]    Validating stacking member id of Ls
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Log    \n\nValidating stacking member id    console=True
    Validating stacking member id of switch    ${role_name}

10 Validating uplinkports from potash connected to Arista ports as Neigbor
    [Documentation]     Validating uplinkports from potash connected to Arista ports as Neigbor
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Log    \nValidate Neighbor information    console=True
    ${l}    Get Length    ${UP_Ports_TC1}
    :FOR    ${x}    IN RANGE    0    ${l}
    \    Validate Neighbor Information    ${SWITCH1}    ${Switch_ports_TC1[${x}]}    ${UP_Ports_TC1[${x}]}

11 Creating server profile
    [Documentation]    creating server profile
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Log    \n\n Creating server profile    console=True
    ${resp}    Add Server Profiles from variable   ${server_profiles}

    ${l}    Get Length    ${resp}
    :FOR    ${x}    IN RANGE    0   ${l}
    \    Run Keyword If  '${resp[${x}]['status_code']}' == '202'    Wait For Task2    ${resp[${x}]}    20m    1m    ELSE    Fail    Log    failed    console=True
    \    Power on server    ${server_profiles[${x}]['serverHardwareUri']}
    Sleep    10min

12 Getting Server IP and pinging from server1 to gateway ip and server1 to server2 verifying loss
    [Documentation]    Getting Server IP and pinging IP,verifying packet loss
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Log    \n\n Getting Ip and gateway ip of server enc1 bay1    console=True
    ${IP1}    ${gate_ip1}    Get Server Ip Windows    ${ilo_details_enc1_bay1}
    Set Global Variable    ${server_ip1}    ${IP1[0]}
    Set Global Variable    ${gateway_ip}    ${gate_ip1}

    Log    \n\n Getting Ip and gateway ip of server enc2 bay1    console=True
    ${IP2}    ${gate_ip2}    Get Server Ip Windows   ${ilo_details_enc2_bay1}
    Set Global Variable    ${server_ip2}    ${IP2[0]}
    Set Global Variable    ${gateway_ip2}    ${gate_ip2}

    Log    \n\nServer1toserver2ping    console=True

    Ping IP Continuously    ${server_ip1}    ${server1_details['username']}     ${server1_details['password']}     ${IP2}    ${ping_cont_server1}

    Log    \n\n server1 toGatewayping    console=True
    Ping IP Continuously    ${server_ip1}    ${server1_details['username']}     ${server1_details['password']}     ${gate_ip1}    ${ping_gateway_cont_server1}

13 Pinging from Server2 to gateway and Ping from server2 to server1 and verifying loss
    [Documentation]    Getting Server IP and pinging IP,verifying packet loss
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Log    \n\n Getting Ip and gateway ip of server enc1 bay1    console=True
    ${IP1}    ${gate_ip1}    Get Server Ip Windows    ${ilo_details_enc1_bay1}
    Set Global Variable    ${server_ip}    ${IP1[0]}
    Set Global Variable    ${gateway_ip}    ${gate_ip1}

    Log    \n\n Getting Ip and gateway ip of server enc2 bay1    console=True
    ${IP2}    ${gate_ip2}    Get Server Ip Windows   ${ilo_details_enc2_bay1}
    Set Global Variable    ${server_ip2}    ${IP2[0]}
    Set Global Variable    ${gateway_ip2}    ${gate_ip2}

    Log    \n\nserver2toserver1 ping     console=True
    Ping IP Continuously    ${server_ip2}    ${server2_details['username']}     ${server2_details['password']}     ${IP1}    ${ping_cont_server2}

    Log    \n\nserver2toGatewayping    console=True

    Ping IP Continuously    ${server_ip2}    ${server2_details['username']}     ${server2_details['password']}     ${gate_ip2}    ${ping_gateway_cont_server2}

14 Edit LS to change from Managedmode to MonitoredMode
    [Documentation]    Edit LS to change from  Managed mode to Monitored Mode
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    #Log    \n\nEditing LSfromManagedmode toMonitoredmode    console=True
    ${resp}    Edit LS    ${LSG}    ${LS2_edit}
    Wait For Task2    ${resp}    20min    1min

15 Stop Traffic and Validate Packet Loss
    [Documentation]    Kill Traffic and Validate Packet Loss
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Kill Traffic   ${server_ip1}    ${server1_details['username']}     ${server1_details['password']}     ${kill_cmd}
    Kill Traffic   ${server_ip2}    ${server2_details['username']}     ${server2_details['password']}     ${kill_cmd}

    Log    \n\nVerifying packet loss     console=True
    Verifying packet loss    ${text_names}

16 Edit LS to change from Monitored mode to Managed Mode
    [Documentation]    Editing LS to change from Monitored mode to Managed Mode
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Log    \n\nEditing LS to Managed mode    console=True
    ${resp}    Edit LS    ${LSG}    ${LS1_edit}
    Wait For Task2    ${resp}    20min    1min


###### Test case 2 ULS ports span both Potash/Nitro and all ports are connected to a single Arista ToR switch in a 2 switch configuration (Single-homed from each Potash/Nitro)  ##################

2_1 Editing uplinkset to change uplinkports from both Nitro connected to single Arista switches
    [Documentation]    Editing uplinkset to change uplinkports from both potash connected to single Arista switches
    Set Log Level    TRACE
    [Tags]    Nitro
    [Tags]    Potash

    Add Uplinkset from variable    ${uplinkset_unsplitter_li}

2_2 Verifying Interconnect state and Port status after editing LI
    [Documentation]    Verifying IC state and port status after editing LI
    Set Log Level    TRACE
    [Tags]    Nitro
    [Tags]    Potash

    Log     \n\nVerifying the interconnects are in configured state    console=True
    :FOR    ${x}    IN    @{Interconnect_dto}
    \     Wait Until Keyword Succeeds    5 min    60s     Verify Interconnect    ${x}    state=Configured


    Log    Fetching ICM URI    console=True
    :FOR    ${icm}    IN    @{Interconnect_name}
    \    ${uri} =    Get IC URI    ${icm}
    \    Run Keyword If    '${icm}' == '${Interconnect_name[0]}'    Set Suite Variable    ${ICM2_uri}    ${uri}
    \    ...    ELSE IF    '${icm}' == '${Interconnect_name[1]}'    Set Suite Variable    ${ICM5_uri}    ${uri}

    Log    \n\nVerifying port status after editing LI    console=True
    :FOR    ${icm}    IN       @{Uplink_bay2}
    \    Wait Until Keyword Succeeds    15 min    20s      Verify Port    ${ICM2_uri}     ${icm}     status=OK     portStatus=Linked

    :FOR    ${icm}    IN       @{Uplink_bay5}
    \    Wait Until Keyword Succeeds    15 min    20s     Verify Port    ${ICM5_uri}     ${icm}     status=OK     portStatus=Linked


2_3 Editing server connections
    [Documentation]    Editing server connections
    Set Log Level    TRACE
    [Tags]    Nitro
    [Tags]    Potash

    Log    \n\n Powering off servers    console=True
    Power off ALL Servers    PressAndHold
    ${resp}    Edit Server Profiles from variable    ${Edit_server_profiles1}
    Wait For Task2    ${resp}    10min    1min

    ${l}    Get Length    ${Edit_server_profiles1}
    :FOR    ${x}    IN RANGE    0   ${l}
    \    Power on server    ${Edit_server_profiles1[${x}]['serverHardwareUri']}
    Sleep    10min

2_4 Validating Stacking state of LS after editing uplinkset
    [Documentation]    Validating Stacking state of LS after editing uplinkset
    Set Log Level    TRACE
    [Tags]    Nitro
    [Tags]    Potash

    Log    \n\nValidating stacking state of LS    console=True
    Wait Until Keyword Succeeds    3 min    20s     Verify Stacking state of LS

2_5 Validating stacking member id of Ls
    [Documentation]    Validating stacking member id of Ls
    Set Log Level    TRACE
    [Tags]    Nitro
    [Tags]    Potash

    Log    \n\nValidating stacking member id    console=True
    Validating stacking member id of switch    ${role_name}

2_6 Validating uplinkports from potash connected to Arista ports as Neigbor
    [Documentation]     Validating uplinkports from potash connected to Arista ports as Neigbor
    Set Log Level    TRACE
    [Tags]    Nitro
    [Tags]    Potash

    Log    \nValidate neighbor information    console=True
    ${l}    Get Length    ${UP_Ports_TC3}
    :FOR    ${x}    IN RANGE    0    ${l}
    \    Validate Neighbor Information    ${SWITCH1}    ${Switch_ports_TC3[${x}]}    ${UP_Ports_TC3[${x}]}

2_7 Getting Server IP and pinging from server1 to gateway ip and server1 to server2 verifying loss
    [Documentation]    Getting Server IP and pinging IP,verifying packet loss
    Set Log Level    TRACE
    [Tags]    Nitro
    [Tags]    Potash

    Log    \n\n Getting Ip and gateway ip of server enc1 bay1    console=True
    ${IP1}    ${gate_ip1}    Get Server Ip Windows    ${ilo_details_enc1_bay1}
    Set Global Variable    ${server_ip1}    ${IP1[0]}
    Set Global Variable    ${gateway_ip}    ${gate_ip1[0]}

    Log    \n\n Getting Ip and gateway ip of server enc2 bay1    console=True
    ${IP2}    ${gate_ip2}    Get Server Ip Windows   ${ilo_details_enc2_bay1}
    Log    \n\n server1 toGatewayping    console=True
    Ping IP and Verify packet loss    ${server_ip1}    ${server1_details['username']}     ${server1_details['password']}    ${gate_ip1}     ${ping_gateway_server1}    ${file2}

    Log    \n\nServer1toserver2ping    console=True

    Ping IP and Verify packet loss    ${server_ip1}    ${server1_details['username']}     ${server1_details['password']}     ${IP2}    ${ping_cmd_server1}    ${file1}

2_8 Pinging from Server2 to gateway and Ping from server2 to server1 and verifying loss
    [Documentation]    Getting Server IP and pinging IP,verifying packet loss
    Set Log Level    TRACE
    [Tags]    Nitro
    [Tags]    Potash

    Log    \n\n Getting Ip and gateway ip of server enc1 bay1    console=True
    ${IP1}    ${gate_ip1}    Get Server Ip Windows    ${ilo_details_enc1_bay1}

    Log    \n\n Getting Ip and gateway ip of server enc2 bay1    console=True
    ${IP2}    ${gate_ip2}    Get Server Ip Windows   ${ilo_details_enc2_bay1}
    Set Global Variable    ${server_ip2}    ${IP2[0]}
    Set Global Variable    ${gateway_ip2}    ${gate_ip2[0]}

    Log    \n\nserver2toGatewayping    console=True

    Ping IP and Verify packet loss    ${server_ip2}    ${server2_details['username']}     ${server2_details['password']}     ${gate_ip2}    ${ping_gateway_server2}    ${file3}

    Log    \n\nserver2toserver1 ping     console=True

    Ping IP and Verify packet loss    ${server_ip2}    ${server2_details['username']}     ${server2_details['password']}     ${IP1}    ${ping_cmd_server2}    ${file4}


###### Power on/off Interconnect in single homed configuration ##########
3_1 Powering off the potash modules in single homed configuration
    [Documentation]    Powering off the potash modules in single homed configuration
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Log    Fetching ICM URI    console=True
    :FOR    ${icm}    IN    @{Interconnect_name}
    \    ${uri} =    Get IC URI    ${icm}
    \    Run Keyword If    '${icm}' == '${Interconnect_name[0]}'    Set Suite Variable    ${ICM2_uri}    ${uri}
    \    ...    ELSE IF    '${icm}' == '${Interconnect_name[1]}'    Set Suite Variable    ${ICM5_uri}    ${uri}

    Patch Interconnect     ${Interconnect_dto[1]}    op=replace    path=/powerState    value=Off    timeout=60   interval=10
    Wait Until Keyword Succeeds    5 min    20s      IC reached state    ${ICM5_uri}    Maintenance
    Sleep    60sec

3_2 Powering on the master ICM
    [Documentation]    Powering on the master ICM
    [Tags]    Potash
    [Tags]    Nitro

    Patch Interconnect     ${Interconnect_dto[1]}    op=replace  path=/powerState  value=On  timeout=60  interval=10

    Wait Until Keyword Succeeds    15 min    20s      IC reached state    ${ICM5_uri}    Configured

    Wait Until Keyword Succeeds     5 min   10s      Get Interconnect stackingDomainRole    ${Interconnect_name[1]}    Subordinate

    Wait Until Keyword Succeeds     5 min   10s      Get Interconnect stackingDomainRole    ${Interconnect_name[0]}    Master

3_3 Verifying Interconnect state and Port status after editing LI
    [Documentation]    Verifying IC state and port status after editing LI
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Log     \n\nVerifying the interconnects are in configured state    console=True
    :FOR    ${x}    IN    @{Interconnect_dto}
    \     Wait Until Keyword Succeeds    10 min    60s     Verify Interconnect    ${x}    state=Configured


    Log    Fetching ICM URI    console=True
    :FOR    ${icm}    IN    @{Interconnect_name}
    \    ${uri} =    Get IC URI    ${icm}
    \    Run Keyword If    '${icm}' == '${Interconnect_name[0]}'    Set Suite Variable    ${ICM2_uri}    ${uri}
    \    ...    ELSE IF    '${icm}' == '${Interconnect_name[1]}'    Set Suite Variable    ${ICM5_uri}    ${uri}

    Log    \n\nVerifying port status after editing LI    console=True
    :FOR    ${icm}    IN       @{Uplink_bay2}
    \    Wait Until Keyword Succeeds    15 min    20s      Verify Port    ${ICM2_uri}     ${icm}     status=OK     portStatus=Linked

    :FOR    ${icm}    IN       @{Uplink_bay5}
    \    Wait Until Keyword Succeeds    15 min    20s     Verify Port    ${ICM5_uri}     ${icm}     status=OK     portStatus=Linked

3_4 Verifying switch port status
    [Documentation]    Verifying switch port status
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    :FOR    ${icm}    IN       @{Switch_ports_TC3}
    \    Wait Until Keyword Succeeds    15 min    60s    Verify switch port status    ${SWITCH1}    ${icm}    status=Linked

3_5 Validating Stacking state of LS after editing poweron/off
    [Documentation]    Validating Stacking state of LS
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Log    \n\nValidating stacking state of LS    console=True
    Wait Until Keyword Succeeds    3 min    20s     Verify Stacking state of LS


3_6 Validating stacking member id of Ls
    [Documentation]    Validating stacking member id of Ls
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Log    \n\nValidating stacking member id    console=True
    Validating stacking member id of switch    ${role_name}


3_7 Validating uplinkports from potash connected to Arista ports as Neigbor
    [Documentation]     Validating uplinkports from potash connected to Arista ports as Neigbor
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Log    \nValidate neighbor information    console=True
    ${l}    Get Length    ${UP_Ports_TC3}
    :FOR    ${x}    IN RANGE    0    ${l}
    \    Validate Neighbor Information    ${SWITCH1}    ${Switch_ports_TC3[${x}]}    ${UP_Ports_TC3[${x}]}

3_8 Powering on/off the subordinate icm
    [Documentation]    Powering on/off the subordinate icm
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Patch Interconnect     ${Interconnect_dto[0]}    op=replace    path=/powerState    value=Off   timeout=60   interval=10
    Wait Until Keyword Succeeds    10 min    20s      IC reached state    ${ICM2_uri}    Maintenance

    Patch Interconnect     ${Interconnect_dto[0]}    op=replace    path=/powerState    value=On    timeout=60   interval=10
    Wait Until Keyword Succeeds    15 min    20s      IC reached state    ${ICM2_uri}    Configured

    Wait Until Keyword Succeeds    15 min    20s      IC reached state    ${ICM5_uri}    Configured

    Wait Until Keyword Succeeds     5 min   10s      Get Interconnect stackingDomainRole    ${Interconnect_name[1]}    Master

    Wait Until Keyword Succeeds     5 min   10s      Get Interconnect stackingDomainRole    ${Interconnect_name[0]}    Subordinate


####Test Case-4 EfuseOn/Off interconnect modules with single homed configuration ######
4_1 Efuse remove the interconnect modules in single homed configuration
    [Documentation]    Efuse remove the interconnect modules in single homed configuration
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Log    Fetching ICM URI    console=True
    :FOR    ${icm}    IN    @{Interconnect_name}
    \    ${uri} =    Get IC URI    ${icm}
    \    Run Keyword If    '${icm}' == '${Interconnect_name[0]}'    Set Suite Variable    ${ICM2_uri}    ${uri}
    \    ...    ELSE IF    '${icm}' == '${Interconnect_name[1]}'    Set Suite Variable    ${ICM5_uri}    ${uri}
    Get EM IP    ${ENC2}
    Get EM Token    ${ENC2}
    Efuse ICM    EFuseOn    ${Bay_Number[1]}
    Log    \n\n Verifying if module is absent    console=True
    Wait Until Keyword Succeeds    15 min    20s      IC reached state    ${ICM5_uri}    Absent

4_2 Efuse insert the interconnect modules in single homed configuration
    [Documentation]    Efuse insert the interconnect modules in single homed configuration
    [Tags]    Potash
    [Tags]    Nitro

    Get EM IP    ${ENC2}
    Get EM Token    ${ENC2}
    Efuse ICM    EFuseOff    ${Bay_Number[1]}
    Log    \n\n Verifying if module is present    console=True
    Wait Until Keyword Succeeds    15 min    20s      IC reached state    ${ICM5_uri}    Configured
    Wait Until Keyword Succeeds    15 min    20s      IC reached state    ${ICM2_uri}    Configured

    Wait Until Keyword Succeeds     5 min   10s      Get Interconnect stackingDomainRole    ${Interconnect_name[1]}    Subordinate

    Wait Until Keyword Succeeds     5 min   10s      Get Interconnect stackingDomainRole    ${Interconnect_name[0]}    Master

4_3 Verifying Interconnect state and Port status after efuse
    [Documentation]    Verifying IC state and port status after efuse
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Log     \n\nVerifying the interconnects are in configured state    console=True
    :FOR    ${x}    IN    @{Interconnect_dto}
    \     Wait Until Keyword Succeeds    5 min    60s     Verify Interconnect    ${x}    state=Configured


    Log    Fetching ICM URI    console=True
    :FOR    ${icm}    IN    @{Interconnect_name}
    \    ${uri} =    Get IC URI    ${icm}
    \    Run Keyword If    '${icm}' == '${Interconnect_name[0]}'    Set Suite Variable    ${ICM2_uri}    ${uri}
    \    ...    ELSE IF    '${icm}' == '${Interconnect_name[1]}'    Set Suite Variable    ${ICM5_uri}    ${uri}

    Log    \n\nVerifying port status after editing LI    console=True
    :FOR    ${icm}    IN       @{Uplink_bay2}
    \    Wait Until Keyword Succeeds    15 min    20s      Verify Port    ${ICM2_uri}     ${icm}     status=OK     portStatus=Linked

    :FOR    ${icm}    IN       @{Uplink_bay5}
    \    Wait Until Keyword Succeeds    15 min    20s     Verify Port    ${ICM5_uri}     ${icm}     status=OK     portStatus=Linked

4_4 Verifying switch port status after efuse
    [Documentation]    Verifying switch port status after efuse
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    :FOR    ${icm}    IN       @{Switch_ports_TC3}
    \    Wait Until Keyword Succeeds    15 min    60s    Verify switch port status    ${SWITCH1}    ${icm}    status=Linked


4_5 Validating Stacking state of LS after editing uplinkset
    [Documentation]    Validating Stacking state of LS after editing uplinkset
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Log    \n\nValidating stacking state of LS    console=True
    Wait Until Keyword Succeeds    3 min    20s     Verify Stacking state of LS

4_6 Validating stacking member id of Ls
    [Documentation]    Validating stacking member id of Ls
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Log    \n\nValidating stacking member id    console=True
    Validating stacking member id of switch    ${role_name}

4_7 Validating uplinkports from potash connected to Arista ports as Neigbor
    [Documentation]     Validating uplinkports from potash connected to Arista ports as Neigbor
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Log    \nValidate neighbor information    console=True
    ${l}    Get Length    ${UP_Ports_TC3}
    :FOR    ${x}    IN RANGE    0    ${l}
    \    Validate Neighbor Information    ${SWITCH1}    ${Switch_ports_TC3[${x}]}    ${UP_Ports_TC3[${x}]}

4_8 Efuse remove/insert the subordinate interconnect modules
    [Documentation]    Efuse remove/insert the subordinate potash modules
    [Tags]    Potash
    [Tags]    Nitro

    Get EM IP    ${ENC1}
    Get EM Token    ${ENC1}
    Efuse ICM    EFuseOn    ${Bay_Number[0]}
    Log    \n\n Verifying if module is present    console=True
    Wait Until Keyword Succeeds    10 min    20s      IC reached state    ${ICM2_uri}    Absent

    Wait Until Keyword Succeeds    10 min    20s      IC reached state    ${ICM5_uri}    Configured

    Get EM IP    ${ENC1}
    Get EM Token    ${ENC1}
    Efuse ICM    EFuseOff    ${Bay_Number[0]}
    Log    \n\n Verifying if module is present    console=True
    Wait Until Keyword Succeeds    10 min    20s      IC reached state    ${ICM2_uri}    Configured
    Wait Until Keyword Succeeds    10 min    20s      IC reached state    ${ICM5_uri}    Configured

    Wait Until Keyword Succeeds     5 min   10s      Get Interconnect stackingDomainRole    ${Interconnect_name[1]}    Master

    Wait Until Keyword Succeeds     5 min   10s      Get Interconnect stackingDomainRole    ${Interconnect_name[0]}    Subordinate

############ Test case 5 - Disable/Enable ARISTA1 switch port1 and verify traffic flow #############
5 Verifying Interconnect state and Port status after editing LI
    [Documentation]    Verifying IC state and port status after editing LI
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Log     \n\nVerifying the interconnects are in configured state   console=True
    :FOR    ${x}    IN    @{Interconnect_dto}
    \    Wait Until Keyword Succeeds    5 min    60s    Verify Interconnect    ${x}    state=Configured

    Log    Fetching ICM URI    console=True
    :FOR    ${icm}    IN    @{Interconnect_name}
    \    ${uri} =    Get IC URI    ${icm}
    \    Run Keyword If    '${icm}' == '${Interconnect_name[0]}'    Set Suite Variable    ${ICM2_uri}    ${uri}
    \    ...    ELSE IF    '${icm}' == '${Interconnect_name[1]}'    Set Suite Variable    ${ICM5_uri}    ${uri}

    :FOR    ${icm}    IN       @{Uplink_bay2}
    \    Wait Until Keyword Succeeds    15 min    20s      Verify Port    ${ICM2_uri}     ${icm}     status=OK     portStatus=Linked

    :FOR    ${icm}    IN       @{Uplink_bay5}
    \    Wait Until Keyword Succeeds    15 min    20s     Verify Port    ${ICM5_uri}     ${icm}     status=OK     portStatus=Linked

5_1 Editing switch port to disable
    [Documentation]    Editing switch port to disable
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    ${switchuri_list}    Create List

    Log    \n\nFetching Switch uri      console=True
    ${len}    Get Length    ${SWITCH_IP}
    :FOR    ${x}    IN RANGE    0    ${len}
    \    ${switch_uri}     Get switch uri   ${SWITCH_IP[${x}]}
    \    Append To List     ${switchuri_list}     ${switch_uri}
    Set Global variable    ${switchuri_list}

    Log    \n\nFetching uri of ARISTA1 from list     console=True
    ${sw1_uri}     Catenate    ${switchuri_list[0]}/update-ports
    Log    \n\n uri of switch1${sw1_uri}    console=True

    Disabling or Enabling switch port    ${SWITCH1}    ${sw1_uri}    ${port_no}    ${switch_body}     False

    Log    \n\nVerifying ARISTA1 switch port1:1 is disabled     console=True
    ${l}    Get Length    ${port_no}
    :FOR    ${x}    IN RANGE    0    ${l}
    \    Wait Until Keyword Succeeds    15 min    60s    Verify switch port status    ${SWITCH1}    ${port_no[${x}]}    status=Unlinked


5_2 Verifying uplink port is disabled
    [Documentation]    Verifying uplink port is disabled
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Log     \n\nVerifying the interconnects are in configured state    console=True
    :FOR    ${x}    IN    @{Interconnect_dto}
    \    Wait Until Keyword Succeeds    5 min    60s    Verify Interconnect    ${x}    state=Configured

    Log    Fetching ICM URI    console=True
    :FOR    ${icm}    IN    @{Interconnect_name}
    \    ${uri} =    Get IC URI    ${icm}
    \    Run Keyword If    '${icm}' == '${Interconnect_name[0]}'    Set Suite Variable    ${ICM2_uri}    ${uri}
    \    ...    ELSE IF    '${icm}' == '${Interconnect_name[1]}'    Set Suite Variable    ${ICM5_uri}    ${uri}

    Log    \n\nVerifying uplink port is unlinked   console=True
    :FOR    ${icm}    IN       @{Uplink_bay2}
    \    Wait Until Keyword Succeeds    15 min    20s      Verify Port    ${ICM2_uri}     ${icm}     status=Critical     portStatus=Unlinked

    :FOR    ${icm}    IN       @{Uplink_bay5}
    \    Wait Until Keyword Succeeds    15 min    20s     Verify Port    ${ICM5_uri}     ${icm}     status=Critical     portStatus=Unlinked

5_3 Verifying uplinkset status for nitro
    [Documentation]    verifying uplinkset status after disabling switch port
    Set Log Level    TRACE
    [Tags]    Nitro
    [Tags]    Potash

    ${len}    Get Length    ${US_names}
    :FOR    ${x}    IN RANGE    0    ${len}
    \    ${resp} =   Fusion Api Get Uplink Set    param=?filter="'name'=='${US_names[${x}]}'"
    \    Log    \n${resp}    console=True
    \    ${us_status}     Get From Dictionary    ${resp['members'][0]}    status
    \    Should Be Equal    ${us_status}    Critical

5_4 Validating no IP in server after disable switch port
    [Documentation]    Validating no IP in server after disable switch port
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro
    Validating no IP    ${ilo_details_enc1_bay1}    ${IP_series}
    Validating no IP    ${ilo_details_enc2_bay1}    ${IP_series}

5_5 Editing switch port to enable
    [Documentation]    Editing switch port to enable
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    ${switchuri_list}    Create List
    Log    \n\nFetching Switch uri      console=True
    ${len}    Get Length    ${SWITCH_IP}
    :FOR    ${x}    IN RANGE    0    ${len}
    \    ${switch_uri}     Get switch uri   ${SWITCH_IP[${x}]}
    \    Append To List     ${switchuri_list}     ${switch_uri}
    Set Global variable    ${switchuri_list}

    Log    \n\nFetching uri of ARISTA1 from list     console=True
    ${sw1_uri}     Catenate    ${switchuri_list[0]}/update-ports
    Log    \n\n uri of switch1${sw1_uri}    console=True

    Disabling or Enabling switch port    ${SWITCH1}    ${sw1_uri}    ${port_no}    ${switch_body}     True

    ${l}    Get Length    ${port_no}
    :FOR    ${x}    IN RANGE    0    ${l}
    \    Wait Until Keyword Succeeds    15 min    60s    Verify switch port status    ${SWITCH1}    ${port_no[${x}]}    status=Linked

5_6 Verifying uplink port is enabled
    [Documentation]    Verifying uplink port is enabled
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Log     \n\nVerifying the interconnects are in configured state   console=True
    :FOR    ${x}    IN    @{Interconnect_dto}
    \    Wait Until Keyword Succeeds    5 min    60s     Verify Interconnect    ${x}    state=Configured

    Log    Fetching ICM URI    console=True
    :FOR    ${icm}    IN    @{Interconnect_name}
    \    ${uri} =    Get IC URI    ${icm}
    \    Run Keyword If    '${icm}' == '${Interconnect_name[0]}'    Set Suite Variable    ${ICM2_uri}    ${uri}
    \    ...    ELSE IF    '${icm}' == '${Interconnect_name[1]}'    Set Suite Variable    ${ICM5_uri}    ${uri}

     Log    \n\nVerifying uplink port is linked   console=True
    :FOR    ${icm}    IN       @{Uplink_bay2}
    \    Wait Until Keyword Succeeds    15 min    20s      Verify Port    ${ICM2_uri}     ${icm}     status=OK     portStatus=Linked

    :FOR    ${icm}    IN       @{Uplink_bay5}
    \    Wait Until Keyword Succeeds    15 min    20s     Verify Port    ${ICM5_uri}     ${icm}     status=OK     portStatus=Linked

5_7 Verifying uplinkset status for nitro
    [Documentation]    verifying uplinkset status after enabling switch port
    Set Log Level    TRACE
    [Tags]    Nitro
    [Tags]    Potash

    ${len}    Get Length    ${US_names}
    :FOR    ${x}    IN RANGE    0    ${len}
    \    ${resp} =   Fusion Api Get Uplink Set    param=?filter="'name'=='${US_names[${x}]}'"
    \    Log    \n${resp}    console=True
    \    ${us_status}     Get From Dictionary    ${resp['members'][0]}    status
    \    Should Be Equal    ${us_status}    OK

5_8 Validating Stacking state of LS
    [Documentation]    Validating Stacking state of LS
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Log    \n\nValidating stacking state of LS    console=True
    Wait Until Keyword Succeeds    3 min    20s     Verify Stacking state of LS

5_9 Validating stacking member id of Ls
    [Documentation]    Validating stacking member id of LS
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Log    \n\nValidating stacking member id    console=True
    Validating stacking member id of switch    ${role_name}

5_10 Validating uplinkports from potash connected to Arista ports as Neigbor
    [Documentation]     Validating uplinkports from potash connected to Arista ports as Neigbor
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Log    \nValidate neighbor information    console=True
    ${l}    Get Length    ${UP_Ports_TC3}
    :FOR    ${x}    IN RANGE    0    ${l}
    \    Validate Neighbor Information    ${SWITCH1}    ${Switch_ports_TC3[${x}]}    ${UP_Ports_TC3[${x}]}

5_11 Getting Server IP and pinging from server1 to gateway ip and server1 to server2 verifying loss
    [Documentation]    Getting Server IP and pinging IP,verifying packet loss
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Log    \n\n Getting Ip and gateway ip of server enc1 bay1    console=True
    ${IP1}    ${gate_ip1}    Get Server Ip Windows    ${ilo_details_enc1_bay1}
    Set Global Variable    ${server_ip1}    ${IP1[0]}
    Set Global Variable    ${gateway_ip}    ${gate_ip1[0]}

    Log    \n\n Getting Ip and gateway ip of server enc2 bay1    console=True
    ${IP2}    ${gate_ip2}    Get Server Ip Windows   ${ilo_details_enc2_bay1}

    Log    \n\n server1 toGatewayping    console=True
    Ping IP and Verify packet loss    ${server_ip1}    ${server1_details['username']}     ${server1_details['password']}    ${gate_ip1}     ${ping_gateway_server1}    ${file2}

    Log    \n\nServer1toserver2ping    console=True

    Ping IP and Verify packet loss    ${server_ip1}    ${server1_details['username']}     ${server1_details['password']}     ${IP2}    ${ping_cmd_server1}    ${file1}

5_12 Pinging from Server2 to gateway and Ping from server2 to server1 and verifying loss
    [Documentation]    Getting Server IP and pinging IP,verifying packet loss
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Log    \n\n Getting Ip and gateway ip of server enc1 bay1    console=True
    ${IP1}    ${gate_ip1}    Get Server Ip Windows    ${ilo_details_enc1_bay1}

    Log    \n\n Getting Ip and gateway ip of server enc2 bay1    console=True
    ${IP2}    ${gate_ip2}    Get Server Ip Windows   ${ilo_details_enc2_bay1}
    Set Global Variable    ${server_ip2}    ${IP2[0]}
    Set Global Variable    ${gateway_ip2}    ${gate_ip2[0]}

    Log    \n\nserver2toGatewayping    console=True

    Ping IP and Verify packet loss    ${server_ip2}    ${server2_details['username']}     ${server2_details['password']}     ${gate_ip2}    ${ping_gateway_server2}    ${file3}

    Log    \n\nserver2toserver1 ping     console=True

    Ping IP and Verify packet loss    ${server_ip2}    ${server2_details['username']}     ${server2_details['password']}     ${IP1}    ${ping_cmd_server2}    ${file4}


########Test case-6 Create LIG-A,B Side with both potash connected to 2 Arista and verifying server to server ping #########

6 Cleaning up the appliance
    [Documentation]     Cleanup OV
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Log    \n\n Cleaning up the appliance     console=True
    Clean OV

6_1 Creating LIG with A Side & B Side,EG,LE
    [Documentation]    Creating LIG with A Side & B Side,EG,LE
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Log    \n\n Creating Ethernet network    console=True
    Add Ethernet Networks from variable    ${ethernet_networks}
    Log   \n\n Creating LIG-A    console=True
    Log    ${ligA}    console=True
    Add LIG from variable    ${ligA}
    Log   \n\n Creating LIG-B    console=True
    Add LIG from variable     ${ligB}

    Log     \n\nCreating EG    console=True
    ${resp} =    Add Enclosure Group from variable    ${enc_grp_AB['EG_AB']}
    Run Keyword If  ${resp['status_code']} != 201    fail    msg=\nUnable to create EG
    ...         ELSE    log    \nsuccessfully created EG

    Log     \n\n Creating LE     console=True
    Add Logical Enclosure from variable    ${LE_AB['LE_AB']}

6_2 Verifying Interconnect state and Port status after creating LE
    [Documentation]    Verifying IC state and port status status after creating LE
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Log     \n\nVerifying the interconnects are in configured state    console=True
    :FOR    ${x}    IN    @{Interconnect_dto}
    \    Wait Until Keyword Succeeds    5 min    60s     Verify Interconnect    ${x}    state=Configured

    Log    Fetching ICM URI    console=True
    :FOR    ${icm}    IN    @{Interconnect_name}
    \    ${uri} =    Get IC URI    ${icm}
    \    Run Keyword If    '${icm}' == '${Interconnect_name[0]}'    Set Suite Variable    ${ICM2_uri}    ${uri}
    \    ...    ELSE IF    '${icm}' == '${Interconnect_name[1]}'    Set Suite Variable    ${ICM5_uri}    ${uri}

    Log    Verifying port status after creating LE    console=True
    :FOR    ${icm}    IN       @{ETH_UPLINKS}
    \    Wait Until Keyword Succeeds    15 min    20s     Verify Port    ${ICM2_uri}     ${icm}     status=OK     portStatus=Linked

    :FOR    ${icm}    IN       @{ETH2_UPLINKS}
    \    Wait Until Keyword Succeeds    15 min    20s     Verify Port    ${ICM5_uri}     ${icm}     status=OK     portStatus=Linked

6_3 Creating LSG
    [Documentation]    creating LSG
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro
    Log    \n\nCreating LSG    console=True
    Add Logical Switch Group from variable    ${LSG1}

6_4 Creating LS in Managed mode
    [Documentation]    creating LS in Managed mode
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Log    \n\nCreating LS     console=True
    Add Logical Switch    ${LS3}

6_5 Verifying Interconnect state and Port status after creating LS
    [Documentation]    Verifying IC state and port status status after creating LS
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Log     \n\nVerifying the interconnects are in configured state    console=True
    :FOR    ${x}    IN    @{Interconnect_dto}
    \    Wait Until Keyword Succeeds    5 min    60s     Verify Interconnect    ${x}    state=Configured

    Log    Fetching ICM URI    console=True
    :FOR    ${icm}    IN    @{Interconnect_name}
    \    ${uri} =    Get IC URI    ${icm}
    \    Run Keyword If    '${icm}' == '${Interconnect_name[0]}'    Set Suite Variable    ${ICM2_uri}    ${uri}
    \    ...    ELSE IF    '${icm}' == '${Interconnect_name[1]}'    Set Suite Variable    ${ICM5_uri}    ${uri}

    Log    \nVerifying port status after creating LS    console=True
    :FOR    ${icm}    IN       @{ETH_UPLINKS}
    \    Wait Until Keyword Succeeds    15 min    20s     Verify Port    ${ICM2_uri}     ${icm}     status=OK     portStatus=Linked

    :FOR    ${icm}    IN       @{ETH2_UPLINKS}
    \    Wait Until Keyword Succeeds    15 min    20s     Verify Port    ${ICM5_uri}     ${icm}     status=OK     portStatus=Linked

6_6 Verifying two LI are created
    [Documentation]    Verifying two LI are created
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Log    \n\nValidating two LI are created    console=True
    ${resp}    Fusion Api Get Li
    ${LI_name}    Create List
    Log    \n\n${resp}    console=True
    Log    \n\n${resp['members'][0]['name']}    console=True
    Log    \n\n${resp['members'][1]['name']}    console=True
    :FOR    ${x}    IN RANGE     ${No_of_LI}
    \    ${name}  Get From Dictionary    ${resp['members'][${x}]}    name
    \    Append To List    ${LI_name}    ${name}
    ${l}    Get Length    ${LI_name}
    Log    \n\n${l}     console=True
    Run Keyword If     '${l}' != '${No_of_LI}'    Fail    ELSE    Log    \nTwo LI's are created    console=True

6_7 Validating Stacking state of LS
    [Documentation]    Validating Stacking state of LS
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Log    \n\nValidating stacking state of LS    console=True
    Wait Until Keyword Succeeds    3 min    20s     Verify Stacking state of LS

6_8 Validating stacking member id of Ls
    [Documentation]    Validating stacking member id of LS
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Log    \n\nValidating stacking member id    console=True
    Validating stacking member id of switch    ${role_name}


6_9 Validating uplinkports from potash connected to Arista ports as Neigbor
    [Documentation]     Validating uplinkports from potash connected to Arista ports as Neigbor
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Log    \nValidate neighbor information    console=True
    ${l}    Get Length    ${UP_Ports_TC3}
    :FOR    ${x}    IN RANGE    0    ${l}
    \    Validate Neighbor Information    ${SWITCH1}    ${Switch_ports_TC3[${x}]}    ${UP_Ports_TC3[${x}]}


6_10 Creating server profile
    [Documentation]    creating server profile
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Log    \n\n Powering off servers    console=True
    Power off ALL Servers
    Log    \n\n Creating server profile    console=True
    ${resp}    Add Server Profiles from variable   ${server_profiles_AB}

    ${l}    Get Length    ${resp}
    :FOR    ${x}    IN RANGE    0   ${l}
    \    Run Keyword If  '${resp[${x}]['status_code']}' == '202'    Wait For Task2    ${resp[${x}]}    20m    1m    ELSE    Fail    Log    failed    console=True
    \    Power on server    ${server_profiles_AB[${x}]['serverHardwareUri']}
    Sleep    10min

6_11 Getting Server IP and pinging from server1 to gateway ip and server1 to server2 verifying loss
    [Documentation]    Getting Server IP and pinging IP,verifying packet loss
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Log    \n\n Getting Ip and gateway ip of server enc1 bay1    console=True
    ${IP1}    ${gate_ip1}    Get Server Ip Windows    ${ilo_details_enc1_bay1}
    Set Global Variable    ${server_ip1}    ${IP1[0]}
    Set Global Variable    ${gateway_ip}    ${gate_ip1}

    Log    \n\n Getting Ip and gateway ip of server enc2 bay1    console=True
    ${IP2}    ${gate_ip2}    Get Server Ip Windows   ${ilo_details_enc2_bay1}
    Set Global Variable    ${server_ip2}    ${IP2[0]}
    Set Global Variable    ${gateway_ip2}    ${gate_ip2}


    Log    \n\n server1 toGatewayping    console=True
    Ping IP and Verify packet loss    ${server_ip1}    ${server1_details['username']}     ${server1_details['password']}    ${gateway_ip}     ${ping_gateway_server1}    ${file2}

    Log    \n\nServer1toserver2ping    console=True

    Ping IP and Verify packet loss    ${server_ip1}    ${server1_details['username']}     ${server1_details['password']}     ${IP2}    ${ping_cmd_server1}    ${file1}


6_12 Pinging from Server2 to gateway and Ping from server2 to server1 and verifying loss
    [Documentation]    Getting Server IP and pinging IP,verifying packet loss
    Set Log Level    TRACE
    [Tags]    Potash
    [Tags]    Nitro

    Log    \n\n Getting Ip and gateway ip of server enc1 bay1    console=True
    ${IP1}    ${gate_ip1}    Get Server Ip Windows    ${ilo_details_enc1_bay1}
    Set Global Variable    ${server_ip}    ${IP1[0]}
    Set Global Variable    ${gateway_ip}    ${gate_ip1}

    Log    \n\n Getting Ip and gateway ip of server enc2 bay1    console=True
    ${IP2}    ${gate_ip2}    Get Server Ip Windows   ${ilo_details_enc2_bay1}
    Set Global Variable    ${server_ip2}    ${IP2[0]}
    Set Global Variable    ${gateway_ip2}    ${gate_ip2}

    Log    \n\nserver2toGatewayping    console=True

    Ping IP and Verify packet loss    ${server_ip2}    ${server2_details['username']}     ${server2_details['password']}     ${gateway_ip2}    ${ping_gateway_server2}    ${file3}

    Log    \n\nserver2toserver1 ping     console=True

    Ping IP and Verify packet loss    ${server_ip2}    ${server2_details['username']}     ${server2_details['password']}     ${IP1}    ${ping_cmd_server2}    ${file4}



