*** Settings ***
Documentation      RoboGalaxy emgmt Branch for WPST-CRM Fusion UI Regression Tests
Resource           339_smartlink_rsc.txt
Force Tags         Buildup
Test Setup         Load Test Data and Open Browser
Test Teardown      Logout And Close All Browsers

*** Variables ***
${DataFile1}		339_smartlink.xml


*** Test Cases ***
Loading the environment variables
	Log to Console 	Start  339 Smartlink Test Suite    
    
    
    #Set up log level and variables
    Log to Console		Set up log level and variables
    Set Log Level    TRACE
    Log Variables
   

STEP 1 -  SETUP
    Log to Console      STEP 1 - Set up
	Log to Console      Create ethernet networks: net_101, net_102, net_103
	#Fusion UI Create Ethernet Network            @{TestData.networks}
    
    Log to Console		Create Network Set "NetSet-1"
    #Fusion UI Create Network Set                 @{TestData.networksets}
 
 As admin I will Create Logical Interconnects Group
    #Load Test Data  ${DataFile1}
    #Log into Fusion Appliance As Administrator   
    Log to Console 		Create Logical Interconnects Group
    #Fusion UI Create Logical Interconnect Group  @{TestData.ligs}
    
    ##Fusion UI Add Firmware Bundle         @{TestData.sppName}
 
As admin I will Create Logical Interconnects Group, Add enclosure, Power of all servers
    #Load Test Data  ${DataFile1}
    #Log into Fusion Appliance As Administrator     
    Log to Console		Create Enclosure Group
    #Fusion UI Create Enclosure Group     @{TestData.encgroups}
    
    Log to Console		Add an Enclosure
    #Fusion UI Add Enclosure               @{TestData.enclosures}

    ##Fusion UI Update Enclosure Firmware  @{TestData.enclosures_update}
	##No need to add server HW
	##Fusion UI Add Server Hardware    	  @{TestData.serverhardware}	    
    ##Fusion UI Update Enclosure Firmware  @{TestData.enclosures_update}

	Log to Console		Power off all servers
	#Fusion UI Power Off All Servers
	
#As admin I will Create Server Profiles: Blade-1(net_103), Blade-2(net_103), Blade-3(NetSet-1)
    #Load Test Data  ${DataFile1}
    #Log into Fusion Appliance As Administrator	
	#Log to Console		Create Server Profiles: Blade-1(net_103), Blade-2(net_103), Blade-3(NetSet-1)
	#Fusion UI Create Server Profile         @{TestData.profiles}
	

#As admin I will power on server profile
    #Load Test Data  ${DataFile1}
    #Log into Fusion Appliance As Administrator
##STEP : 2 -  Verify servers - All downlinks are linked
	##Power on Server
	#Log to Console      STEP 2 - Power on server profiles
	#Fusion UI power on server profile  		@{TestData.profiles}

#As admin I will Verify all downlinks: port1, port2, port3 are linked
    #Load Test Data  ${DataFile1}
    #Log into Fusion Appliance As Administrator	
	#Log to Console   Verify all downlinks: port1, port2, port3 are linked
	#fusion ui verify interconnect port status   @{TestData.interconnects_downlink_port1_status_linked}
	#fusion ui verify interconnect port status   @{TestData.interconnects_downlink_port2_status_linked}
	#fusion ui verify interconnect port status   @{TestData.interconnects_downlink_port3_status_linked}	
	
##STEP 3:  Disable uplink#2 (smartlink enabled net), verify downlinks
	Log to Console   STEP 3 - Disable uplink port2 with smartlink enabled net (net_101 and net_102) then verify downlink ports
    ##fusion_ui_navigate_to_dashboard_page
    ##fusion_ui_navigate_to_interconnects_page
	#Fusion UI Edit Interconnect Port            @{TestData.interconnects_edit_uplink_port2}

#As admin I will verify downlink port 1, 2 = "linked" and port#3 = linked
    #Load Test Data  ${DataFile1}
    #Log into Fusion Appliance As Administrator		
    #fusion ui verify interconnect port status   @{TestData.interconnects_downlink_port3_status_unlinked}
    #fusion ui verify interconnect port status   @{TestData.interconnects_downlink_port1_status_linked}
    #fusion ui verify interconnect port status   @{TestData.interconnects_downlink_port2_status_linked}	
    
        
    ##Re-enable uplink#2
    Log to Console   Re-enable uplink port2
	#Fusion UI Edit Interconnect Port            @{TestData.interconnects_edit_uplink_port2}
	
As admin I will verify downlink port 1, 2 = "linked" and port#3 = linked when uplink port#2 is re-enabled
    Load Test Data  ${DataFile1}
    Log into Fusion Appliance As Administrator
    #fusion ui verify interconnect port status   @{TestData.interconnects_downlink_port3_status_linked}
    #fusion ui verify interconnect port status   @{TestData.interconnects_downlink_port1_status_linked}
    #fusion ui verify interconnect port status   @{TestData.interconnects_downlink_port2_status_linked}	


##STEP : 4 -  Disable uplink#1, Verify downnlink ports: port3 = linked
    #Log to Console   STEP 4 - Disable uplink1 then verify downlink port 3
	#Fusion UI Edit Interconnect Port           @{TestData.interconnects_edit_uplink_port1}

#As admin I will edit net_102 = smarlink enabled
    #Load Test Data  ${DataFile1}
    #Log into Fusion Appliance As Administrator	
    #fusion ui verify interconnect port status   @{TestData.interconnects_downlink_port3_status_linked}
    
    
    ###Re-enable uplink#1
    #Log to Console   Re-enable uplink1 
	#Fusion UI Edit Interconnect Port           @{TestData.interconnects_edit_uplink_port1}      
    #Log to Console   Enable smartlink on net_102
	#Fusion UI Edit Ethernet Network    @{TestData.editethnetworks}

#As admin I will disable uplink port#1
    #Load Test Data  ${DataFile1}
    #Log into Fusion Appliance As Administrator
	##Disable uplink#1, Verify downnlink ports: US-1=linked/unlinked
	#Log to Console   Disable uplink1 then verify downlink port3 = unlinked
	#Fusion UI Edit Interconnect Port            @{TestData.interconnects_edit_uplink_port1}
	
#As admin I will verify downlink port 3 = "unlinked" when uplink port#1 is disabled and net_102 smartlinked enabled
    #Load Test Data  ${DataFile1}
    #Log into Fusion Appliance As Administrator
    #fusion ui verify interconnect port status   @{TestData.interconnects_downlink_port3_status_unlinked}

	
##STEP : 5 - Disable uplink#2;  Verify downlink port #3
	#Log to Console   Disable uplink port2
	#Fusion UI Edit Interconnect Port            @{TestData.interconnects_edit_uplink_port2}
#As admin I will check Downlink port #1,2 (connected to net_103) become unlinked
    #Load Test Data  ${DataFile1}
    #Log into Fusion Appliance As Administrator 	
	##Verify Downlink port #1,2 (connected to net_103) become unlinked
	
	#Log to Console   Verify Downlink port #1,2 (connected to net_103) become unlinked
	#fusion ui verify interconnect port status   @{TestData.interconnects_downlink_port1_status_unlinked}
	#fusion ui verify interconnect port status   @{TestData.interconnects_downlink_port2_status_unlinked}	
	
        
    ##Delete uplink set US-2
    #Log to Console   Delete uplink set US-2
    #Fusion UI Edit Logical Interconnect Group  @{TestData.editligs_remove_uplinkset2}

#As admin I will do an Logical Interconnect Update From Group after deleting US-2 from LIG-1
    #Load Test Data  ${DataFile1}
    #Log into Fusion Appliance As Administrator    
    ##To Be developed
    #Fusion UI Logical Interconnect Update From Group   @{TestData.interconnects}
    
#As admin I will check all downlinks port1 and port2 = linked when US-2 has been deleted from LIG-1
    #Load Test Data  ${DataFile1}
    #Log into Fusion Appliance As Administrator 
	##Verify that all downlinks (port#1, 2) change to linked.	
	#fusion ui verify interconnect port status   @{TestData.interconnects_downlink_port1_status_linked}
	#fusion ui verify interconnect port status   @{TestData.interconnects_downlink_port2_status_linked}	
	
    ##Edit networkset: Re-Add US-2 with net_103
    #Log to Console   Re-add net_103 from uplinkSet US-2
    #Fusion UI Edit Logical Interconnect Group  @{TestData.editligs_readd_uplinkset2}
    
    ##To Be developed
    #Fusion UI Logical Interconnect Update From Group   @{TestData.interconnects}    
    
    
As admin I will check
    Load Test Data  ${DataFile1}
    Log into Fusion Appliance As Administrator     
    ##Verify Downlinks for blades 1 & 2 (port#1,2 connected to uplink port#2) become unlinked
	fusion ui verify interconnect port status   @{TestData.interconnects_downlink_port1_status_unlinked}
	fusion ui verify interconnect port status   @{TestData.interconnects_downlink_port2_status_unlinked} 

    ## Delete US-1, US-2
    Log to Console    Delete US-1 and US-2
    Fusion UI Edit Logical Interconnect Group  @{TestData.editligs_remove_uplinkset2}
    Fusion UI Edit Logical Interconnect Group   @{TestData.editligs_remove_uplinkset1}
    ##To Be developed
    Fusion UI Logical Interconnect Update From Group   @{TestData.interconnects} 

As admin I will check
    Load Test Data  ${DataFile1}
    Log into Fusion Appliance As Administrator 
	##Verify that all downlinks are linked
	fusion ui verify interconnect port status   @{TestData.interconnects_downlink_port1_status_linked}
	fusion ui verify interconnect port status   @{TestData.interconnects_downlink_port2_status_linked}
	fusion ui verify interconnect port status   @{TestData.interconnects_downlink_port3_status_linked}
    
    ##Clean up
    Log to Console    Clean up test environment
    #Tear Down Environment
    
    ##End Test
    Log to Console    Test Completed !!!


*** Keywords ***

Tear Down Environment
    Log to Console    Re-enable port 1 and 2
    Fusion UI Edit Interconnect Port            @{TestData.interconnects_edit_uplink_port1}
    Fusion UI Edit Interconnect Port            @{TestData.interconnects_edit_uplink_port2}
    
    Log to Console    Delete Network Set
    #Fusion UI Delete Network Set       @{TestData.deletenetworksets}
    
    
    Log to Console    Delete Ethernet Networks
    #Fusion UI Delete Ethernet Network  @{TestData.deletenetworks}
    
    Log to Console    Power off all servers
	#Fusion UI Power Off All Servers
	
	Log to Console    Delete Server Profiles
	#Fusion UI Delete Server Profile        @{TestData.profile_delete}
	
	Log to Console    Remove Enclosure
	#Fusion UI Delete Enclosure             @{TestData.enclosures_delete}
	
	Log to Console    Delete Enclosure Group
	#Fusion UI  Delete Enclosure group      @{TestData.enclosuregroup_delete}

	Log to Console    Delete LIG
	#Fusion UI  delete_logical_interconnect_group      @{TestData.lig_delete}	

	##Log to Console    Remove Enclosure
	##Fusion UI Delete Enclosure             @{TestData.enclosures_delete}
	
	
	
    ##End Clean up
    Log to Console    Clean up tasks Completed !!!	
    