*** Settings ***
Documentation      Test Cases 301 and 304
Resource           OVAConfig.txt
Force Tags         Buildup
#Test Setup         Load Test Data and Open Browser
#Test Teardown      Logout And Close All Browsers

Suite Setup         Load Test Data and Open Browser
Suite Teardown      Logout And Close All Browsers

*** Test Cases ***

301-OVA Qualification

        Set Log Level   TRACE
        Log Variables

        # Step : 1 Log into fusion as Administrator
        ${user} =   Get Data By Property   ${TestData.users}   name   Administrator
        Fusion UI Login to Appliance    ${user[0].name}
        
        Log to Console   Test Step - 1 Completed

        # Step : 2 Remove users accounts and networks required for tests (if exist)
        Fusion UI Navigate To Networks Page
        Fusion UI delete ethernet network   @{TestData.networks301}
        Fusion UI delete fc network   @{TestData.fcnetworks301}
        Log to Console   Test Step - 2 Completed

        # Step : 3 Create users accounts (serveradmin, backadmin) and networks required for tests
        Fusion UI Navigate To Users and Groups Page
        Fusion UI Create User   ${TestData.users[4]}
        Fusion UI Create User   ${TestData.users[5]}
        Fusion UI Navigate To Networks Page
        Fusion UI create ethernet network   ${TestData.networks301[0]}
        Fusion UI create fc network   ${TestData.fcnetworks301[0]}
        Log to Console   Test Step - 3 Completed

        # Step : 4 Log out of Appliance
        Fusion UI Logout of Appliance
        Log to Console   Test Step - 4 Completed

        # Step : 5 Log into Fusion appliance as serveradmin
        ${user} =  Get Data By Property   ${TestData.users}  name  serveradmin
        #Fusion UI Create User   ${TestData.users[1]}
        Fusion UI Login to Appliance     ${user[0].name}
        Log to Console   Test Step - 5 Completed Logged in as ServerAdmin

        # Step : 6 User shouldn't have any 'Edit/Delete' Action button in page
        ${status} =      fusion_ui_validate_privileges_edit_network        @{TestData.networksuser}
        Run Keyword If    '${status}' == 'True'    Log to Console    As expected server user does not have privileges to add network    ELSE    fail
        Log to Console   Test Step - 6 Completed Check ServerAdmin Privileges 

        # Step : 7 Log out of appliance
        Fusion UI Logout of Appliance
        Log to Console   Test Step - 7 Completed

        # Step : 8 Log into Fusion appliance as backupadmin
        ${user} =   Get Data By Property  ${TestData.users}  name  backupadmin
        Fusion UI Login to Appliance    ${user[0].name}
        Log to Console   Test Step - 8 Completed Loged in as BackupAdmin

        # Step : 9 User shouldn't have any 'Edit/Delete' Action button in page
        fusion_ui_navigate_to_networks_page
        ${status} =        fusion_ui_validate_privileges_edit_network        @{TestData.networksuser}
        Run Keyword If    '${status}' == 'True'    Log to Console    As expected server user does not have privileges to add network    ELSE    fail
        Log to Console   Test Step - 9 Completed Check BackupAdmin Privileges 

        # Step : 10 Log out of appliance
        Fusion UI Logout of Appliance
        Log to Console   Test Step - 10 Completed

        # Step : 11 Re-login into fusion as Administrator to cleanup users/networks
        ${user} =   Get Data By Property  ${TestData.users}  name  Administrator
        Fusion UI Login to Appliance    ${user[0].name}
        Fusion UI Navigate To Networks Page
        Fusion UI delete ethernet network   @{TestData.networks301}
        Fusion UI delete fc network   @{TestData.fcnetworks301}
        Log to Console   Test Step - 11 Completed

304- OVA Qualification
    Set Log Level    TRACE
    Log Variables
    
    
    ### LOg in as a Administrator
    ${user} =  Get Data By Property   ${TestData.users}   name   Administrator
    Fusion UI Login to Appliance   ${user[0].name}
 
    
    ######## create Network and Backup users
    #Create users Network Administrator  
    Fusion UI Create User   ${TestData.users[2]}
    #Create users Backup Administrator 
    Fusion UI Create User   ${TestData.users[5]}
        
    #Log into Fusion appliance as network_Admin   
    ${user} =  Get Data By Property   ${TestData.users}   name   networkadmin
    Fusion UI Login to Appliance    ${user[0].name}
    ${button_enabled} =   fusion_ui_action_visibility_check_networks  
    Log to Console  Test Step Value of button "${button_enabled}"
    Run Keyword If    '${button_enabled}' == 'False'    Log to Console    Action visibility test failed    ELSE    fail

    #clean all networks
    fusion_ui_delete_all_appliance_networks
    
    #delete the networks that need to be created/edited - if present
    Fusion UI delete ethernet network   @{TestData.networks304}
    Fusion UI delete ethernet network   @{TestData.delnet}
    Log to Console   Network Delete completed
    
    #Creating network  with all Positive and negative values
    #fusion_ui_create_ethernet_network_Negative  @{TestData.networks304}
    Fusion UI create ethernet network    @{TestData.networks304}
    Log to Console   ADDING TEST CASES COMPLETED
     
    ##############Network page edit  validate
    fusion_ui_navigate_to_networks_page
    #fusion_ui_edit_ethernet_network_validate   @{TestData.editnet}
    fusion_ui_edit_ethernet_network     @{TestData.editnet}
    Log to Console   EDIT TEST CASES COMPLETED
    
    ############# delete network  is working fine
    fusion_ui_navigate_to_networks_page
    Fusion UI delete ethernet network    @{TestData.delnet}
    
    # Log into Fusion appliance as backupadmin
    Log to Console   Login as BackupAdmin
    ${user} =  Get Data By Property   ${TestData.users}   name   backupadmin
    Fusion UI Login to Appliance    ${user[0].name}
    
    #check the backadmin privalage  
    #fusion_ui_navigate_to_networks_page
    ${status} =        fusion_ui_validate_privileges_edit_network        @{TestData.networksuser}
    Run Keyword If    '${status}' == 'True'    Log to Console    As expected network user has privileges to add network    ELSE    fail
    
    
    # Clean the networks 
    Log to Console   Login as NetworkAdmin
    ${user} =  Get Data By Property   ${TestData.users}   name   networkadmin
    Fusion UI Login to Appliance    ${user[0].name}
    fusion_ui_delete_all_appliance_networks    