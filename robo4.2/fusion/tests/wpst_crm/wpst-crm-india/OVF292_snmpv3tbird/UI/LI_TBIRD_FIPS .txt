*** Settings ***
Documentation    OVF292-LI-SNMPV3-FIPS
Resource         SNMPV3-CONFIG.txt

Resource     C:\3.10_new_checkin\fusion\tests\wpst_crm\resources
Force Tags    Buildup
Suite Setup    Load Test Data and Open Browser
Suite Teardown    Logout And Close All Browsers
Library    Dialogs
Library    String
Variables              data_variables.py
Resource            ../../../resource/fusion_api_all_resource_files.txt
Variables              data_variables.py


*** Variables ** *
${SSH_PASS}                     hpvse1
${DataFile}                         ./LI-TBIRD - FIPS.xml
${State_Power_Off}             Maintenance
${State_Configured}             Configured
${ICM_1}                     RAVIENCL10, interconnect 6
${APPLIANCE_IP}              192.168.144.146

*** Test Cases ***

00 Log into fusion as Administrator
    [Documentation]    Log into Appliance as Administrator
    Log To Console    *********Log into Appliance as Administrator****************
    ${user} =    Get Data By Property    ${TestData.users}    name    Administrator
    fusion_ui_login_to_appliance    ${user[0].name}
    Log to Console    Successfully logged in as Administrator


OVF293_UI_TC_30 AddsnmpUser_SecLevel_AuthPriv_Authentication SHA256 And Privacy AES128
    [Documentation]  EDIT LI
    Log To Console    ******EDIT LI BY ADDING A SNMPV3 USER HAVIMG SHA256 AUTH  AND AES128 PRIVACY PROTOCALS**********
    ${Status}=    fusion_ui_edit_logical_interconnects    @{TestData.ligs_add_sha2_128}
    Run Keyword And Continue On Failure   Should Be Equal    '${Status}'    'True'    ${Status}
    Wait Until Keyword Succeeds    2400 s    10 s    Verify Interconnect State    ${ICM_1}    ${State_Configured}

OVF293_UI_TC_31 AddsnmpUser_SecLevel_AuthPriv_Authentication SHA256 And Privacy AES192
    [Documentation]  EDIT LI
    Log To Console    ******EDIT LI BY ADDING A SNMPV3 USER HAVIMG SHA256 AUTH  AND AES192 PRIV PROTOCALS**********
    ${Status}=    fusion_ui_edit_logical_interconnects    @{TestData.ligs_add_sha2_192}
    Run Keyword And Continue On Failure   Should Be Equal    '${Status}'    'True'    ${Status}
    Wait Until Keyword Succeeds    2400 s    10 s    Verify Interconnect State    ${ICM_1}    ${State_Configured}

 OVF293_UI_TC_32 AddsnmpUser_SecLevel_AuthPriv_Authentication SHA256 And Privacy AES256
    [Documentation]  EDIT LI
    Log To Console    ******EDIT LI BY ADDING A SNMPV3 USER HAVIMG SHA256 AUTH  AND AES256 PRIV PROTOCALS**********
    ${Status}=    fusion_ui_edit_logical_interconnects    @{TestData.ligs_add_sha2_256}
    Run Keyword And Continue On Failure   Should Be Equal    '${Status}'    'True'    ${Status}
    Wait Until Keyword Succeeds    2400 s    10 s    Verify Interconnect State    ${ICM_1}    ${State_Configured}

    Log To Console    ******VERIFY LI**********
    ${Status}=    fusion_ui_verify_logical_interconnects    @{TestData.ligs_verifysha256}
    Run Keyword And Continue On Failure   Should Be Equal    '${Status}'    'True'    ${Status}

    Log To Console    *****DELETE USERS **********
    ${Status}=    fusion_ui_edit_logical_interconnects    @{TestData.ligs_del_sha2_256}
    Run Keyword And Continue On Failure   Should Be Equal    '${Status}'    'True'    ${Status}


OVF293_UI_TC_40 AddsnmpUser_SecLevel_AuthPriv_Authentication SHA384 And Privacy AES128
    [Documentation]  EDIT LI
    Log To Console    ******EDIT LI BY ADDING A SNMPV3 USER HAVIMG SHA384 AUTH  AND AES128 PRIV PROTOCALS**********
    ${Status}=    fusion_ui_edit_logical_interconnects    @{TestData.ligs_add_sha3_128}
    Run Keyword And Continue On Failure   Should Be Equal    '${Status}'    'True'    ${Status}
    Wait Until Keyword Succeeds    2400 s    10 s    Verify Interconnect State    ${ICM_1}    ${State_Configured}

OVF293_UI_TC_41 AddsnmpUser_SecLevel_AuthPriv_Authentication SHA256 And Privacy AES192
    [Documentation]  EDIT LI
    Log To Console    ******EDIT LI BY ADDING A SNMPV3 USER HAVIMG SHA256 AUTH  AND AES192 PRIV PROTOCALS**********
    ${Status}=    fusion_ui_edit_logical_interconnects    @{TestData.ligs_add_sha3_192}
    Run Keyword And Continue On Failure   Should Be Equal    '${Status}'    'True'    ${Status}
    Wait Until Keyword Succeeds    2400 s    10 s    Verify Interconnect State    ${ICM_1}    ${State_Configured}

 OVF293_UI_TC_42 AddsnmpUser_SecLevel_AuthPriv_Authentication SHA384 And Privacy AES256
    [Documentation]  EDIT LI
    Log To Console    ******EDIT LI BY ADDING A SNMPV3 USER HAVIMG SHA384 AUTH  AND AES256 PRIV PROTOCALS**********
    ${Status}=    fusion_ui_edit_logical_interconnects    @{TestData.ligs_add_sha3_256}
    Run Keyword And Continue On Failure   Should Be Equal    '${Status}'    'True'    ${Status}
    Wait Until Keyword Succeeds    2400 s    10 s    Verify Interconnect State    ${ICM_1}    ${State_Configured}

    Log To Console    ******VERIFY LI**********
    ${Status}=    fusion_ui_verify_logical_interconnects    @{TestData.ligs_verifysha384}
    Run Keyword And Continue On Failure   Should Be Equal    '${Status}'    'True'    ${Status}

    Log To Console    *****DELETE USERS **********
    ${Status}=    fusion_ui_edit_logical_interconnects    @{TestData.ligs_del_sha2_256}
    Run Keyword And Continue On Failure   Should Be Equal    '${Status}'    'True'    ${Status}


OVF293_UI_TC_50 AddsnmpUser_SecLevel_AuthPriv_Authentication SHA512 And Privacy AES128
    [Documentation]  EDIT LI
    Log To Console    ******EDIT LI BY ADDING A SNMPV3 USER HAVIMG SHA512 AUTH  AND AES128 PRIV PROTOCALS**********
    ${Status}=    fusion_ui_edit_logical_interconnects    @{TestData.ligs_add_sha5_128}
    Run Keyword And Continue On Failure   Should Be Equal    '${Status}'    'True'    ${Status}
    Wait Until Keyword Succeeds    2400 s    10 s    Verify Interconnect State    ${ICM_1}    ${State_Configured}

OVF293_UI_TC_51 AddsnmpUser_SecLevel_AuthPriv_Authentication SHA512 And Privacy AES192
    [Documentation]  EDIT LI
    Log To Console    ******EDIT LI BY ADDING A SNMPV3 USER HAVIMG SHA512 AUTH  AND AES192 PRIV PROTOCALS**********
    ${Status}=    fusion_ui_edit_logical_interconnects    @{TestData.ligs_add_sha5_192}
    Run Keyword And Continue On Failure   Should Be Equal    '${Status}'    'True'    ${Status}
    Wait Until Keyword Succeeds    2400 s    10 s    Verify Interconnect State    ${ICM_1}    ${State_Configured}

 OVF293_UI_TC_52 AddsnmpUser_SecLevel_AuthPriv_Authentication SHA512 And Privacy AES256
    [Documentation]  EDIT LI
    Log To Console    ******EDIT LI BY ADDING A SNMPV3 USER HAVIMG SHA512 AUTH  AND AES256 PRIV PROTOCALS**********
    ${Status}=    fusion_ui_edit_logical_interconnects    @{TestData.ligs_add_sha5_256}
    Run Keyword And Continue On Failure   Should Be Equal    '${Status}'    'True'    ${Status}
    Wait Until Keyword Succeeds    2400 s    10 s    Verify Interconnect State    ${ICM_1}    ${State_Configured}
    
    Log To Console    ******VERIFY LI**********
    ${Status}=    fusion_ui_verify_logical_interconnects    @{TestData.ligs_verifysha512}
    Run Keyword And Continue On Failure   Should Be Equal    '${Status}'    'True'    ${Status}

    Log To Console    *****DELETE USERS **********
    ${Status}=    fusion_ui_edit_logical_interconnects    @{TestData.ligs_del_sha2_256}
    Run Keyword And Continue On Failure   Should Be Equal    '${Status}'    'True'    ${Status}

OVF293_UI_TC_60 Add snmp User _Un supported Auth Algorithm MD5
    [Documentation]    EDIT LI
    Log To Console    ******CREATE A LI HAVING UNSUPPORTED AUTH ALGORITHM**********
    ${Status}=    fusion_ui_edit_logical_interconnects    @{TestData.ligs_add_md5}
    Run Keyword And Continue On Failure   Should Be Equal    '${Status}'    'True'    ${Status}
    Wait Until Keyword Succeeds    2400 s    10 s    Verify Interconnect State    ${ICM_1}    ${State_Configured}


OVF293_UI_TC_61 Add snmp User _Un supported privacy Algorithm DES
    [Documentation]    EDIT LI
    Log To Console    ******CREATE A LI HAVING UNSUPPORTED AUTH ALGORITHM**********
    ${Status}=    fusion_ui_edit_logical_interconnects    @{TestData.ligs_add_des}
    Run Keyword And Continue On Failure   Should Be Equal    '${Status}'    'True'    ${Status}
   Wait Until Keyword Succeeds    2400 s    10 s    Verify Interconnect State    ${ICM_1}    ${State_Configured}

OVF293_UI_TC_62 Add snmp User_Validate Pass phrase length for Authentication Algorithm
    [Documentation]    EDIT LI
    Log To Console    ******CREATE A LI HAVING UNSUPPORTED AUTH ALGORITHM**********
    ${Status}=    fusion_ui_edit_logical_interconnects    @{TestData.ligs_add_authpass}
    Run Keyword And Continue On Failure   Should Be Equal    '${Status}'    'True'    ${Status}
    Wait Until Keyword Succeeds    2400 s    10 s    Verify Interconnect State    ${ICM_1}    ${State_Configured}


OVF293_UI_TC_63 Add snmp User_Validate Pass phrase length for privacy Algorithm
    [Documentation]    EDIT LI
     Log To Console    ******CREATE A LI HAVING UNSUPPORTED AUTH ALGORITHM**********
    ${Status}=    fusion_ui_edit_logical_interconnects    @{TestData.ligs_add_privpass}
    Run Keyword And Continue On Failure   Should Be Equal    '${Status}'    'True'    ${Status}
    Wait Until Keyword Succeeds    2400 s    10 s    Verify Interconnect State    ${ICM_1}    ${State_Configured}



OVF293_UI_TC_64 Add snmp user_Auth password and confirm password different
    [Documentation]    EDIT LI
    Log To Console    *****EDIT LI WITH SNMV3 USER HAVING MISMATCHED AUTH PROTOCAL PASSWORD**********
    ${Status}=    fusion_ui_edit_logical_interconnects    @{TestData.ligs_add1_invalidauthpassword}
    Run Keyword And Continue On Failure   Should Be Equal    '${Status}'    'True'    ${Status}
    Wait Until Keyword Succeeds    2400 s    10 s    Verify Interconnect State    ${ICM_1}    ${State_Configured}

OVF293_UI_TC_65 Add snmp user Priv password and confirm password different
    [Documentation]    EDIT LI
    Log To Console    *****EDIT LI WITH SNMV3 USER HAVING MISMATCHED PRIVACY PROTOCAL PASSWORD**********
    ${Status}=    fusion_ui_edit_logical_interconnects    @{TestData.ligs_add1_invalidprivpassword}
    Run Keyword And Continue On Failure   Should Be Equal    '${Status}'    'True'    ${Status}
    Wait Until Keyword Succeeds    2400 s    10 s    Verify Interconnect State    ${ICM_1}    ${State_Configured}



OVF293_UI_TC_66 Add snmp user_ Same password entered in Auth and Privilege password
    [Documentation]   EDIT LI
    Log To Console    *****EDIT LI WITH SNMV3 USER HAVING MISMATCHED AUTH ANDPRIVACY PROTOCAL PASSWORD**********
    ${Status}=    fusion_ui_edit_logical_interconnects    @{TestData.ligs_add1_samepwd}
    Run Keyword And Continue On Failure   Should Be Equal    '${Status}'    'True'    ${Status}
    Wait Until Keyword Succeeds    2400 s    10 s    Verify Interconnect State    ${ICM_1}    ${State_Configured}

    Log To Console    *****EDIT LI WITH SNMV3 USER HAVING MISMATCHED AUTH ANDPRIVACY PROTOCAL PASSWORD**********
    ${Status}=    fusion_ui_edit_logical_interconnects    @{TestData.ligs_add1_remsamepwd}
    Run Keyword And Continue On Failure   Should Be Equal    '${Status}'    'True'    ${Status}
    Wait Until Keyword Succeeds    2400 s    10 s    Verify Interconnect State    ${ICM_1}    ${State_Configured}

OVF293_UI_TC_67 Modify snmp User Auth and Privacy details
    [Documentation]    EDIT LI
    Log To Console    ******EDIT LI**********
    #Log To Console    **This LI has the below users:\n Authentication SHA-512 And Privacy AES192 \nAuthentication SHA-512
    ${Status}=    fusion_ui_edit_logical_interconnects    @{TestData.ligs_addmod}
    Run Keyword And Continue On Failure   Should Be Equal    '${Status}'    'True'    ${Status}
    Wait Until Keyword Succeeds    2400 s    10 s    Verify Interconnect State    ${ICM_1}    ${State_Configured}

    Log To Console    ******EDIT LI**********
    ${Status}=    fusion_ui_edit_logical_interconnects    @{TestData.ligs_edit_1}
    Run Keyword And Continue On Failure   Should Be Equal    '${Status}'    'True'    ${Status}

     Log To Console    *****DELETE USERS FROM LI**********
    ${Status}=    fusion_ui_edit_logical_interconnects    @{TestData.ligs_deladdmod}
    Run Keyword And Continue On Failure   Should Be Equal    '${Status}'    'True'    ${Status}
    Wait Until Keyword Succeeds    2400 s    10 s    Verify Interconnect State    ${ICM_1}    ${State_Configured}

OVF293_UI_TC_77 Modify snmp User_With compliant Authentication and Privacy Algorithm
    [Documentation]    EDIT LI
    Log To Console    *****EDIT LI**********
    #Log To Console    **This LIG has the below users:\n Authentication SHA-512 And Privacy AES192 \nAuthentication SHA-512
    ${Status}=    fusion_ui_edit_logical_interconnects    @{TestData.ligs_addmod}
    Run Keyword And Continue On Failure   Should Be Equal    '${Status}'    'True'    ${Status}


    Log To Console    ******EDIT LI**********
    ${Status}=    fusion_ui_edit_logical_interconnects    @{TestData.ligs_edit_2}
    Run Keyword And Continue On Failure   Should Be Equal    '${Status}'    'True'    ${Status}

     Log To Console    *****DELETE USERS **********
    ${Status}=    fusion_ui_edit_logical_interconnects    @{TestData.ligs_deladdmod}
    Run Keyword And Continue On Failure   Should Be Equal    '${Status}'    'True'    ${Status}

OVF293_UI_TC_78 Modify snmp User_With non compliant Authentication Algorithm
    [Documentation]    EDIT LI
    Log To Console    *****EDIT LI**********
    #Log To Console    **This LIG has the below users:\n Authentication SHA-512 And Privacy AES192 \nAuthentication SHA-512
    ${Status}=    fusion_ui_edit_logical_interconnects    @{TestData.ligs_addmod}
    Run Keyword And Continue On Failure   Should Be Equal    '${Status}'    'True'    ${Status}


    Log To Console    ******EDIT LI**********
    ${Status}=    fusion_ui_edit_logical_interconnects    @{TestData.ligs_edit_nc_auth}
    Run Keyword And Continue On Failure   Should Be Equal    '${Status}'    'True'    ${Status}


OVF293_UI_TC_79 Modify snmp User_With non compliant Privacy Algorithm
    [Documentation]    EDIT LI
    Log To Console    ******EDIT LI**********
    ${Status}=    fusion_ui_edit_logical_interconnects    @{TestData.ligs_edit_nc_priv}
    Run Keyword And Continue On Failure   Should Be Equal    '${Status}'    'True'    ${Status}

OVF293_UI_TC_80 Modify snmp User_With non compliant Authentication and Privacy Algorithm
    [Documentation]    EDIT LI
    Log To Console    ******EDIT LI**********
    ${Status}=    fusion_ui_edit_logical_interconnects    @{TestData.ligs_edit_nc}
    Run Keyword And Continue On Failure   Should Be Equal    '${Status}'    'True'    ${Status}


OVF293_UI_TC_81 Modify snmp User_Validate Pass phrase length for Authentication Algorithm
    [Documentation]    EDIT LI
    Log To Console    ******EDIT LI**********
    ${Status}=    fusion_ui_edit_logical_interconnects    @{TestData.ligs_edit_nc_authpass}
    Run Keyword And Continue On Failure   Should Be Equal    '${Status}'    'True'    ${Status}


OVF293_UI_TC_82 Modify snmp User_Validate Pass phrase length for Privacy Algorithm
    [Documentation]    EDIT LI
    Log To Console    ******EDIT LI**********
    ${Status}=    fusion_ui_edit_logical_interconnects    @{TestData.ligs_edit_nc_privpass}
    Run Keyword And Continue On Failure   Should Be Equal    '${Status}'    'True'    ${Status}



OVF293_UI_TC_83 Remove SNMP user with traps associated
    [Documentation]    EDIT LI
    Log To Console    ******EDIT LI TO ADD TRAP**********
    ${Status}=    fusion_ui_edit_logical_interconnects    @{TestData.ligs_edit_7}
    Run Keyword And Continue On Failure   Should Be Equal    '${Status}'    'True'    ${Status}


    Log To Console    ******EDIT LI TO REMOVE USER**********
    ${Status}=    fusion_ui_edit_logical_interconnects    @{TestData.ligs_edit_8}
    Run Keyword And Continue On Failure   Should Be Equal    '${Status}'    'True'    ${Status}



OVF293_UI_TC_84 Remove SNMP user with multiple traps associated

    [Documentation]    EDIT LI


    Log To Console    ******EDIT LI TO ADD TRAP**********
    ${Status}=    fusion_ui_edit_logical_interconnects    @{TestData.ligs_add_mtrap}
    Run Keyword And Continue On Failure   Should Be Equal    '${Status}'    'True'    ${Status}


    Log To Console    ******EDIT LI TO REMOVE USER**********
    ${Status}=    fusion_ui_edit_logical_interconnects    @{TestData.ligs_edit_mtrap}
    Run Keyword And Continue On Failure   Should Be Equal    '${Status}'    'True'    ${Status}

OVF293_UI_TC_119 Remove snmp trap entries
    [Documentation]   EDIT LI
     Log To Console    ******EDIT LI TO REMOVE TRAP DESTINATION**********
    ${Status}=    fusion_ui_edit_logical_interconnects    @{TestData.ligs_del_mtrap}
    Run Keyword And Continue On Failure   Should Be Equal    '${Status}'    'True'    ${Status}


OVF293_UI_TC_85 Remove SNMP user with no traps associated
    [Documentation]    EDIT LI
    Log To Console    ******EDIT LI TO REMOVE USER**********
    ${Status}=    fusion_ui_edit_logical_interconnects    @{TestData.ligs_edit_9}
    Run Keyword And Continue On Failure   Should Be Equal    '${Status}'    'True'    ${Status}
    Wait Until Keyword Succeeds    2400 s    10 s    Verify Interconnect State    ${ICM_1}    ${State_Configured}



OVF293_UI_TC_101 Add Trap v1 and v2 modes
    [Documentation]    EDIT LI
    Log To Console    *****EDIT LI TO ADD V1/V2 TRAPS**********
    ${Status}=    fusion_ui_edit_logical_interconnects    @{TestData.ligs_createlig}
    Run Keyword And Continue On Failure   Should Be Equal    '${Status}'    'True'    ${Status}





*** Keywords ***
Get IC
    [Documentation]    Getting Interconnect Information
    [Arguments]        ${ICM_NAME}
    ${resp} =   fusion api get interconnect
    Log        ${resp}
    ${ics} =     Get From Dictionary     ${resp}    members
    ${l} =     Get Length    ${ics}
    :FOR    ${x}    IN RANGE    0    ${l}
    \   ${ic} =     Get From List   ${ics}    ${x}
    \     Exit For Loop If     '${ic['name']}' == '${ICM_NAME}'
    [Return]    ${ic}

Verify Interconnect State
    [Documentation]    Verifying interconnect state
    Fusion Api Login Appliance         ${APPLIANCE_IP}        ${admin_credentials}
    [Arguments]        ${ICM_1}        ${POWER_STATE}
    ${ic} =        Get IC        ${ICM_1}
    ${State} =    Get From IC        ${ic}    state
    Log to console and logfile        \tICM state is ${ICM_1}:${State}
    Should Be Equal As Strings    ${State}    ${POWER_STATE}
