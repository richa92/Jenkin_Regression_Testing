*** Settings ***
*** Settings ***

Documentation      F1022 UI Integration Tests for RoboGalaxy dev Branch
Resource           F1682_Config.txt
Resource           ../../../../RIST/UI/resource.txt
Force Tags         Buildup
Test Setup         Load Test Data and Open Browser
Test Teardown      Logout And Close All Browsers

Library             SSHLibrary
Library            String
Library            Collections


*** Variables ***
${User}     Administrator
${User1}    Backup
${User2}    Network
${SeleniumSpeed}      0.1
${POTASSIUM}        Synergy 40Gb F8 Switch Module
${POTASH}           Virtual Connect SE 40Gb F8 Module for Synergy
${POTASH1}          Virtual Connect SE 40Gb F8 Module for Synergy
${CHLORIDE20}       Synergy 20Gb Interconnect Link Module

${li_name}   LE_1Enc_HA-LIG-bay3-1enc
 ${li_name_A}  LE_1Enc_HA-LIG-bay3-1enc_A
 ${li_name_B}  LE_1Enc_HA-LIG-bay3-1enc_B
${ui26_msg}   An uplink set may not contain both split and un-split uplink ports.
${ui26_resl}   Specify only split or only un-split ports in an uplink set.

*** Keywords ***



*** Test Cases ***

F1022_TC_1: Add valid FCUpgrade Licenses via UI
  [Documentation]   Adds FC Licenses to the oneview
  Set Log Level  TRACE
  Log into Fusion appliance as Administrator
  fusion_ui_add_license  @{TestData.licenses1}
  fusion_ui_add_license  @{TestData.licenses2}
  ${status}=  Fusion UI Create Ethernet Network   @{TestData.networks}
  run keyword if    '${status}'=='False'    Fail      "Ethernt networks not created" 

F1682_TC_UI_23_synergy:Verify CreateLIGuplink displays speed and AutoNegotiation columns for Potash Qx ports, with Speed=combo of [Auto,40Gb/s] & AN=[Enabled,Disabled] text.
  Log into Fusion appliance as Administrator
  ${Status}=    fusion_ui_create_tbird_logical_interconnect_group    @{TestData.ligui_23}
   run keyword if    '${status}'=='False'    Fail      "lig not created"

F1682_TC_UI_24_synergy: Verify CreateLIG uplink if Qx port is not used, Speed and AN column are hidden
  Log into Fusion appliance as Administrator
  ${Status}=    fusion_ui_create_tbird_logical_interconnect_group    @{TestData.ligui_24}
  run keyword if    '${status}'=='False'    Fail      "lig not created"

F1682_TC_UI_26_Synergy: verify CreateLIG uplink we cant select both split Q1=40G and unsplit versions of the same port Q1.2
  Log into Fusion appliance as Administrator
  ${status}=    run keyword and expect error    *   fusion_ui_create_tbird_logical_interconnect_group    @{TestData.ligui_26}
  should contain  ${status}   ${ui26_msg}
  should contain  ${status}   ${ui26_resl}
  fusion_ui_delete_logical_interconnect_group    @{TestData.ligui_26}


F1682_TC_UI_28_Synergy:Verify CreateLIG uplink with untagged network type
  Log into Fusion appliance as Administrator
  ${Status}=    fusion_ui_create_tbird_logical_interconnect_group    @{TestData.ligui_28}
  run keyword if    '${status}'=='False'    Fail      "lig not created"

F1682_TC_UI_29_Synergy:Verify CreateLIG uplink with Tunnel network type
  Log into Fusion appliance as Administrator
  ${Status}=    fusion_ui_create_tbird_logical_interconnect_group    @{TestData.ligui_29}
  run keyword if    '${status}'=='False'    Fail      "lig not created"

F1682_TC_UI_30_Synergy:Verify CreateLIG uplink with Untagged Uplinktype and HA configuration
  Log into Fusion appliance as Administrator
  ${Status}=    fusion_ui_create_tbird_logical_interconnect_group    @{TestData.ligui_30}
  run keyword if    '${status}'=='False'    Fail      "lig not created"  


F1682_TC_UI_32.1_synergy:Verify LIG uplink uls section
   Log into Fusion appliance as Administrator
   ${Status}=    fusion_ui_create_tbird_logical_interconnect_group    @{TestData.ligui_32_1}
   run keyword if    '${status}'=='False'    Fail      "lig not created"
   fusion_ui_verify_logical_interconnect_group  @{TestData.ligui_32_1v}
   


F1682_TC_UI_32.2_synergy:Verify LIG uplink,if Q1 used in Uplink1, will not be listed for uplink 2 
   Log into Fusion appliance as Administrator
   ${Status}=    fusion_ui_create_tbird_logical_interconnect_group    @{TestData.ligui_32_2}
   run keyword if    '${status}'=='False'    Fail      "lig not created"
   fusion_ui_verify_logical_interconnect_group  @{TestData.ligui_32_2v}
   

F1682_TC_UI_preq_synergy:Create LIG as prereq to create LI and LE 
   Log into Fusion appliance as Administrator
   ${Status}=    fusion_ui_create_tbird_logical_interconnect_group    @{TestData.ligs_A}
   fusion_ui_create_tbird_enclosure_group    @{TestData.encgroups_multi}
   Run Keyword And Continue On Failure   Should Be Equal   '${Status}'   'True'   ${Status}
   ${status}=   fusion_ui_create_tbird_logical_enclosure   @{TestData.les_multi}
   run keyword if    '${status}'=='False'    Fail      "le not created"

F1682_TC_UI_35_synergy: Verify EditLI-In uplink1 Add Q3=40G, & modify Uplink2-Q2=Auto successfully.
   Log into Fusion appliance as Administrator
   ${status}=  fusion_ui_edit_logical_interconnects   @{TestData.editli_35}
   log to console   ${status}
   ${status}=  fusion_ui_edit_logical_interconnects   @{TestData.editli_35a}
   log to console   ${status}
   ${msgs}=  Fusion Ui Get Li Active Message List   LE_1Enc_HA-LIG_UI_f1682
   log to console   ${msgs}
   should contain    ${msgs}  For uplink set Uplink1, uplink ports WPSTENC100, interconnect 3 :Q1 are non operational.

F1682_TC_UI_36_synergy: verify In LI> ULS, the Uplinks display the Qx,Qx:1 ports, speed and Auto negotiation status correctly
   Log into Fusion appliance as Administrator
   ${status}=  fusion_ui_edit_logical_interconnects   @{TestData.editli_36}
   ${status}=  fusion_ui_edit_logical_interconnects   @{TestData.editli_36a}
   log to console   ${status}
   ${uplinkdata}=  fusion_ui_get_li_uplink_port_data    @{TestData.getli_36}
   
   
   :for  ${ports}  IN  ${uplinkdata}  
   \   ${port}=  get matches      ${ports[0]}  ${li_intents_36_val[0][0]}  
   \   run keyword if   ${port} == ${null}   continue for loop
   \   log to console    contians:${port}
   \   ${speed}=  get matches      ${ports[0]}  ${li_intents_36_val[0][1]}*
   \   should match   ${speed[0]}    ${li_intents_36_val[0][1]}
   \   ${oprspeed}=  get matches      ${ports[0]}  ${li_intents_36_val[0][2]}*
   \   should match   ${oprspeed[0]}    ${li_intents_36_val[0][2]}
   \   ${autoneg}=  get matches      ${ports[0]}  ${li_intents_36_val[0][3]}*
   \   run keyword if   ${autoneg} != ${null}   should match   ${autoneg[0]}   ${li_intents_36_val[0][3]}
   \   ${linkstate}=  get matches      ${ports[0]}  ${li_intents_36_val[0][4]}*
   \   run keyword if   ${linkstate} != ${null}   should contain   ${linkstate[0]}   ${li_intents_36_val[0][4]}
   
  
F1682_TC_UI_38_Synergy: LIG compliance
   Log into Fusion appliance as Administrator
   fusion_ui_update_logical_interconnect_from_group   @{TestData.editli_38}
   ${status}=  fusion_ui_edit_logical_interconnects   @{TestData.editli_38a} 
   ${msgs}=  Fusion Ui Get Li Active Message List   LE_1Enc_HA-LIG_UI_f1682
   should contain   ${msgs}   The logical interconnect is inconsistent with the logical interconnect group LIG_UI_f1682.
   

F1682_TC_UI_55_Synergy: Edit Uplink in differenet bays having same port numbers
    Log into Fusion appliance as Administrator
    ${status}=  fusion_ui_edit_logical_interconnects   @{TestData.editli_36}
    run keyword if    '${status}'=='False'    Fail      "li not edited"
    ${status}=  fusion_ui_edit_logical_interconnects   @{TestData.editli_55}
    run keyword if    '${status}'=='False'    Fail      "li not edited"
    
    
F1682_TC_UII_56_Synergy: Edit Uplink LI with all Qx:x ports set to Auto
    Log into Fusion appliance as Administrator
    ${status}=  fusion_ui_edit_logical_interconnects   @{TestData.editli_36}
    ${status}=  fusion_ui_edit_logical_interconnects   @{TestData.editli_56}
    run keyword if    '${status}'=='False'    Fail      "li not edited"