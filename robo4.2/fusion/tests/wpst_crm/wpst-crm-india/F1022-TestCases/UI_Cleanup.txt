*** Settings ***
Documentation		Feature Test: F1022 Synergy FC Upgrade Licensing
...                 Includes FC licensing for Potash and Potassium API Tests
...
Variables     data_variables.py
#Suite Setup   Run FTS and test-specific setup
#Suite Teardown   Suite Teardown
Resource            ../../../resource/fusion_api_all_resource_files.txt
Library      Collections
Library      json
Library      OperatingSystem

*** Variables ***
${SSH_PASS}                 hpvse1
${APPLIANCE_IP}    15.212.160.153
${VM}     15.212.160.153


*** Test Cases ***

remove all entities for UI test
  Fusion Api Login Appliance   ${APPLIANCE_IP}  ${admin_credentials}
  Remove All Server Profiles
  Remove All Logical Enclosures
  Remove All Logical Enclosures
  Remove All Enclosure Groups
  Remove All LIGs
  Remove All Ethernet Networks
  Remove All FC Networks
  Remove All FCoE Networks
  ${resp}=  fusion api get licenses
  :FOR  ${av}  IN  @{resp['members']}
  \   ${resp}=   fusion_api_remove_license    uri=${av['uri']}
  
  
*** Keywords ***
SSH to host and ping x
    [Documentation]    SSH's to a given host, then pings an IP from that host
    [Arguments]	       ${HOST}    ${HOST2}
    Open Connection And Log In      ${HOST}
    ${Output}=    Execute Command    ping -c 4 ${HOST2}    return_stdout=True    return_rc=False
    Log to console and logfile    ${Output}
    Should Contain    ${Output}    ttl=
    Close All Connections

FTS
  Set Log Level   DEBUG
    Get VM IP   ${VM}
  First Time Setup    password=hpvse123

Test Specific Setup
  Set Log Level	TRACE
  ${TEST_NAME} =      Set Variable    TEST-SPECIFIC SETUP
  Run Keyword and Ignore Error    Write To ciDebug Log
  Log to console and logfile  [TEST-SPECIFIC SETUP]
  Fusion Api Login Appliance   ${APPLIANCE_IP}  ${admin_credentials}
  ${users} =  Get Variable Value  ${users}
  Run Keyword If   ${users} is not ${null}    Add Users from variable   ${users}
  
    Login all users     ${users}

Run FTS and test-specific setup
    Set Log Level   TRACE
    FTS
    Test Specific Setup

