*** Settings ***
Documentation       Feature Test: F1211
...                 Updated test to include Carbon firmware update tests
...
Variables           data_variables.py		
#Suite Setup        Run FTS and test-specific setup
#Suite Teardown     Suite Teardown
Resource            ../../../resource/fusion_api_all_resource_files.txt
Resource            F1211_API_Resources.txt

Library             Collections
Library             json
Library             OperatingSystem

*** Variables ***

${APPLIANCE_IP}             10.10.3.99

*** Test Cases ***

00 Appliance LogIn
    #${Creds}    Create Dictionary   userName    ${USERNAME} password    ${PASSWORD}
    Fusion Api Login Appliance     ${APPLIANCE_IP}   ${login_details}
    #
    ${users} =  Get Variable Value  ${users}
    Run Keyword If  ${users} is not ${null}    Add F1211 Users from variable              ${users}

Clean Appliance
    Log to console    \nCleaning Appliance
    Run Keyword and Ignore Error    Remove All LEs
    Run Keyword and Ignore Error    Remove EG and LIG
    Run Keyword and Ignore Error    Remove All FC Networks
    #Run Keyword and Ignore Error    Power off ALL servers
    #Run Keyword and Ignore Error    server_profile.Remove All Server Profiles

Create LIG EG before starting tests
    log to console    Creating Setup
    Create LIG    ${lig_tbird_a_1}
    Create EG    ${enc_groups_carbon_a1}
    Create LIG    ${lig_tbird_b_4}
    Create EG    ${enc_groups_carbon_b4}
    #Create LIG    ${lig_tbird_a_2}
    #Create EG    ${enc_groups_carbon_a2}
    #Create LIG    ${lig_tbird_b_5}
    #Create EG    ${enc_groups_carbon_b5}
    Create LIG    ${lig_tbird_1_4}
    Create EG    ${enc_groups_carbon_1_4}
    #Create LIG    ${lig_tbird_2_5}
    #Create EG    ${enc_groups_carbon_2_5}
    #Create LIG    ${lig_tbird_1_4_2_5}
    #Create EG    ${enc_groups_carbon_1_4_2_5}

F1211_TC_35 : Carbon in Bay 2 and perform LE parallel fwu with Compatible fw 
    #
    #Create LIG    @{TestData.ligs_a_2}
    #Create EG     @{TestData.encgroups_a_2}
    Run Keyword and Ignore Error    Remove All LEs
    Create LE     @{TestData.les_a_2}
    Update LE Firmware  ${LE_fw_update_Carbon_sharedinfra}    TB_CAR_LE_A2
    #
    ${data}=    Check ICM Data    ${ICM_a_2}
    #log to console    ${data}
    #
    ${frmversion} =     Get From Dictionary     ${data}    frmversion
    log to console    'ICM Firmware version is ${frmversion}'
    Should Be Equal As Strings    ${frmversion}    ${UPGRADE_FIRMWARE}
    #
    ${powerstate} =     Get From Dictionary     ${data}    powerstate
    log to console   'Power state of ICM is ${powerstate}'
    Should Be Equal As Strings    ${powerstate}    On
    #
    ${emdata}=    Get ICM Data From EM    2
    ${d1} =    Get From Dictionary    ${emdata}    FirmwareVersion
    Should Be Equal As Strings    ${d1}  ${UPGRADE_FIRMWARE}
    #

F1211_TC_36 : Carbon in Bay 5 and perform LE parallel fwu with Compatible fw 
    Run Keyword and Ignore Error    Remove All LEs
    #Create LIG    @{TestData.ligs_b_5}
    #Create EG     @{TestData.encgroups_b_5}
    Create LE     @{TestData.les_b_5}
    #Update Carbon Firmware From LI    @{TestData.li_para_upgrade_b_5}[0]
    Update LE Firmware  ${LE_fw_update_Carbon_sharedinfra}    TB_CAR_LE_B5
    #
    ${data}=    Check ICM Data    ${ICM_b_5}
    log to console    ${data}
    ${frmversion} =     Get From Dictionary     ${data}    frmversion
    log to console    ICM Firmware version is ${frmversion}
    Should Be Equal As Strings    ${frmversion}    ${UPGRADE_FIRMWARE}
    #
    ${powerstate} =     Get From Dictionary     ${data}    powerstate
    log to console    Power state of ICM is ${powerstate}
    Should Be Equal As Strings    ${powerstate}    On
    #
    ${emdata}=    Get ICM Data From EM    5
    ${d1} =    Get From Dictionary    ${emdata}    FirmwareVersion
    Should Be Equal As Strings    ${d1}  ${UPGRADE_FIRMWARE}
    #
    