*** Settings ***
Documentation     F223-LIG_LI Compliance in SNMP Configuration
Library         OperatingSystem
Library         FusionLibrary
Library         RoboGalaxyLibrary
Library         Telnet
Library         SSHLibrary
Library         data_variables
Variables       data_variables.py
Resource         ../../../../resource/fusion_api_all_resource_files.txt
Library         String
Variables       Expected_messages.py

*** Variables ***
${APPLIANCE_IP}    15.212.136.118
${LE}    Encl1
${LIG_1}    LIG1
${ENC_1}    Encl1

*** Comments ***
Initial Setup
    [Documentation]    Initial Setup
    Set Log Level    TRACE
    ${Login_resp}    Fusion Api Login Appliance    ${APPLIANCE_IP}    ${admin_credentials}
    Run keyword unless  ${Login_resp[0]['status_code']}== 200   Fail    "Unable to Login"

    Remove All Enclosures
    Remove ALL Enclosure Groups
    Remove ALL LIGs
    Remove All Network Sets
    Remove ALL Ethernet Networks
    Remove ALL FC Networks
    Remove ALL FCoE Networks

    ${body} =   Build LIG body      ${LIGS_TB}
    Log to console and logfile    ${body}
    ${lig_resp}    Fusion Api Create LIG    ${body}
    ${task} =   Wait For Task    ${lig_resp}    400s    2s
    Run Keyword If  '${lig_resp['status_code']}' != '202'   fail    ELSE    Log to Console  \n-LIG  created successfully

    ${eg_resp}    Add Enclosure Group from variable    ${enc_group}
    Log to console    \n Resp is : ${eg_resp}
    Run Keyword If  '${eg_resp['status_code']}' != '201'  Fail    ELSE  log to console   \n-EG created successfully

    Add Enclosures from variable     ${encs}
    Log to console and logfile    Enclosure imported succesfully

    ${li_uri} =     Get LI URI   ${LE}-${LIG_1}
    Set Global Variable    ${LIURI}    ${li_uri}


OVF223_TC_1_2_3_26 Enable SNMPv1,v2 LIG_Compliance_Verify update from group in LI

    [Documentation]    Edit LIG-Check for the Compliance alert and event in LI
    ${Get_lig}    Fusion Api Get Lig    param=?filter="'name'=='${LIGS_TB['name']}'"
    Log to console    \nLIG Name is :${Get_lig}

    ${Get_lig_body}    Copy Dictionary    ${Get_lig['members']}
    Log to console    \nLIG Body is :${Get_lig}

    ${lig_uri} =     Get LIG URI   ${LIG_1}
    ${getresp} =    Fusion Api Get Lig   ${lig_uri}

    Should Be Equal as Strings      ${Get_lig_body[0]['snmpConfiguration']['enabled']}       ${Snmp_False}       msg=SNMPv1,v2 is enabled.
    ${Edit_lig_body}    ${lig_uri}    Build Edit LIG Body    ${LIGS_TB}    ${Edit_Lig_Snmpv1_v2}
    Log to console    \nEdit LIG Body is :${Edit_lig_body}
    ${Edit_snmp}    Build SNMP body    ${Edit_lig_body}    ${Snmp_True}
    Log to console    \nBuild SNMP Body is :${Edit_snmp}
    Set To Dictionary    ${Edit_lig_body['snmpConfiguration']}    enabled    ${Snmp_True}
    Set To Dictionary    ${Edit_lig_body['snmpConfiguration']}    readCommunity    ${community_string}
    Log to console    \nSNMP Value is :${Edit_lig_body['snmpConfiguration']}
    Log to console    \nAFter snmp :${Edit_lig_body}

    ${Snmp_edit}    Fusion Api Edit Lig   ${Edit_lig_body}    ${lig_uri}
    Log to console    \nResp is :${Snmp_edit}

    ${task} =   Wait For Task    ${Snmp_edit}    400s    2s

    Verify LI/LIG Consistent Status    ${Expected_Non_Consistency_Status}    ${LE}-${LIG_1}

    ${lig_uri} =     Get LIG URI   ${LIG_1}
    ${getresp} =    Fusion Api Get Lig   ${lig_uri}
    ${snmp_config} =     Get From Dictionary     ${getresp}  snmpConfiguration
    Log to console and logfile    ${snmp_config}
    ${Comm_string} =    Get From Dictionary     ${snmp_config}   readCommunity
    ${Comm_string1}    Convert To String    ${Comm_string}

    ${Alert_SNMP_ReadCommunity}    Replace String Using Regexp   ${SNMP_V1_V2_ENABLE_WITH_READ_COMMUNITY}    XXX    ${Comm_string1}

    ${SNMP_lig_compliance_alert}    Built the Alert list    ${Alert_SNMP_ReadCommunity}

    ${Alert_message}    Get Alert and Compliance Message    ${SNMP_lig_compliance_alert}
    ${li_uri} =     Get LI URI   ${LE}-${LIG_1}
    Perform an LI Update From Group    ${LIURI}

    :For    ${x}    INRANGE    1    3
    \    Wait Until Keyword Succeeds    650s   35 s    Verify Interconnect State    ${Interconnect_${x}}    ${IC_Configured}

    Verify LI/LIG Consistent Status    ${Expected_Consistency_Status}    ${LE}-${LIG_1}

OVF223_TC_4_25 Disable SNMPv1,v2 LIG_Compliance_Edit LI and verify the Alerts are cleared
    [Documentation]    Edit LIG-Check for the Compliance alert and event in LI
    ${Edit_lig_body}    ${lig_uri}    Build Edit LIG Body    ${LIGS_TB}    ${Edit_Lig_Snmpv1_v2}
    ${Edit_snmp}    Build SNMP body    ${Edit_lig_body}    ${Snmp_False}
    Set To Dictionary    ${Edit_lig_body['snmpConfiguration']}    enabled    ${Snmp_False}

    ${Snmp_edit}    Fusion Api Edit Lig    ${Edit_lig_body}    ${lig_uri}
    ${task} =   Wait For Task    ${Snmp_edit}    400s    2s

    Verify LI/LIG Consistent Status    ${Expected_Non_Consistency_Status}    ${LE}-${LIG_1}

    ${SNMP_lig_compliance_alert}    Built the Alert list    ${SNMP_V1_V2_DISABLE}

    ${Alert_message}    Get Alert and Compliance Message    ${SNMP_lig_compliance_alert}

    ${li_uri} =     Get LI URI   ${LE}-${LIG_1}
    Set Global Variable    ${LIURI}    ${li_uri}

    ${Edit_snmp}    Build SNMP LI body    ${SNMP_Config}    ${Snmp_False}
    ${Edit_snmp_li}    Fusion Api Update snmp configuration    ${Edit_snmp}    ${LIURI}
    ${task} =   Wait For Task    ${Edit_snmp_li}    400s    2s

    :For    ${x}    INRANGE    1    3
    \    Wait Until Keyword Succeeds    650s   35 s    Verify Interconnect State    ${Interconnect_${x}}    ${IC_Configured}

    Verify LI/LIG Consistent Status    ${Expected_Consistency_Status}    ${LE}-${LIG_1}

OVF223_TC_5 Disable SNMPv3 LIG_Compliance
    [Documentation]    Edit LIG-Check for the Compliance alert and event in LI
    ${Edit_lig_body}    ${lig_uri}    Build Edit LIG Body    ${LIGS_TB}    ${Edit_Lig_Snmpv1_v2}
    Set To Dictionary    ${Edit_lig_body['snmpConfiguration']}    v3Enabled    ${Snmp_False}

    ${Snmp_edit}    Fusion Api Edit Lig    ${Edit_lig_body}    ${lig_uri}
    ${task} =   Wait For Task    ${Snmp_edit}    400s    2s

    Verify LI/LIG Consistent Status    ${Expected_Non_Consistency_Status}    ${LE}-${LIG_1}

    ${SNMP_lig_compliance_alert}    Built the Alert list    ${SNMP_V3_DISABLE}

    ${Alert_message}    Get Alert and Compliance Message    ${SNMP_lig_compliance_alert}
    ${li_uri} =     Get LI URI   ${LE}-${LIG_1}
    Perform an LI Update From Group    ${LIURI}

    :For    ${x}    INRANGE    1    3
    \    Wait Until Keyword Succeeds    650s   35 s    Verify Interconnect State    ${Interconnect_${x}}    ${IC_Configured}

    Verify LI/LIG Consistent Status    ${Expected_Consistency_Status}    ${LE}-${LIG_1}


OVF223_TC_24 Add System contact LIG_Compliance
    [Documentation]    Edit LIG-Check for the Compliance alert and event in LI
    ${Edit_lig_body}    ${lig_uri}    Build Edit LIG Body    ${LIGS_TB}    ${Edit_Lig_Snmpv1_v2}
    Set To Dictionary    ${Edit_lig_body['snmpConfiguration']}    systemContact    ${System_Contact}

    ${Snmp_edit}    Fusion Api Edit Lig    ${Edit_lig_body}    ${lig_uri}
    ${task} =   Wait For Task    ${Snmp_edit}    400s    2s

    Verify LI/LIG Consistent Status    ${Expected_Non_Consistency_Status}    ${LE}-${LIG_1}

    ${lig_uri} =     Get LIG URI   ${LIG_1}
    ${getresp} =    Fusion Api Get Lig   ${lig_uri}
    ${snmp_config} =     Get From Dictionary     ${getresp}  snmpConfiguration
    Log to console and logfile    ${snmp_config}
    ${sys_contact} =    Get From Dictionary     ${snmp_config}   systemContact
    ${sys_contact1}    Convert To String    ${sys_contact}

    ${Alert_SNMP_Syscontact}    Replace String Using Regexp   ${SNMP_SYSTEM_CONTACT_CHANGED}    XXX    ${sys_contact1}

    ${SNMP_lig_compliance_alert}    Built the Alert list    ${Alert_SNMP_Syscontact}

    ${Alert_message}    Get Alert and Compliance Message    ${SNMP_lig_compliance_alert}
    ${li_uri} =     Get LI URI   ${LE}-${LIG_1}
    Perform an LI Update From Group    ${LIURI}

    :For    ${x}    INRANGE    1    3
    \    Wait Until Keyword Succeeds    650s   35 s    Verify Interconnect State    ${Interconnect_${x}}    ${IC_Configured}

    Verify LI/LIG Consistent Status    ${Expected_Consistency_Status}    ${LE}-${LIG_1}

OVF223_TC_6 Enable SNMPv3 LIG_Compliance
    [Documentation]    Edit LIG-Check for the Compliance alert and event in LI
    ${Edit_lig_body}    ${lig_uri}    Build Edit LIG Body    ${LIGS_TB}    ${Edit_Lig_Snmpv1_v2}
    Set To Dictionary    ${Edit_lig_body['snmpConfiguration']}    v3Enabled    ${Snmp_True}
    Set To Dictionary    ${Edit_lig_body['snmpConfiguration']}    systemContact    ${System_Contact}

    ${Snmp_edit}    Fusion Api Edit Lig    ${Edit_lig_body}    ${lig_uri}
    ${task} =   Wait For Task    ${Snmp_edit}    400s    2s

    Verify LI/LIG Consistent Status    ${Expected_Non_Consistency_Status}    ${LE}-${LIG_1}

    ${SNMP_lig_compliance_alert}    Built the Alert list    ${SNMP_V3_ENABLE}

    ${Alert_message}    Get Alert and Compliance Message    ${SNMP_lig_compliance_alert}
    ${li_uri} =     Get LI URI   ${LE}-${LIG_1}
    Perform an LI Update From Group    ${LIURI}

    :For    ${x}    INRANGE    1    3
    \    Wait Until Keyword Succeeds    650s   35 s    Verify Interconnect State    ${Interconnect_${x}}    ${IC_Configured}

    Verify LI/LIG Consistent Status    ${Expected_Consistency_Status}    ${LE}-${LIG_1}

OVF223_TC_7 Add SNMPv3 user LIG_Compliance

    [Documentation]    Edit LIG-Check for the Compliance alert and event in LI
    ${Edit_lig_body}    ${lig_uri}    Build Edit LIG Body    ${LIGS_TB}    ${Edit_Lig_Snmpv1_v2}
    Set To Dictionary    ${Edit_lig_body['snmpConfiguration']}    snmpUsers    ${Snmpuser_add_1}
    ${Snmp_edit}    Fusion Api Edit Lig    ${Edit_lig_body}    ${lig_uri}
    ${task} =   Wait For Task    ${Snmp_edit}    400s    2s

    Verify LI/LIG Consistent Status    ${Expected_Non_Consistency_Status}    ${LE}-${LIG_1}

    ${lig_uri} =     Get LIG URI   ${LIG_1}
    ${getresp} =    Fusion Api Get Lig   ${lig_uri}
    ${snmp_config} =     Get From Dictionary     ${getresp}  snmpConfiguration
    Log to console and logfile    ${snmp_config}
    ${snmp_users} =    Get From Dictionary     ${snmp_config}   snmpUsers
    Log to console    \nUser name :${snmp_users}
    ${snmp_user_list}    Create List
    ${User_count}    Get Length    ${snmp_users}
    :For    ${x}    INRANGE    0    ${User_count}
    \    ${snmp_user_name} =    Get From Dictionary     ${snmp_users[${x}]}   snmpV3UserName
    \     Append to List    ${snmp_user_list}    ${snmp_user_name}
    Set Global Variable    ${snmp_user_list}
    ${snmp_user_name1} =    Get From Dictionary     ${Snmpuser_add_1[0]}   snmpV3UserName
    Log to console    \nUser List from Variable :${snmp_user_name1}
    Log to console    \nUser List from LIG :${snmp_user_list}
    List Should Contain Value    ${snmp_user_list}    ${snmp_user_name1}

    ${snmp_user1}    Convert To String    ${snmp_user_name}

    # Alert Verification with replace string
    ${Alert_SNMP_Add_User}    Replace String Using Regexp   ${SNMP_V3_USERS_ADDED}    XXX    ${snmp_user1}
    ${SNMP_lig_compliance_alert}    Built the Alert list    ${Alert_SNMP_Add_User}
    ${Alert_message}    Get Alert and Compliance Message    ${SNMP_lig_compliance_alert}

    ${LIURI} =     Get LI URI   ${LE}-${LIG_1}
    Perform an LI Update From Group    ${LIURI}

    :For    ${x}    INRANGE    1    3
    \    Wait Until Keyword Succeeds    650s   35 s    Verify Interconnect State    ${Interconnect_${x}}    ${IC_Configured}


    Verify LI/LIG Consistent Status    ${Expected_Consistency_Status}    ${LE}-${LIG_1}

OVF223_TC_8 Add Trap Destination LIG_Compliance

    ${lig_uri} =     Get LIG URI   ${LIG_1}
    ${Get_lig}    Fusion Api Get Lig    param=?filter="'name'=='${LIGS_TB['name']}'"
    ${Get_lig_body}    Copy Dictionary    ${Get_lig['members']}
    ${Edit_lig_body}    ${lig_uri}    Build Edit LIG Body    ${LIGS_TB}    ${Edit_Lig_Snmpv1_v2}
    #${Edit_snmp}    Build SNMP body    ${Edit_lig_body}    ${Snmp_True}
    Set To Dictionary    ${Edit_lig_body['snmpConfiguration']}    trapDestinations    ${TrapDestinations_1}
    Set To Dictionary    ${Edit_lig_body['snmpConfiguration']}    snmpUsers    ${Get_lig_body[0]['snmpConfiguration']['snmpUsers']}

    ${Snmp_edit}    Fusion Api Edit Lig    ${Edit_lig_body}    ${lig_uri}
    ${task} =   Wait For Task    ${Snmp_edit}    400s    2s
    Log to console    \n\nTask is:${task}

    Verify LI/LIG Consistent Status    ${Expected_Non_Consistency_Status}    ${LE}-${LIG_1}
    ${LIURI} =     Get LI URI   ${LE}-${LIG_1}
    ${lig_uri} =     Get LIG URI   ${LIG_1}
    ${getresp} =    Fusion Api Get Lig   ${lig_uri}
    ${snmp_config} =     Get From Dictionary     ${getresp}  snmpConfiguration
    ${snmp_trap} =    Get From Dictionary     ${snmp_config}   trapDestinations
    ${trap_list}    Create List
    ${snmp_trap_ip} =    Get From Dictionary     ${snmp_trap[0]}   trapDestination
    ${snmp_trap_dest_ip} =    Get From Dictionary     ${TrapDestinations_1[0]}   trapDestination
    List Should Contain Value    ${snmp_trap_dest_ip}    ${snmp_trap_ip}
    ${snmp_trap1}    Convert To String    ${snmp_trap_dest_ip}

    # Alert Verification with replace string
    ${Alert_SNMP_Add_Trap}    Replace String Using Regexp   ${SNMP_TRAP_DESTINATIONS_ADDED}    XXX    ${snmp_trap1}
    ${SNMP_lig_compliance_alert}    Built the Alert list    ${Alert_SNMP_Add_Trap}
    ${Alert_message}    Get Alert and Compliance Message    ${SNMP_lig_compliance_alert}
    Perform an LI Update From Group    ${LIURI}
    :For    ${x}    INRANGE    1    3
    \    Wait Until Keyword Succeeds    650s   35 s    Verify Interconnect State    ${Interconnect_${x}}    ${IC_Configured}
    Verify LI/LIG Consistent Status    ${Expected_Consistency_Status}    ${LE}-${LIG_1}

OVF223_TC_9 Add User_2 SNMPv3 LIG_Compliance
    [Documentation]    Edit LIG-Check for the Compliance alert and event in LI
    ${Snmp_user_2}    Create List
    ${Get_lig}    Fusion Api Get Lig    param=?filter="'name'=='${LIGS_TB['name']}'"
    ${Get_lig_body}    Copy Dictionary    ${Get_lig['members']}
    Append to List    ${Snmp_user_2}    ${Get_lig_body[0]['snmpConfiguration']['snmpUsers'][0]}
    Append to List    ${Snmp_user_2}    ${Snmpuser_add_2[0]}
    Log to console and logfile    ${Snmp_user_2}
    ${Edit_lig_body}    ${lig_uri}    Build Edit LIG Body    ${LIGS_TB}    ${Edit_Lig_Snmpv1_v2}
    #${Edit_snmp}    Build SNMP body    ${Edit_lig_body}    ${Snmp_False}
    Set To Dictionary    ${Edit_lig_body['snmpConfiguration']}    trapDestinations    ${Get_lig_body[0]['snmpConfiguration']['trapDestinations']}
    Set To Dictionary    ${Edit_lig_body['snmpConfiguration']}    snmpUsers    ${Snmp_user_2}

    ${Snmp_edit}    Fusion Api Edit Lig    ${Edit_lig_body}    ${lig_uri}
    ${task} =   Wait For Task    ${Snmp_edit}    400s    2s

    Verify LI/LIG Consistent Status    ${Expected_Non_Consistency_Status}    ${LE}-${LIG_1}

    ${lig_uri} =     Get LIG URI   ${LIG_1}
    ${getresp} =    Fusion Api Get Lig   ${lig_uri}
    ${snmp_config} =     Get From Dictionary     ${getresp}  snmpConfiguration
    Log to console and logfile    ${snmp_config}
    ${snmp_users} =    Get From Dictionary     ${snmp_config}   snmpUsers
    Log to console    \nUser name :${snmp_users}
    ${snmp_user_list}    Create List
    ${User_count}    Get Length    ${snmp_users}
    :For    ${x}    INRANGE    0    ${User_count}
    \    ${snmp_user_name} =    Get From Dictionary     ${snmp_users[${x}]}   snmpV3UserName
    \     Append to List    ${snmp_user_list}    ${snmp_user_name}
    Set Global Variable    ${snmp_user_list}
    ${snmp_user_name2} =    Get From Dictionary     ${Snmpuser_add_2[0]}   snmpV3UserName
    Log to console    \nUser List from Variable :${snmp_user_name2}
    Log to console    \nUser List from LIG :${snmp_user_list}
    List Should Contain Value    ${snmp_user_list}    ${snmp_user_name2}
    ${snmp_user2}    Convert To String    ${snmp_user_name2}
    Log to console    \nActual user :${snmp_user2}

    # Alert Verification with replace string
    ${Alert_SNMP_Add_User2}    Replace String Using Regexp   ${SNMP_V3_USERS_ADDED}    XXX    ${snmp_user2}
    ${SNMP_lig_compliance_alert}    Built the Alert list    ${Alert_SNMP_Add_User2}
    ${Alert_message}    Get Alert and Compliance Message    ${SNMP_lig_compliance_alert}


    ${LIURI} =     Get LI URI   ${LE}-${LIG_1}
    Perform an LI Update From Group    ${LIURI}

    :For    ${x}    INRANGE    1    3
    \    Wait Until Keyword Succeeds    650s   35 s    Verify Interconnect State    ${Interconnect_${x}}    ${IC_Configured}
    Verify LI/LIG Consistent Status    ${Expected_Consistency_Status}    ${LE}-${LIG_1}

OVF223_TC_10 Add Trap Destination LIG_Compliance
    [Documentation]    Edit LIG-Check for the Compliance alert and event in LI
    ${Trap_user_2}    Create List
    ${Get_lig}    Fusion Api Get Lig    param=?filter="'name'=='${LIGS_TB['name']}'"
    ${Get_lig_body}    Copy Dictionary    ${Get_lig['members']}
    Log to console    \nLIG Body is:${Get_lig_body}
    Append to List    ${Trap_user_2}    ${Get_lig_body[0]['snmpConfiguration']['trapDestinations'][0]}
    Append to List    ${Trap_user_2}    ${TrapDestinations_2[0]}
    Log to console and logfile    ${Trap_user_2}
    ${Edit_lig_body}    ${lig_uri}    Build Edit LIG Body    ${LIGS_TB}    ${Edit_Lig_Snmpv1_v2}
    #${Edit_snmp}    Build SNMP body    ${Edit_lig_body}    ${Snmp_False}
    Set To Dictionary    ${Edit_lig_body['snmpConfiguration']}    snmpUsers    ${Get_lig_body[0]['snmpConfiguration']['snmpUsers']}
    Set To Dictionary    ${Edit_lig_body['snmpConfiguration']}    trapDestinations    ${Trap_user_2}

    ${Snmp_edit}    Fusion Api Edit Lig    ${Edit_lig_body}    ${lig_uri}
    ${task} =   Wait For Task    ${Snmp_edit}    400s    2s

    Verify LI/LIG Consistent Status    ${Expected_Non_Consistency_Status}    ${LE}-${LIG_1}

    ${LIURI} =     Get LI URI   ${LE}-${LIG_1}
    ${lig_uri} =     Get LIG URI   ${LIG_1}
    ${getresp} =    Fusion Api Get Lig   ${lig_uri}
    ${snmp_config} =     Get From Dictionary     ${getresp}  snmpConfiguration
    ${snmp_trap} =    Get From Dictionary     ${snmp_config}   trapDestinations
    Log to console    \n\n${snmp_trap}

    ${snmp_trap_list}    Create List
    ${User_count}    Get Length    ${snmp_trap}
    :For    ${x}    INRANGE    0    ${User_count}
    \    ${snmp_ips} =    Get From Dictionary     ${snmp_trap[${x}]}   trapDestination
    \     Append to List    ${snmp_trap_list}    ${snmp_ips}
    Set Global Variable    ${snmp_trap_list}
    Log to console    \n\nTrap Ips are:${snmp_trap_list}

    ${snmp_trap_dest_ip} =    Get From Dictionary     ${TrapDestinations_2[0]}   trapDestination
    ${snmp_trap2}    Convert To String    ${snmp_trap_dest_ip}
    Log to console    \n\nTrap Ips are:${snmp_trap2}
    List Should Contain Value    ${snmp_trap_list}    ${snmp_trap2}


    # Alert Verification with replace string
    ${Alert_SNMP_Add_Trap}    Replace String Using Regexp   ${SNMP_TRAP_DESTINATIONS_ADDED}    XXX    ${snmp_trap2}
    ${SNMP_lig_compliance_alert}    Built the Alert list    ${Alert_SNMP_Add_Trap}
    ${Alert_message}    Get Alert and Compliance Message    ${SNMP_lig_compliance_alert}

    ${LIURI} =     Get LI URI   ${LE}-${LIG_1}
    Perform an LI Update From Group    ${LIURI}

    :For    ${x}    INRANGE    1    3
    \    Wait Until Keyword Succeeds    650s   35 s    Verify Interconnect State    ${Interconnect_${x}}    ${IC_Configured}

    Verify LI/LIG Consistent Status    ${Expected_Consistency_Status}    ${LE}-${LIG_1}

OVF223_TC_11 Delete Trap Destination LIG_Compliance
    [Documentation]    Edit LIG-Check for the Compliance alerts and events in LI
    ${Delete_Trap}    Create List
    ${Trap_ips}    Create List
    ${Get_lig}    Fusion Api Get Lig    param=?filter="'name'=='${LIGS_TB['name']}'"
    ${Get_lig_body}    Copy Dictionary    ${Get_lig['members']}
    Append to List    ${Delete_Trap}    ${Get_lig_body[0]['snmpConfiguration']['trapDestinations']}
    Log to console    \n Traps are:${Delete_Trap}
    Set Global Variable    ${Delete_Trap}
    Log to console    \n Traps are in Index 0:${Delete_Trap[0]}

    ${Get_lig}    Fusion Api Get Lig    param=?filter="'name'=='${LIGS_TB['name']}'"
    ${Get_lig_body}    Copy Dictionary    ${Get_lig['members']}
    ${snmp_config} =     Get From Dictionary     ${Get_lig_body}  snmpConfiguration
    Log to console    \n\nConfig is: ${snmp_config}

    ${snmp_trap_dest} =    Get From Dictionary     ${snmp_config}   trapDestinations
    Log to console    \nTRap Details are :${snmp_trap_dest}

    ${Actual_snmp_trap_list}    Create List
    ${Trap_count_1}    Get Length    ${Delete_Trap}
    Log to console    \n Length:${Trap_count_1}

    :For    ${x}    INRANGE    0    ${Trap_count_1}

    \    ${Actual_snmp_trap_ips} =    Get From Dictionary     ${Delete_Trap[${x}]}   trapDestination
    \     Append to List    ${Actual_snmp_trap_list}    ${Actual_snmp_trap_ips}
    Log to console    \n\n\nTrap List :${Actual_snmp_trap_ips}

    ${Edit_lig_body}    ${lig_uri}    Build Edit LIG Body    ${LIGS_TB}    ${Edit_Lig_Snmpv1_v2}
    Set To Dictionary    ${Edit_lig_body['snmpConfiguration']}    snmpUsers    ${Get_lig_body[0]['snmpConfiguration']['snmpUsers']}
    Set To Dictionary    ${Edit_lig_body['snmpConfiguration']}    trapDestinations    ${Delete_Trap[0]}
    Log to console    \n Edit LIG after Build LIG Body:${Edit_lig_body}

    ${Snmp_edit}    Fusion Api Edit Lig    ${Edit_lig_body}    ${lig_uri}
    ${task} =   Wait For Task    ${Snmp_edit}    400s    2s

    Verify LI/LIG Consistent Status    ${Expected_Non_Consistency_Status}    ${LE}-${LIG_1}

    ${lig_uri} =     Get LIG URI   ${LIG_1}
    ${getresp} =    Fusion Api Get Lig   ${lig_uri}
    ${snmp_config} =     Get From Dictionary     ${getresp}  snmpConfiguration
    Log to console and logfile    ${snmp_config}
    ${snmp_trap} =    Get From Dictionary     ${snmp_config}   trapDestinations

    ${snmp_trap_list}    Create List
    ${Trap_count}    Get Length    ${snmp_trap}
    :For    ${x}    INRANGE    0    ${Trap_count}
    \    ${snmp_trap_ip} =    Get From Dictionary     ${snmp_trap[${x}]}   trapDestination
    \     Append to List    ${snmp_trap_list}    ${snmp_trap_ip}
    Log to console    \n\n\nTrap List :${snmp_trap_list}

    ${Expected_snmp_trap_ip} =    Get From Dictionary     ${TrapDestinations_2[0]}   trapDestination
    Log to console    \n\n\nBefore Trap IP :${Expected_snmp_trap_ip}
    List Should Not Contain Value    ${snmp_trap_list}    ${Expected_snmp_trap_ip}
    ${snmp_trap2}    Convert To String    ${Expected_snmp_trap_ip}
    Log to console    \n\n\nAfter trap name :${snmp_trap2}

    # Alert Verification with replace string
    ${Alert_SNMP_Add_Trap}    Replace String Using Regexp   ${SNMP_TRAP_DESTINATIONS_REMOVED}    XXX    ${snmp_trap2}
    ${SNMP_lig_compliance_alert}    Built the Alert list    ${Alert_SNMP_Add_Trap}
    ${Alert_message}    Get Alert and Compliance Message    ${SNMP_lig_compliance_alert}

    ${li_uri} =     Get LI URI   ${LE}-${LIG_1}
    Set Global Variable    ${LIURI}    ${li_uri}

    Perform an LI Update From Group    ${LIURI}

    :For    ${x}    INRANGE    1    3
    \    Wait Until Keyword Succeeds    650s   35 s    Verify Interconnect State    ${Interconnect_${x}}    ${IC_Configured}

    Verify LI/LIG Consistent Status    ${Expected_Consistency_Status}    ${LE}-${LIG_1}

OVF223_TC_12 Delete User LIG_Compliance
    [Documentation]    Edit LIG-Check for the Compliance alerts and events in LI

    ${Delete_user}    Create List
    ${Get_lig}    Fusion Api Get Lig    param=?filter="'name'=='${LIGS_TB['name']}'"
    ${Get_lig_body}    Copy Dictionary    ${Get_lig['members']}
    ${Trap_User_name}    Get From Dictionary    ${Get_lig_body[0]['snmpConfiguration']['trapDestinations'][0]}    userName
    ${User_count}    Get Length    ${Get_lig_body[0]['snmpConfiguration']['snmpUsers']}
    :For    ${x}    INRANGE    0    ${User_count}
    \    ${User_name}    Get From Dictionary    ${Get_lig_body[0]['snmpConfiguration']['snmpUsers'][${x}]}    snmpV3UserName
    \    Run Keyword If    '${Trap_User_name}' != '${User_name}'    Continue For Loop
    \    Append to List    ${Delete_user}    ${Get_lig_body[0]['snmpConfiguration']['snmpUsers'][${x}]}

    :For    ${x}    INRANGE    0    ${User_count}
    \    Run Keyword If    '${Trap_User_name}' == '${User_name}'    Continue For Loop
    \    Set Global Variable    ${Trap_To_be_removed_1}    ${Trap_User_name}
    Log to console and logfile    ${Delete_user}
    ${Edit_lig_body}    ${lig_uri}    Build Edit LIG Body    ${LIGS_TB}    ${Edit_Lig_Snmpv1_v2}
    ${Edit_snmp}    Build SNMP body    ${Edit_lig_body}    ${Snmp_False}
    Set To Dictionary    ${Edit_snmp['snmpConfiguration']}    trapDestinations    ${Get_lig_body[0]['snmpConfiguration']['trapDestinations']}
    Set To Dictionary    ${Edit_snmp['snmpConfiguration']}    snmpUsers    ${Delete_user}

    ${Snmp_edit}    Fusion Api Edit Lig    ${Edit_snmp}    ${lig_uri}
    ${task} =   Wait For Task    ${Snmp_edit}    400s    2s

    Verify LI/LIG Consistent Status    ${Expected_Non_Consistency_Status}    ${LE}-${LIG_1}

    ${Alert_SNMP_Add_Trap}    Replace String Using Regexp   ${SNMP_V3_USERS_REMOVED}    XXX    ${Trap_To_be_removed_1}
    ${SNMP_lig_compliance_alert}    Built the Alert list    ${Alert_SNMP_Add_Trap}
    ${Alert_message}    Get Alert and Compliance Message    ${SNMP_lig_compliance_alert}

    Perform an LI Update From Group    ${LIURI}

    :For    ${x}    INRANGE    1    3
    \    Wait Until Keyword Succeeds    650s   35 s    Verify Interconnect State    ${Interconnect_${x}}    ${IC_Configured}

    Verify LI/LIG Consistent Status    ${Expected_Consistency_Status}    ${LE}-${LIG_1}


OVF223_TC_27 Add SNMP user and Trap Destination LIG_Compliance
    [Documentation]    Edit LIG-Check for the Compliance alert and event in LI
    ${Snmp_user_3}    Create List
    ${Trap_user_3}    Create List
    ${Get_lig}    Fusion Api Get Lig    param=?filter="'name'=='${LIGS_TB['name']}'"
    ${Get_lig_body}    Copy Dictionary    ${Get_lig['members']}
    Append to List    ${Snmp_user_3}    ${Get_lig_body[0]['snmpConfiguration']['snmpUsers'][0]}
    Append to List    ${Trap_user_3}    ${Get_lig_body[0]['snmpConfiguration']['trapDestinations'][0]}
    Append to List    ${Snmp_user_3}    ${Snmpuser_add_3[0]}
    Append to List    ${Trap_user_3}    ${TrapDestinations_3[0]}

    ${Edit_lig_body}    ${lig_uri}    Build Edit LIG Body    ${LIGS_TB}    ${Edit_Lig_Snmpv1_v2}
    Set To Dictionary    ${Edit_lig_body['snmpConfiguration']}    trapDestinations    ${Trap_user_3}
    Set To Dictionary    ${Edit_lig_body['snmpConfiguration']}    snmpUsers    ${Snmp_user_3}

    ${Snmp_edit}    Fusion Api Edit Lig    ${Edit_lig_body}    ${lig_uri}
    ${task} =   Wait For Task    ${Snmp_edit}    400s    2s

    Verify LI/LIG Consistent Status    ${Expected_Non_Consistency_Status}    ${LE}-${LIG_1}

    ${lig_uri} =     Get LIG URI   ${LIG_1}
    ${getresp} =    Fusion Api Get Lig   ${lig_uri}
    ${snmp_config} =     Get From Dictionary     ${getresp}  snmpConfiguration
    Log to console and logfile    ${snmp_config}
    ${snmp_users} =    Get From Dictionary     ${snmp_config}   snmpUsers
    ${snmp_traps} =    Get From Dictionary     ${snmp_config}   trapDestinations
    Log to console    \nUser name :${snmp_users}
    ${snmp_user_list}    Create List
    ${snmp_trap_dest}    Create List
    ${User_count}    Get Length    ${snmp_users}
    :For    ${x}    INRANGE    0    ${User_count}
    \    ${snmp_user_name} =    Get From Dictionary     ${snmp_users[${x}]}   snmpV3UserName
    \    ${snmp_trapdestination} =    Get From Dictionary     ${snmp_traps[${x}]}   trapDestination
    \     Append to List    ${snmp_user_list}    ${snmp_user_name}
    \     Append to List    ${snmp_trap_dest}    ${snmp_trapdestination}
    Set Global Variable    ${snmp_user_list}
    Set Global Variable    ${snmp_trap_dest}
    ${snmp_user_name3} =    Get From Dictionary     ${Snmpuser_add_3[0]}   snmpV3UserName
    Log to console    \nUser List from Variable :${snmp_user_name3}
    ${snmp_trap_ip} =    Get From Dictionary     ${TrapDestinations_3[0]}   trapDestination
    Log to console    \nUser Trap from LIG :${snmp_trap_ip}
    Log to console    \nUser List from Variable :${snmp_user_name3}
    Log to console    \nUser List from LIG :${snmp_user_list}
    Log to console    \nUser List from LIG :${snmp_trap_dest}
    List Should Contain Value    ${snmp_user_list}    ${snmp_user_name3}
    List Should Contain Value    ${snmp_trap_dest}    ${snmp_trap_ip}
    ${snmp_user3}    Convert To String    ${snmp_user_name3}
    ${snmp_trap3}    Convert To String    ${snmp_trap_ip}
    Log to console    \nActual Trap :${snmp_trap3}

    # Alert Verification with replace string
    ${Combined_List}    Create List
    ${Alert_SNMP_Add_User2}    Replace String Using Regexp   ${SNMP_V3_USERS_ADDED}    XXX    ${snmp_user3}
    Append to List    ${Combined_List}    ${Alert_SNMP_Add_User2}

    ${Alert_SNMP_Add_Trap}    Replace String Using Regexp   ${SNMP_TRAP_DESTINATIONS_ADDED}    XXX    ${snmp_trap3}
    Append to List    ${Combined_List}    ${Alert_SNMP_Add_Trap}
    #${Combined_List} =        catenate    ${Alert_SNMP_Add_User2},${Alert_SNMP_Add_Trap}
    Log to console    \nCombined List :${Combined_List}
    Sort List    ${Combined_List}
    ${Alert_message}    Get Alert and Compliance Message    ${Combined_List}
    ${LIURI} =     Get LI URI   ${LE}-${LIG_1}
    Perform an LI Update From Group    ${LIURI}

    :For    ${x}    INRANGE    1    3
    \    Wait Until Keyword Succeeds    650s   35 s    Verify Interconnect State    ${Interconnect_${x}}    ${IC_Configured}

    Verify LI/LIG Consistent Status    ${Expected_Consistency_Status}    ${LE}-${LIG_1}


OVF223_TC_28 Edit password LIG_Compliance
    [Documentation]    Edit LIG-Check for the Compliance alert and event in LI
    ${Get_lig}    Fusion Api Get Lig    param=?filter="'name'=='${LIGS_TB['name']}'"
    ${Get_lig_body}    Copy Dictionary    ${Get_lig['members'][0]['snmpConfiguration']}

    ${Edit_lig_body}    ${lig_uri}    Build Edit LIG Body    ${LIGS_TB}    ${Edit_Lig_Snmpv1_v2}
    Set To Dictionary    ${Edit_lig_body['snmpConfiguration']}    snmpUsers    ${Snmpuser_Edit_Auth_Credentials}
    Log to console    \nresponse :${Edit_lig_body}

    ${Snmp_edit}    Fusion Api Edit Lig    ${Edit_lig_body}    ${lig_uri}
    #Log to console    \nresponse :${Snmp_edit}
    ${task} =   Wait For Task    ${Snmp_edit}    400s    2s

    Verify LI/LIG Consistent Status    ${Expected_Non_Consistency_Status}    ${LE}-${LIG_1}

    ${lig_uri} =     Get LIG URI   ${LIG_1}
    ${getresp} =    Fusion Api Get Lig   ${lig_uri}
    ${snmp_config} =     Get From Dictionary     ${getresp}  snmpConfiguration
    Log to console and logfile    ${snmp_config}
    ${snmp_users} =    Get From Dictionary     ${snmp_config}   snmpUsers
    Log to console    \nUser name :${snmp_users}
    ${snmp_user_list}    Create List
    ${User_count}    Get Length    ${snmp_users}
    :For    ${x}    INRANGE    0    ${User_count}
    \    ${snmp_user_name} =    Get From Dictionary     ${snmp_users[${x}]}   snmpV3UserName
    \     Append to List    ${snmp_user_list}    ${snmp_user_name}
    Set Global Variable    ${snmp_user_list}
    ${snmp_user_name2} =    Get From Dictionary     ${Snmpuser_Edit_Auth_Credentials[1]}   snmpV3UserName
    Log to console    \nUser List from Variable :${snmp_user_name2}
    Log to console    \nUser List from LIG :${snmp_user_list}
    List Should Contain Value    ${snmp_user_list}    ${snmp_user_name2}
    ${snmp_user2}    Convert To String    ${snmp_user_name2}
    Log to console    \nActual user :${snmp_user2}

    ${Alert_SNMP_ReadCommunity}    Replace String Using Regexp   ${SNMP_V3_USERS_AUTH_PROTOCOL_CRED_CHANGED}    XXX    ${snmp_user2}

    ${SNMP_lig_compliance_alert}    Built the Alert list    ${Alert_SNMP_ReadCommunity}

    ${Alert_message}    Get Alert and Compliance Message    ${SNMP_lig_compliance_alert}
    ${LIURI} =     Get LI URI   ${LE}-${LIG_1}
    Perform an LI Update From Group    ${LIURI}

    :For    ${x}    INRANGE    1    3
    \    Wait Until Keyword Succeeds    650s   35 s    Verify Interconnect State    ${Interconnect_${x}}    ${IC_Configured}

    Verify LI/LIG Consistent Status    ${Expected_Consistency_Status}    ${LE}-${LIG_1}

OVF223_TC_13_14 Enable SNMPv1,v2 LI_Compliance
    [Documentation]    Edit LI-Check for the Compliance alert and event in LI
    ${Edit_lig_body}    ${lig_uri}    Build Edit LIG Body    ${LIGS_TB}    ${Edit_Lig_Snmpv1_v2}
    Set To Dictionary    ${Edit_lig_body}    snmpConfiguration    ${Snmp_V1_V2}

    ${Snmp_edit}    Fusion Api Edit Lig    ${Edit_lig_body}    ${lig_uri}
    ${task} =   Wait For Task    ${Snmp_edit}    400s    2s

    ${li_uri} =     Get LI URI   ${LE}-${LIG_1}
    Set Global Variable    ${LIURI}    ${li_uri}
    Perform an LI Update From Group    ${LIURI}

    ${li_uri} =     Get LI URI   ${LE}-${LIG_1}
    log to console    LI URI is ${li_uri}
    ${resp} =    Fusion Api Get Li    ${li_uri}
    log to console  Editing Li with snmp ${resp}
    ${respl} =    Fusion Api Update snmp configuration    body=${edit_Li_snmpv1_v2_Enabled['snmpConfiguration']}    uri=${li_uri}
    log to console  Editing Li with snmp ${respl}
    ${task} =   Wait For Task    ${respl}    400s    2s


    Verify LI/LIG Consistent Status    ${Expected_Non_Consistency_Status}    ${LE}-${LIG_1}

    ${SNMP_lig_compliance_alert}    Built the Alert list    ${SNMP_V1_V2_DISABLE}

    ${Alert_message}    Get Alert and Compliance Message    ${SNMP_lig_compliance_alert}

    ${lig_uri} =     Get LIG URI   ${LIG_1}
    ${getresp} =    Fusion Api Get Lig   ${lig_uri}


    ${Edit_lig_body}    ${lig_uri}    Build Edit LIG Body    ${LIGS_TB}    ${Edit_Lig_Snmpv1_v2}
    ${Edit_snmp}    Build SNMP body    ${Edit_lig_body}    ${Snmp_True}
    Set To Dictionary    ${Edit_snmp['snmpConfiguration']}    snmpUsers    ${Snmpuser_Edit_Auth_Credentials}
    Set To Dictionary    ${Edit_snmp['snmpConfiguration']}    trapDestinations    ${TrapDestinations}
    Log to console    \nresponse :${Edit_snmp}

    ${Snmp_edit}    Fusion Api Edit Lig    ${Edit_snmp}    ${lig_uri}
    ${task} =   Wait For Task    ${Snmp_edit}    400s    2s

    :For    ${x}    INRANGE    1    3
    \    Wait Until Keyword Succeeds    650s   35 s    Verify Interconnect State    ${Interconnect_${x}}    ${IC_Configured}

    Verify LI/LIG Consistent Status    ${Expected_Consistency_Status}    ${LE}-${LIG_1}

OVF223_TC_15 Disable SNMPv1,v2 LI_Compliance
    [Documentation]    Edit LI-Check for the Compliance alert and event in LI
    ${li_uri} =     Get LI URI   ${LE}-${LIG_1}
    Set Global Variable    ${LIURI}    ${li_uri}
    log to console    LI URI is ${li_uri}
    ${Edit_snmp}    Build SNMP LI body    ${SNMP_Config}    ${Snmp_False}

    log to console    LI URI is ${Edit_snmp}

    Set To Dictionary    ${Edit_snmp}    snmpUsers    ${Snmpuser_Edit_Auth_Credentials}
    Set To Dictionary    ${Edit_snmp}    trapDestinations    ${TrapDestinations}

    log to console    After Edit ${Edit_snmp}

    ${Edit_snmp_li}    Fusion Api Update snmp configuration    ${Edit_snmp}    ${LIURI}
    ${task} =   Wait For Task    ${Edit_snmp_li}    400s    2s

    Verify LI/LIG Consistent Status    ${Expected_Non_Consistency_Status}    ${LE}-${LIG_1}

    ${lig_uri} =     Get LIG URI   ${LIG_1}
    ${getresp} =    Fusion Api Get Lig   ${lig_uri}
    ${snmp_config} =     Get From Dictionary     ${getresp}  snmpConfiguration
    Log to console and logfile    ${snmp_config}
    ${Comm_string} =    Get From Dictionary     ${snmp_config}   readCommunity
    ${Comm_string1}    Convert To String    ${Comm_string}

    ${Alert_SNMP_ReadCommunity}    Replace String Using Regexp   ${SNMP_V1_V2_ENABLE_WITH_READ_COMMUNITY}    XXX    ${Comm_string1}
    ${SNMP_lig_compliance_alert}    Built the Alert list    ${Alert_SNMP_ReadCommunity}


    ${Alert_message}    Get Alert and Compliance Message    ${SNMP_lig_compliance_alert}


    ${Edit_lig_body}    ${lig_uri}    Build Edit LIG Body    ${LIGS_TB}    ${Edit_Lig_Snmpv1_v2}
    ${Edit_snmp}    Build SNMP body    ${Edit_lig_body}    ${Snmp_False}
    Set To Dictionary    ${Edit_snmp['snmpConfiguration']}    snmpUsers    ${Snmpuser_Edit_Auth_Credentials}
    Set To Dictionary    ${Edit_snmp['snmpConfiguration']}    trapDestinations    ${TrapDestinations}
    Log to console    \nresponse :${Edit_lig_body}

    ${Snmp_edit}    Fusion Api Edit Lig    ${Edit_lig_body}    ${lig_uri}
    ${task} =   Wait For Task    ${Snmp_edit}    400s    2s

    :For    ${x}    INRANGE    1    3
    \    Wait Until Keyword Succeeds    650s   35 s    Verify Interconnect State    ${Interconnect_${x}}    ${IC_Configured}

    Verify LI/LIG Consistent Status    ${Expected_Consistency_Status}    ${LE}-${LIG_1}

OVF223_TC_16 Disable SNMPv3 LI_Compliance
    [Documentation]    Edit LI-Check for the Compliance alert and event in LI
    ${li_uri} =     Get LI URI   ${LE}-${LIG_1}
    Set Global Variable    ${LIURI}    ${li_uri}
    log to console    LI URI is ${li_uri}
    ${Edit_snmp}    Build SNMP LI body    ${SNMP_Config}    ${Snmp_False}
    Set To Dictionary    ${Edit_snmp}    v3Enabled    ${Snmp_False}

    Set To Dictionary    ${Edit_snmp}    snmpUsers    ${Snmpuser_Edit_Auth_Credentials}
    Set To Dictionary    ${Edit_snmp}    trapDestinations    ${TrapDestinations}

    ${Edit_snmp_li}    Fusion Api Update snmp configuration    ${Edit_snmp}    ${LIURI}
    ${task} =   Wait For Task    ${Edit_snmp_li}    400s    2s

    Verify LI/LIG Consistent Status    ${Expected_Non_Consistency_Status}    ${LE}-${LIG_1}

    ${SNMP_lig_compliance_alert}    Built the Alert list    ${SNMP_V3_ENABLE}
    ${Alert_message}    Get Alert and Compliance Message    ${SNMP_lig_compliance_alert}

    ${Edit_lig_body}    ${lig_uri}    Build Edit LIG Body    ${LIGS_TB}    ${Edit_Lig_Snmpv1_v2}
    ${Edit_snmp}    Build SNMP body    ${Edit_lig_body}    ${Snmp_False}
    Set To Dictionary    ${Edit_snmp['snmpConfiguration']}    v3Enabled    ${Snmp_False}

    ${Snmp_edit}    Fusion Api Edit Lig    ${Edit_snmp}    ${lig_uri}
    ${task} =   Wait For Task    ${Snmp_edit}    400s    2s

    :For    ${x}    INRANGE    1    3
    \    Wait Until Keyword Succeeds    650s   35 s    Verify Interconnect State    ${Interconnect_${x}}    ${IC_Configured}

    Verify LI/LIG Consistent Status    ${Expected_Consistency_Status}    ${LE}-${LIG_1}

OVF223_TC_17 Enable SNMPv3 LI_Compliance
    [Documentation]    Edit LI-Check for the Compliance alert and event in LI
    ${li_uri} =     Get LI URI   ${LE}-${LIG_1}
    Set Global Variable    ${LIURI}    ${li_uri}
    log to console    LI URI is ${li_uri}
    ${Edit_snmp}    Build SNMP LI body    ${SNMP_Config}    ${Snmp_True}
    Set To Dictionary    ${Edit_snmp}    v3Enabled    ${Snmp_True}
    Set To Dictionary    ${Edit_snmp}    enabled    ${Snmp_False}
    Set To Dictionary    ${Edit_snmp}    snmpUsers    ${Snmpuser_Edit_Auth_Credentials}
    Set To Dictionary    ${Edit_snmp}    trapDestinations    ${TrapDestinations}

    ${Edit_snmp_li}    Fusion Api Update snmp configuration    ${Edit_snmp}    ${LIURI}
    ${task} =   Wait For Task    ${Edit_snmp_li}    400s    2s

    Verify LI/LIG Consistent Status    ${Expected_Non_Consistency_Status}    ${LE}-${LIG_1}
    ${SNMP_lig_compliance_alert}    Built the Alert list    ${SNMP_V3_DISABLE}

    ${Alert_message}    Get Alert and Compliance Message    ${SNMP_lig_compliance_alert}

    ${Edit_lig_body}    ${lig_uri}    Build Edit LIG Body    ${LIGS_TB}    ${Edit_Lig_Snmpv1_v2}
    log to console    LI URI is ${Edit_lig_body}
    Set To Dictionary    ${Edit_lig_body['snmpConfiguration']}    snmpUsers    ${Snmpuser_Edit_Auth_Credentials}
    Set To Dictionary    ${Edit_lig_body['snmpConfiguration']}    trapDestinations    ${TrapDestinations}
    Set To Dictionary    ${Edit_lig_body['snmpConfiguration']}    v3Enabled    ${Snmp_True}
    log to console    After LIG:${Edit_lig_body}

    ${Snmp_edit}    Fusion Api Edit Lig    ${Edit_lig_body}    ${lig_uri}
    ${task} =   Wait For Task    ${Snmp_edit}    400s    2s

    :For    ${x}    INRANGE    1    3
    \    Wait Until Keyword Succeeds    650s   35 s    Verify Interconnect State    ${Interconnect_${x}}    ${IC_Configured}

    Verify LI/LIG Consistent Status    ${Expected_Consistency_Status}    ${LE}-${LIG_1}

OVF223_TC_22 Delete Trap Destination LI_Compliance
    [Documentation]    Edit LI-Check for the Compliance alert and event in LI
    ${Delete_Trap}    Create List
    ${Get_li}    Fusion Api Get Li
    ${Get_li_body}    Copy Dictionary    ${Get_li['members']}
    ${Trap_Destination}    Get From Dictionary    ${Get_li_body[0]['snmpConfiguration']['trapDestinations'][1]}    trapDestination
    ${Trap_User_name}    Get From Dictionary    ${Get_li_body[0]['snmpConfiguration']['trapDestinations'][1]}    userName
    Set Global Variable    ${Trap_User}    ${Trap_User_name}
    Log to console and logfile    ${Trap_Destination}

    ${Trap_delete_alert}    Replace String Using Regexp   ${SNMP_TRAP_DESTINATIONS_ADDED}   XXX    ${Trap_Destination}
    Append to List    ${Delete_Trap}    ${Get_li_body[0]['snmpConfiguration']['trapDestinations'][0]}
    Log to console and logfile    \nTrap is:${Delete_Trap}

    ${li_uri} =     Get LI URI   ${LE}-${LIG_1}
    Set Global Variable    ${LIURI}    ${li_uri}
    log to console    LI URI is ${LIURI}

    ${Edit_snmp}    Build SNMP LI body    ${SNMP_Config}    ${Snmp_False}
    Set To Dictionary    ${Edit_snmp}    snmpUsers    ${Get_li_body[0]['snmpConfiguration']['snmpUsers']}
    Set To Dictionary    ${Edit_snmp}    trapDestinations    ${Delete_Trap}
    ${Edit_snmp_li}    Fusion Api Update snmp configuration    ${Edit_snmp}    ${LIURI}
    ${task} =   Wait For Task    ${Edit_snmp_li}    1100s    2s

    Verify LI/LIG Consistent Status    ${Expected_Non_Consistency_Status}    ${LE}-${LIG_1}

    ${SNMP_lig_compliance_alert}    Built the Alert list    ${Trap_delete_alert}

    ${Alert_message}    Get Alert and Compliance Message    ${SNMP_lig_compliance_alert}

    ${Delete_Trap}    Create List
    ${Get_lig}    Fusion Api Get Lig    param=?filter="'name'=='${LIGS_TB['name']}'"
    ${Get_lig_body}    Copy Dictionary    ${Get_lig['members']}
    Append to List    ${Delete_Trap}    ${Get_lig_body[0]['snmpConfiguration']['trapDestinations'][0]}
    Log to console and logfile    ${Delete_Trap}

    ${Edit_lig_body}    ${lig_uri}    Build Edit LIG Body    ${LIGS_TB}    ${Edit_Lig_Snmpv1_v2}
    #${Edit_snmp}    Build SNMP body    ${Edit_lig_body}    ${Snmp_False}
    Set To Dictionary    ${Edit_lig_body['snmpConfiguration']}    snmpUsers    ${Get_lig_body[0]['snmpConfiguration']['snmpUsers']}
    Set To Dictionary    ${Edit_lig_body['snmpConfiguration']}    trapDestinations    ${Delete_Trap}

    ${Snmp_edit}    Fusion Api Edit Lig    ${Edit_lig_body}    ${lig_uri}
    ${task} =   Wait For Task    ${Snmp_edit}    400s    2s

    Verify LI/LIG Consistent Status    ${Expected_Consistency_Status}    ${LE}-${LIG_1}

OVF223_TC_18 Add SNMPv3 user LI_Compliance
    [Documentation]    Edit LI-Check for the Compliance alert and event in LI
    ${Edit_snmp}    Build SNMP LI body    ${SNMP_Config}    ${Snmp_False}
    Set To Dictionary    ${Edit_snmp}    snmpUsers    ${Snmpuser_add_1}
    ${Edit_snmp_li}    Fusion Api Update snmp configuration    ${Edit_snmp}    ${LIURI}
    ${task} =   Wait For Task    ${Edit_snmp_li}    1100s    2s

    Verify LI/LIG Consistent Status    ${Expected_Non_Consistency_Status}    ${LE}-${LIG_1}

    ${SNMP_lig_compliance_alert}    Built the Alert list    ${SNMPv3_Compliance_Add_user_li}

    ${Alert_message}    Get Alert and Compliance Message    ${SNMP_lig_compliance_alert}

    ${Edit_lig_body}    ${lig_uri}    Build Edit LIG Body    ${LIGS_TB}    ${Edit_Lig_Snmpv1_v2}
    ${Edit_snmp}    Build SNMP body    ${Edit_lig_body}    ${Snmp_False}
    Set To Dictionary    ${Edit_snmp['snmpConfiguration']}    snmpUsers    ${Snmpuser_add_1}

    ${Snmp_edit}    Fusion Api Edit Lig    ${Edit_snmp}    ${lig_uri}
    ${task} =   Wait For Task    ${Snmp_edit}    1100s    2s

    :For    ${x}    INRANGE    1    3
    \    Wait Until Keyword Succeeds    1100s   35 s    Verify Interconnect State    ${Interconnect_${x}}    ${IC_Configured}

    Verify LI/LIG Consistent Status    ${Expected_Consistency_Status}    ${LE}-${LIG_1}

OVF223_TC_23 Delete SNMPv3 user LI_Compliance
    [Documentation]    Edit LI-Check for the Compliance alert and event in LI
    ${Delete_user}    Create List
    ${Get_li}    Fusion Api Get Li
    ${Get_li_body}    Copy Dictionary    ${Get_li['members']}
    ${Trap_User_name}    Get From Dictionary    ${Get_li_body[0]['snmpConfiguration']['trapDestinations'][0]}    userName
    ${User_count}    Get Length    ${Get_li_body[0]['snmpConfiguration']['snmpUsers']}
    ${User_List}    Create List
    Log to console and logfile    \n\nUsers Count:${User_count}
    :For    ${x}    INRANGE    0    ${User_count}
    \    ${User_name}    Get From Dictionary    ${Get_li_body[0]['snmpConfiguration']['snmpUsers'][${x}]}    snmpV3UserName
    \    Log to console and logfile    \n\nUsers Available in LI:${User_name}
    \    Append to List    ${User_List}    ${User_name}
    \    Run Keyword If    '${Trap_User_name}' != '${User_name}'    Continue For Loop
    \    Append to List    ${Delete_user}    ${Get_li_body[0]['snmpConfiguration']['snmpUsers'][${x}]}
    Log to console and logfile    \n\nUsers Available in LI:${Delete_user}
    Log to console and logfile    \n\nRemovable User is:${User_List}

    ${User_delete_alert}    Replace String Using Regexp   ${SNMP_V3_USERS_REMOVED}    XXX   ${User_List[1]}
    Log to console and logfile    ${User_delete_alert} will be removed.

    ${Edit_snmp}    Build SNMP LI body    ${SNMP_Config}    ${Snmp_False}
    Set To Dictionary    ${Edit_snmp}    trapDestinations    ${TrapDestinations_2}
    Set To Dictionary    ${Edit_snmp}    snmpUsers    ${Snmpuser_add_2}
    Log to console and logfile    \n\nSNMP Body:${Edit_snmp}

    ${li_uri} =     Get LI URI   ${LE}-${LIG_1}
    Set Global Variable    ${LIURI}    ${li_uri}
    log to console    LI URI is ${LIURI}

    ${Edit_snmp_li}    Fusion Api Update snmp configuration    ${Edit_snmp}    ${LIURI}
    ${task} =   Wait For Task    ${Edit_snmp_li}    1100s    2s

    Verify LI/LIG Consistent Status    ${Expected_Non_Consistency_Status}    ${LE}-${LIG_1}

    ${SNMP_lig_compliance_alert}    Built the Alert list    ${User_delete_alert}

    ${Alert_message}    Get Alert and Compliance Message    ${SNMP_lig_compliance_alert}

    ${Edit_lig_body}    ${lig_uri}    Build Edit LIG Body    ${LIGS_TB}    ${Edit_Lig_Snmpv1_v2}
    #${Edit_snmp}    Build SNMP body    ${Edit_lig_body}    ${Snmp_False}
    Set To Dictionary    ${Edit_lig_body['snmpConfiguration']}    trapDestinations    ${TrapDestinations_1}
    Set To Dictionary    ${Edit_lig_body['snmpConfiguration']}    snmpUsers    ${Snmpuser_add_1}

    ${Snmp_edit}    Fusion Api Edit Lig    ${Edit_lig_body}    ${lig_uri}
    ${task} =   Wait For Task    ${Snmp_edit}    400s    2s

    Verify LI/LIG Consistent Status    ${Expected_Consistency_Status}    ${LE}-${LIG_1}

OVF223_TC_19 Add Trap Destination LI_Compliance
    [Documentation]    Edit LI-Check for the Compliance alert and event in LI
    ${Get_li}    Fusion Api Get Li
    ${Get_li_body}    Copy Dictionary    ${Get_li['members']}
    ${Edit_snmp}    Build SNMP LI body    ${SNMP_Config}    ${Snmp_False}
    Set To Dictionary    ${Edit_snmp}    trapDestinations    ${TrapDestinations_1}
    Set To Dictionary    ${Edit_snmp    snmpUsers    ${Get_li_body[0]['snmpConfiguration']['snmpUsers']}
    ${Edit_snmp_li}    Fusion Api Update snmp configuration    ${Edit_snmp}    ${LIURI}
    ${task} =   Wait For Task    ${Edit_snmp_li}    1100s    2s

    Verify LI/LIG Consistent Status    ${Expected_Non_Consistency_Status}    ${LE}-${LIG_1}

    ${SNMP_lig_compliance_alert}    Built the Alert list    ${SNMPv3_Compliance_Add_Trap_li}

    ${Alert_message}    Get Alert and Compliance Message    ${SNMP_lig_compliance_alert}

    ${Get_lig}    Fusion Api Get Lig    param=?filter="'name'=='${LIGS_TB['name']}'"
    ${Get_lig_body}    Copy Dictionary    ${Get_lig['members']}
    ${Edit_lig_body}    ${lig_uri}    Build Edit LIG Body    ${LIGS_TB}    ${Edit_Lig_Snmpv1_v2}
    ${Edit_snmp}    Build SNMP body    ${Edit_lig_body}    ${Snmp_False}
    Set To Dictionary    ${Edit_snmp['snmpConfiguration']}    trapDestinations    ${TrapDestinations_1}
    Set To Dictionary    ${Edit_snmp['snmpConfiguration']}    snmpUsers    ${Get_lig_body[0]['snmpConfiguration']['snmpUsers']}

    ${Snmp_edit}    Fusion Api Edit Lig    ${Edit_snmp}    ${lig_uri}
    ${task} =   Wait For Task    ${Snmp_edit}    1100s    2s

    :For    ${x}    INRANGE    1    3
    \    Wait Until Keyword Succeeds    650s   35 s    Verify Interconnect State    ${Interconnect_${x}}    ${IC_Configured}

    Verify LI/LIG Consistent Status    ${Expected_Consistency_Status}    ${LE}-${LIG_1}

OVF223_TC_20 Add SNMPv3 user_2 LI_Compliance
    [Documentation]    Edit LI-Check for the Compliance alert and event in LI
    ${Snmp_user_2}    Create List
    ${Get_li}    Fusion Api Get Li
    ${Get_li_body}    Copy Dictionary    ${Get_li['members']}
    Append to List    ${Snmp_user_2}    ${Get_li_body[0]['snmpConfiguration']['snmpUsers'][0]}
    Append to List    ${Snmp_user_2}    ${Snmpuser_add_2[0]}
    Log to console and logfile    ${Snmp_user_2}

    ${Edit_snmp}    Build SNMP LI body    ${SNMP_Config}    ${Snmp_False}
    Set To Dictionary    ${Edit_snmp}    trapDestinations    ${Get_li_body[0]['snmpConfiguration']['trapDestinations']}
    Set To Dictionary    ${Edit_snmp}    snmpUsers    ${Snmp_user_2}
    ${Edit_snmp_li}    Fusion Api Update snmp configuration    ${Edit_snmp}    ${LIURI}
    ${task} =   Wait For Task    ${Edit_snmp_li}    1100s    2s

    Verify LI/LIG Consistent Status    ${Expected_Non_Consistency_Status}    ${LE}-${LIG_1}

    ${SNMP_lig_compliance_alert}    Built the Alert list    ${SNMPv3_Compliance_Add_user_2_li}

    ${Alert_message}    Get Alert and Compliance Message    ${SNMP_lig_compliance_alert}

    ${Edit_lig_body}    ${lig_uri}    Build Edit LIG Body    ${LIGS_TB}    ${Edit_Lig_Snmpv1_v2}

    ${Edit_snmp}    Build SNMP body    ${Edit_lig_body}    ${Snmp_False}
    Set To Dictionary    ${Edit_snmp['snmpConfiguration']}    trapDestinations    ${Get_li_body[0]['snmpConfiguration']['trapDestinations']}
    Set To Dictionary    ${Edit_snmp['snmpConfiguration']}    snmpUsers    ${Snmp_user_2}

    ${Snmp_edit}    Fusion Api Edit Lig    ${Edit_snmp}    ${lig_uri}
    ${task} =   Wait For Task    ${Snmp_edit}    1100s    2s

    :For    ${x}    INRANGE    1    3
    \    Wait Until Keyword Succeeds    650s   35 s    Verify Interconnect State    ${Interconnect_${x}}    ${IC_Configured}

    Verify LI/LIG Consistent Status    ${Expected_Consistency_Status}    ${LE}-${LIG_1}

OVF223_TC_21 Add Trap Destination LI_Compliance
    [Documentation]    Edit LI-Check for the Compliance alert and event in LI
    ${Trap_user_2}    Create List
    ${Get_li}    Fusion Api Get Li
    ${Get_li_body}    Copy Dictionary    ${Get_li['members']}
    Append to List    ${Trap_user_2}    ${Get_lig_body[0]['snmpConfiguration']['trapDestinations'][0]}
    Append to List    ${Trap_user_2}    ${TrapDestinations_2[0]}
    Log to console and logfile    ${Trap_user_2}

    ${Edit_snmp}    Build SNMP LI body    ${SNMP_Config}    ${Snmp_False}
    Set To Dictionary    ${Edit_snmp}    snmpUsers    ${Get_li_body[0]['snmpConfiguration']['snmpUsers']}
    Set To Dictionary    ${Edit_snmp}    trapDestinations    ${Trap_user_2}
    ${Edit_snmp_li}    Fusion Api Update snmp configuration    ${Edit_snmp}    ${LIURI}
    ${task} =   Wait For Task    ${Edit_snmp_li}    1100s    2s

    Verify LI/LIG Consistent Status    ${Expected_Non_Consistency_Status}    ${LE}-${LIG_1}

    ${SNMP_lig_compliance_alert}    Built the Alert list    ${SNMPv3_Compliance_Add_Trap_2_li}

    ${Alert_message}    Get Alert and Compliance Message    ${SNMP_lig_compliance_alert}

    ${Edit_lig_body}    ${lig_uri}    Build Edit LIG Body    ${LIGS_TB}    ${Edit_Lig_Snmpv1_v2}
    ${Edit_snmp}    Build SNMP body    ${Edit_lig_body}    ${Snmp_False}
    Set To Dictionary    ${Edit_snmp['snmpConfiguration']}    snmpUsers    ${Get_li_body[0]['snmpConfiguration']['snmpUsers']}
    Set To Dictionary    ${Edit_snmp['snmpConfiguration']}    trapDestinations    ${Trap_user_2}

    ${Snmp_edit}    Fusion Api Edit Lig    ${Edit_snmp}    ${lig_uri}
    ${task} =   Wait For Task    ${Snmp_edit}    1100s    2s

    :For    ${x}    INRANGE    1    3
    \    Wait Until Keyword Succeeds    650s   35 s    Verify Interconnect State    ${Interconnect_${x}}    ${IC_Configured}

    Verify LI/LIG Consistent Status    ${Expected_Consistency_Status}    ${LE}-${LIG_1}

OVF223_TC_22 Delete Trap Destination LI_Compliance
    [Documentation]    Edit LI-Check for the Compliance alert and event in LI
    ${Delete_Trap}    Create List
    ${Get_li}    Fusion Api Get Li
    ${Get_li_body}    Copy Dictionary    ${Get_li['members']}
    ${Trap_Destination}    Get From Dictionary    ${Get_li_body[0]['snmpConfiguration']['trapDestinations'][1]}    trapDestination
    ${Trap_User_name}    Get From Dictionary    ${Get_li_body[0]['snmpConfiguration']['trapDestinations'][1]}    userName
    Set Global Variable    ${Trap_User}    ${Trap_User_name}
    Log to console and logfile    ${Trap_Destination}
    ${Trap_delete_alert}    Replace String Using Regexp   ${SNMPv3_Compliance_Delete_Trap_li}    trap-ip    ${Trap_Destination}
    Append to List    ${Delete_Trap}    ${Get_li_body[0]['snmpConfiguration']['trapDestinations'][0]}
    Log to console and logfile    ${Delete_Trap}

    ${Edit_snmp}    Build SNMP LI body    ${SNMP_Config}    ${Snmp_False}
    Set To Dictionary    ${Edit_snmp}    snmpUsers    ${Get_li_body[0]['snmpConfiguration']['snmpUsers']}
    Set To Dictionary    ${Edit_snmp}    trapDestinations    ${Delete_Trap}
    ${Edit_snmp_li}    Fusion Api Update snmp configuration    ${Edit_snmp}    ${LIURI}
    ${task} =   Wait For Task    ${Edit_snmp_li}    1100s    2s

    Verify LI/LIG Consistent Status    ${Expected_Non_Consistency_Status}    ${LE}-${LIG_1}

    ${SNMP_lig_compliance_alert}    Built the Alert list    ${SNMPv3_Compliance_Delete_Trap_li}

    ${Alert_message}    Get Alert and Compliance Message    ${SNMP_lig_compliance_alert}

    ${Edit_lig_body}    ${lig_uri}    Build Edit LIG Body    ${LIGS_TB}    ${Edit_Lig_Snmpv1_v2}
    ${Edit_snmp}    Build SNMP body    ${Edit_lig_body}    ${Snmp_False}
    Set To Dictionary    ${Edit_snmp['snmpConfiguration']}    snmpUsers    ${Get_li_body[0]['snmpConfiguration']['snmpUsers']}
    Set To Dictionary    ${Edit_snmp['snmpConfiguration']}    trapDestinations    ${Delete_Trap}

    ${Snmp_edit}    Fusion Api Edit Lig    ${Edit_snmp}    ${lig_uri}
    ${task} =   Wait For Task    ${Snmp_edit}    1100s    2s

    Verify LI/LIG Consistent Status    ${Expected_Consistency_Status}    ${LE}-${LIG_1}

OVF223_TC_23 Delete SNMPv3 user LI_Compliance
   [Documentation]    Edit LI-Check for the Compliance alert and event in LI
    ${Delete_user}    Create List
    ${Get_li}    Fusion Api Get Li
    ${Get_li_body}    Copy Dictionary    ${Get_li['members']}
    ${Trap_User_name}    Get From Dictionary    ${Get_li_body[0]['snmpConfiguration']['trapDestinations'][0]}    userName
    ${User_count}    Get Length    ${Get_li_body[0]['snmpConfiguration']['snmpUsers']}
    :For    ${x}    INRANGE    0    ${User_count}
    \    ${User_name}    Get From Dictionary    ${Get_li_body[0]['snmpConfiguration']['snmpUsers'][${x}]}    snmpV3UserName
    \    Run Keyword If    '${Trap_User_name}' != '${User_name}'    Continue For Loop
    \    Append to List    ${Delete_user}    ${Get_li_body[0]['snmpConfiguration']['snmpUsers'][${x}]}
    Log to console and logfile    ${Delete_user}
    Log to console and logfile    ${Trap_User} will be removed.
    ${User_delete_alert}    Replace String Using Regexp   ${SNMPv3_Compliance_Delete_user_li}    User-name    ${Trap_User}

    ${Edit_snmp}    Build SNMP LI body    ${SNMP_Config}    ${Snmp_False}
    Set To Dictionary    ${Edit_snmp}    trapDestinations    ${Get_li_body[0]['snmpConfiguration']['trapDestinations']}
    Set To Dictionary    ${Edit_snmp}    snmpUsers    ${Delete_user}
    ${Edit_snmp_li}    Fusion Api Update snmp configuration    ${Edit_snmp}    ${LIURI}
    ${task} =   Wait For Task    ${Edit_snmp_li}    1100s    2s

    Verify LI/LIG Consistent Status    ${Expected_Non_Consistency_Status}    ${LE}-${LIG_1}

    ${SNMP_lig_compliance_alert}    Built the Alert list    ${SNMPv3_Compliance_Delete_user_li}

    ${Alert_message}    Get Alert and Compliance Message    ${SNMP_lig_compliance_alert}

    ${Edit_lig_body}    ${lig_uri}    Build Edit LIG Body    ${LIGS_TB}    ${Edit_Lig_Snmpv1_v2}
    ${Edit_snmp}    Build SNMP body    ${Edit_lig_body}    ${Snmp_False}
    Set To Dictionary    ${Edit_snmp['snmpConfiguration']}    trapDestinations    ${Get_li_body[0]['snmpConfiguration']['trapDestinations']}
    Set To Dictionary    ${Edit_snmp['snmpConfiguration']}    snmpUsers    ${Delete_user}

    ${Snmp_edit}    Fusion Api Edit Lig    ${Edit_snmp}    ${lig_uri}
    ${task} =   Wait For Task    ${Snmp_edit}    400s    2s

    Verify LI/LIG Consistent Status    ${Expected_Consistency_Status}    ${LE}-${LIG_1}

OVF223_TC_32 Edit the System Contact LI_Compliance
    [Documentation]    Edit LI-Check for the Compliance alert and event in LI
    ${Edit_snmp}    Build SNMP LI body    ${SNMP_Config}    ${Snmp_False}
    Set To Dictionary    ${Edit_snmp}    systemContact    ${System_Contact}
    ${Edit_snmp_li}    Fusion Api Update snmp configuration    ${Edit_snmp}    ${LIURI}
    ${task} =   Wait For Task    ${Edit_snmp_li}    1100s    2s

    Verify LI/LIG Consistent Status    ${Expected_Non_Consistency_Status}    ${LE}-${LIG_1}

    ${SNMP_lig_compliance_alert}    Built the Alert list    ${SNMPv3_add_system_contact_li}

    ${Alert_message}    Get Alert and Compliance Message    ${SNMP_lig_compliance_alert}

    ${Edit_lig_body}    ${lig_uri}    Build Edit LIG Body    ${LIGS_TB}    ${Edit_Lig_Snmpv1_v2}
    ${Edit_snmp}    Build SNMP body    ${Edit_lig_body}
    Set To Dictionary    ${Edit_snmp['snmpConfiguration']}    systemContact    ${System_Contact}

    ${Snmp_edit}    Fusion Api Edit Lig    ${Edit_snmp}    ${lig_uri}
    ${task} =   Wait For Task    ${Snmp_edit}    400s    2s

    Verify LI/LIG Consistent Status    ${Expected_Consistency_Status}    ${LE}-${LIG_1}

OVF223_TC_34 Add SNMPv3 User and Trap LI_Compliance
    [Documentation]    Edit LI-Check for the Compliance alert and event in LI
    ${Edit_snmp}    Build SNMP LI body    ${SNMP_Config}    ${Snmp_False}
    Set To Dictionary    ${Edit_snmp}    snmpUsers    ${Snmpuser_add_3}
    Set To Dictionary    ${Edit_snmp['snmpConfiguration']}    trapDestinations    ${TrapDestinations_3}
    ${Edit_snmp_li}    Fusion Api Update snmp configuration    ${Edit_snmp}    ${LIURI}
    ${task} =   Wait For Task    ${Edit_snmp_li}    1100s    2s

    Verify LI/LIG Consistent Status    ${Expected_Non_Consistency_Status}    ${LE}-${LIG_1}

    ${SNMP_lig_compliance_alert}    Built the Alert list    ${SNMPv3_add_user_trap_li}

    ${Alert_message}    Get Alert and Compliance Message    ${SNMP_lig_compliance_alert}

    ${Edit_lig_body}    ${lig_uri}    Build Edit LIG Body    ${LIGS_TB}    ${Edit_Lig_Snmpv1_v2}
    ${Edit_snmp}    Build SNMP body    ${Edit_lig_body}
    Set To Dictionary    ${Edit_snmp}    snmpUsers    ${Snmpuser_add_3}
    Set To Dictionary    ${Edit_snmp['snmpConfiguration']}    trapDestinations    ${TrapDestinations_3}

    ${Snmp_edit}    Fusion Api Edit Lig    ${Edit_snmp}    ${lig_uri}
    ${task} =   Wait For Task    ${Snmp_edit}    400s    2s

    Verify LI/LIG Consistent Status    ${Expected_Consistency_Status}    ${LE}-${LIG_1}

OVF223_TC_35 Edit SNMPv3 user password
    [Documentation]    Edit LI-Check for the Compliance alert and event in LI
    ${Get_li}    Fusion Api Get Li
    ${Get_li_body}    Copy Dictionary    ${Get_li['members'][0]['snmpConfiguration']}
    Set To Dictionary    ${Get_li_body['snmpUsers'][0]}    value    password1234

    ${Edit_snmp}    Build SNMP LI body    ${SNMP_Config}    ${Snmp_False}
    Set To Dictionary    ${Edit_snmp}    snmpConfiguration    ${Get_li_body}
    ${Edit_snmp_li}    Fusion Api Update snmp configuration    ${Edit_snmp}    ${LIURI}
    ${task} =   Wait For Task    ${Edit_snmp_li}    1100s    2s

    Verify LI/LIG Consistent Status    ${Expected_Non_Consistency_Status}    ${LE}-${LIG_1}

    ${SNMP_lig_compliance_alert}    Built the Alert list    ${SNMPv3_edit_password}

    ${Alert_message}    Get Alert and Compliance Message    ${SNMP_lig_compliance_alert}

    ${Edit_lig_body}    ${lig_uri}    Build Edit LIG Body    ${LIGS_TB}    ${Edit_Lig_Snmpv1_v2}
    ${Edit_snmp}    Build SNMP body    ${Edit_lig_body}
    Set To Dictionary    ${Edit_snmp}    snmpConfiguration    ${Get_li_body}

    ${Snmp_edit}    Fusion Api Edit Lig    ${Edit_snmp}    ${lig_uri}
    ${task} =   Wait For Task    ${Snmp_edit}    400s    2s

    Verify LI/LIG Consistent Status    ${Expected_Consistency_Status}    ${LE}-${LIG_1}

OVF223_TC_29 Add SNMP Access LIG_Compliance

    [Documentation]    Edit LI-Check for the Compliance alert and event in LI

    ${Edit_lig_body}    ${lig_uri}    Build Edit LIG Body    ${LIGS_TB}    ${Edit_Lig_Snmpv1_v2}
    ${Edit_snmp}    Build SNMP body    ${Edit_lig_body}    ${Snmp_False}
    Set To Dictionary    ${Edit_snmp['snmpConfiguration']}    snmpAccess    ${SNMP_Access_add}
    Log to console and logfile    ${Edit_snmp}

    ${Snmp_edit}    Fusion Api Edit Lig    ${Edit_snmp}    ${lig_uri}
    ${task} =   Wait For Task    ${Snmp_edit}    400s    2s

    Verify LI/LIG Consistent Status    ${Expected_Non_Consistency_Status}    ${LE}-${LIG_1}}

    ${SNMP_compliance_alert}    Built the Alert list    ${SNMPv3_Access_add}

    ${Alert_message}    Get Alert and Compliance Message    ${SNMP_compliance_alert}

    Perform an LI Update From Group    ${LIURI}

    Verify LI/LIG Consistent Status    ${Expected_Consistency_Status}    ${LE}-${LIG_1}

OVF223_TC_30 Edit SNMP Access LIG_Compliance
    [Documentation]    Edit LI-Check for the Compliance alert and event in LI
    ${Edit_lig_body}    ${lig_uri}    Build Edit LIG Body    ${LIGS_TB}    ${Edit_Lig_Snmpv1_v2}
    ${Edit_snmp}    Build SNMP body    ${Edit_lig_body}    ${Snmp_False}
    Set To Dictionary    ${Edit_snmp['snmpConfiguration']}    snmpAccess    ${SNMP_Access_edit}
    Log to console and logfile    ${Edit_snmp}

    ${Snmp_edit}    Fusion Api Edit Lig    ${Edit_snmp}    ${lig_uri}
    ${task} =   Wait For Task    ${Snmp_edit}    400s    2s

    Verify LI/LIG Consistent Status    ${Expected_Non_Consistency_Status}    ${LE}-${LIG_1}}

    ${SNMP_compliance_alert}    Built the Alert list    ${SNMPv3_Access_edit}

    ${Alert_message}    Get Alert and Compliance Message    ${SNMP_compliance_alert}

    Perform an LI Update From Group    ${LIURI}

    Verify LI/LIG Consistent Status    ${Expected_Consistency_Status}    ${LE}-${LIG_1}

OVF223_TC_31 Delete SNMP Access LIG_Compliance
    [Documentation]    Edit LI-Check for the Compliance alert and event in LI
    ${Edit_lig_body}    ${lig_uri}    Build Edit LIG Body    ${LIGS_TB}    ${Edit_Lig_Snmpv1_v2}
    ${Edit_snmp}    Build SNMP body    ${Edit_lig_body}    ${Snmp_False}
    Log to console and logfile    ${Edit_snmp}

    ${Snmp_edit}    Fusion Api Edit Lig    ${Edit_snmp}    ${lig_uri}
    ${task} =   Wait For Task    ${Snmp_edit}    400s    2s

    Verify LI/LIG Consistent Status    ${Expected_Non_Consistency_Status}    ${LE}-${LIG_1}

    ${SNMP_compliance_alert}    Built the Alert list    ${SNMPv3_Access_delete}

    ${Alert_message}    Get Alert and Compliance Message    ${SNMP_compliance_alert}

    Perform an LI Update From Group    ${LIURI}

    Verify LI/LIG Consistent Status    ${Expected_Consistency_Status}    ${LE}-${LIG_1}

OVF223_TC_36 Add SNMP Access LI_Compliance
    [Documentation]    Edit LI-Check for the Compliance alert and event in LI
    ${Edit_snmp}    Build SNMP LI body    ${SNMP_Config}    ${Snmp_False}
    Set To Dictionary    ${Edit_snmp['snmpConfiguration']}    snmpAccess    ${SNMP_Access_add}

    ${Edit_snmp_li}    Fusion Api Update snmp configuration    ${Edit_snmp}    ${LIURI}
    ${task} =   Wait For Task    ${Edit_snmp_li}    1100s    2s

    Verify LI/LIG Consistent Status    ${Expected_Non_Consistency_Status}    ${LE}-${LIG_1}

    ${SNMP_compliance_alert}    Built the Alert list    ${SNMPv3_Access_add_li}

    ${Alert_message}    Get Alert and Compliance Message    ${SNMP_compliance_alert}

    ${Edit_lig_body}    ${lig_uri}    Build Edit LIG Body    ${LIGS_TB}    ${Edit_Lig_Snmpv1_v2}
    ${Edit_snmp}    Build SNMP body    ${Edit_lig_body}    ${Snmp_False}
    Set To Dictionary    ${Edit_snmp['snmpConfiguration']}    snmpAccess    ${SNMP_Access_add}
    Log to console and logfile    ${Edit_snmp}

    ${Snmp_edit}    Fusion Api Edit Lig    ${Edit_snmp}    ${lig_uri}
    ${task} =   Wait For Task    ${Snmp_edit}    400s    2s

    Verify LI/LIG Consistent Status    ${Expected_Consistency_Status}    ${LE}-${LIG_1}

OVF223_TC_37 Add SNMP Access LI_Compliance
    [Documentation]    Edit LI-Check for the Compliance alert and event in LI
    ${Edit_snmp}    Build SNMP LI body    ${SNMP_Config}    ${Snmp_False}
    Set To Dictionary    ${Edit_snmp['snmpConfiguration']}    snmpAccess    ${SNMP_Access_edit}

    ${Edit_snmp_li}    Fusion Api Update snmp configuration    ${Edit_snmp}    ${LIURI}
    ${task} =   Wait For Task    ${Edit_snmp_li}    1100s    2s

    Verify LI/LIG Consistent Status    ${Expected_Non_Consistency_Status}    ${LE}-${LIG_1}

    ${SNMP_compliance_alert}    Built the Alert list    ${SNMPv3_Access_edit_li}

    ${Alert_message}    Get Alert and Compliance Message    ${SNMP_compliance_alert}

    ${Edit_lig_body}    ${lig_uri}    Build Edit LIG Body    ${LIGS_TB}    ${Edit_Lig_Snmpv1_v2}
    ${Edit_snmp}    Build SNMP body    ${Edit_lig_body}    ${Snmp_False}
    Set To Dictionary    ${Edit_snmp['snmpConfiguration']}    snmpAccess    ${SNMP_Access_edit}
    Log to console and logfile    ${Edit_snmp}

    ${Snmp_edit}    Fusion Api Edit Lig    ${Edit_snmp}    ${lig_uri}
    ${task} =   Wait For Task    ${Snmp_edit}    400s    2s

    Verify LI/LIG Consistent Status    ${Expected_Consistency_Status}    ${LE}-${LIG_1}

OVF223_TC_38 Delete SNMP Access LI_Compliance
    [Documentation]    Edit LI-Check for the Compliance alert and event in LI
    ${Edit_snmp}    Build SNMP LI body    ${SNMP_Config}    ${Snmp_False}
    ${Edit_snmp_li}    Fusion Api Update snmp configuration    ${Edit_snmp}    ${LIURI}
    ${task} =   Wait For Task    ${Edit_snmp_li}    1100s    2s

    Verify LI/LIG Consistent Status    ${Expected_Non_Consistency_Status}    ${LE}-${LIG_1}

    ${SNMP_compliance_alert}    Built the Alert list    ${SNMPv3_Access_delete_li}

    ${Alert_message}    Get Alert and Compliance Message    ${SNMP_compliance_alert}

    ${Edit_lig_body}    ${lig_uri}    Build Edit LIG Body    ${LIGS_TB}    ${Edit_Lig_Snmpv1_v2}
    ${Edit_snmp}    Build SNMP body    ${Edit_lig_body}    ${Snmp_False}
    Log to console and logfile    ${Edit_snmp}

    ${Snmp_edit}    Fusion Api Edit Lig    ${Edit_snmp}    ${lig_uri}
    ${task} =   Wait For Task    ${Snmp_edit}    400s    2s

    Verify LI/LIG Consistent Status    ${Expected_Consistency_Status}    ${LE}-${LIG_1}

*** Keywords ***

Build Edit LIG Body
    [Documentation]    Build LIG Body to edit LIG
    [Arguments]    ${LIGS_TB}    ${Edit_Lig}
    ${Get_lig}    Fusion Api Get Lig    param=?filter="'name'=='${LIGS_TB['name']}'"
    ${lig_uri}    Get From Dictionary    ${Get_lig['members'][0]}    uri
    ${Get_lig_body}    Copy Dictionary    ${Get_lig['members']}
    ${Edit_lig_body}    Copy Dictionary    ${Edit_Lig}
    Set To Dictionary    ${Edit_lig_body}    snmpConfiguration    ${Get_lig_body[0]['snmpConfiguration']}
    Set To Dictionary    ${Edit_lig_body}    fabricUri    ${Get_lig_body[0]['fabricUri']}
    Set To Dictionary    ${Edit_lig_body}    interconnectMapTemplate    ${Get_lig_body[0]['interconnectMapTemplate']}
    Set To Dictionary    ${Edit_lig_body}    scopesUri    ${Get_lig_body[0]['scopesUri']}
    Set To Dictionary    ${Edit_lig_body}    created    ${Get_lig_body[0]['created']}
    Set To Dictionary    ${Edit_lig_body}    eTag    ${Get_lig_body[0]['eTag']}
    Set To Dictionary    ${Edit_lig_body}    modified    ${Get_lig_body[0]['modified']}
    Set To Dictionary    ${Edit_lig_body}    uri    ${Get_lig_body[0]['uri']}
    Sleep    10
    [Return]    ${Edit_lig_body}    ${lig_uri}

Build Edit LI Body
    [Documentation]    Build LI Body to edit LI
    [Arguments]    ${LI}    ${Edit_Li}
    ${Get_li}    Fusion Api Get Li    ${LI}
    ${li_uri}    Get From Dictionary    ${Get_li['members'][0]}    uri
    ${Get_li_body}    Copy Dictionary    ${Get_li['members']}
    ${Edit_li_body}    Copy Dictionary    ${Edit_Li}
    Set To Dictionary    ${Edit_li_body}    snmpConfiguration    ${Get_li_body[0]['snmpConfiguration']}
    Set To Dictionary    ${Edit_li_body}    fabricUri    ${Get_li_body[0]['fabricUri']}
    Set To Dictionary    ${Edit_li_body}    interconnectMapTemplate    ${Get_li_body[0]['interconnectMapTemplate']}
    Set To Dictionary    ${Edit_li_body}    scopesUri    ${Get_li_body[0]['scopesUri']}
    Set To Dictionary    ${Edit_li_body}    created    ${Get_li_body[0]['created']}
    Set To Dictionary    ${Edit_li_body}    eTag    ${Get_li_body[0]['eTag']}
    Set To Dictionary    ${Edit_li_body}    modified    ${Get_li_body[0]['modified']}
    Set To Dictionary    ${Edit_li_body}    uri    ${Get_li_body[0]['uri']}
    Sleep    90
    [Return]    ${Edit_li_body}    ${li_uri}

Build SNMP body
    [Documentation]    Build SNMP Body to edit
    [Arguments]    ${Edit_lig_body}     ${True_False}
    ${Get_lig}    Fusion Api Get Lig    param=?filter="'name'=='${LIGS_TB['name']}'"
    ${Get_lig_body}    Copy Dictionary    ${Get_lig['members']}
    Set To Dictionary    ${Edit_lig_body['snmpConfiguration']}    modified   ${Get_lig_body[0]['snmpConfiguration']['modified']}
    Set To Dictionary    ${Edit_lig_body['snmpConfiguration']}    created    ${Get_lig_body[0]['snmpConfiguration']['created']}
    Set To Dictionary    ${Edit_lig_body['snmpConfiguration']}    enabled    ${True_False}
    Set To Dictionary    ${Edit_lig_body['snmpConfiguration']}    readCommunity    ${Public}

    [Return]    ${Edit_lig_body}

Build SNMP LIG body
    [Documentation]    Build SNMP body to edit LIG
    [Arguments]    ${Edit_lig_body}
    ${Get_lig}    Fusion Api Get Lig    param=?filter="'name'=='${LIGS_TB['name']}'"
    ${Get_lig_body}    Copy Dictionary    ${Get_lig['members']}
    Set To Dictionary    ${Edit_lig_body['snmpConfiguration']}    modified   ${Get_lig_body[0]['snmpConfiguration']['modified']}
    Set To Dictionary    ${Edit_lig_body['snmpConfiguration']}    created    ${Get_lig_body[0]['snmpConfiguration']['created']}

    [Return]    ${Edit_lig_body}

Build SNMP LI body
    [Documentation]    Build SNMP body to edit LI
    [Arguments]    ${Snmp_body}     ${True_False}
    ${Get_li}    Fusion Api Get Li
    ${Get_li_body}    Copy Dictionary    ${Get_li['members']}
    Set To Dictionary    ${Snmp_body}    modified   ${Get_li_body[0]['snmpConfiguration']['modified']}
    Set To Dictionary    ${Snmp_body}    created    ${Get_li_body[0]['snmpConfiguration']['created']}
    Set To Dictionary    ${Snmp_body}    enabled    ${True_False}
    Set To Dictionary    ${Snmp_body}    readCommunity    ${Public}

    [Return]    ${Snmp_body}

Login to OneView via REST
    [Documentation]     Login to the appliance with the credentials
    [Tags]  add   POSITIVE
    Set Log Level    TRACE
    ${resp}     Fusion Api Login Appliance    ${APPLIANCE_IP}        ${admin_credentials}

Edit LIG
    [Documentation]   Edit Logical interconnect group
    [Arguments]        ${lig}
    Fusion Api Login Appliance         ${APPLIANCE_IP}        ${admin_credentials}
    ${body} =   Build LIG body      ${lig}
    ${lig} =         Get LIG Member      ${LIG_1}
    ${lig_uri} =    Get LIG Uri         ${LIG_1}
    ${resp} =     Fusion Api Edit LIG    body=${body}        uri=${lig_uri}
    Log to console and logfile    ${resp}
    ${task} =    Wait For Task     ${resp}     120s
    ${valDict} =     Create Dictionary    status_code=${200}
    ...                                 taskState=Completed
    Validate Response    ${task}    ${valDict}


Verify Interconnect State
    [Documentation]    Verifying the IC state
    ...             Example:
    ...             Verify Interconnect State    ${interconnectname_1}    ${IC_Configured}
    [Arguments]        ${interconnectname_1}        ${IC_Configured}
    ${ic} =    Get IC    ${interconnectname_1}
    ${State} =    Get From IC        ${ic}    state
    Log to Console and logfile    ${State}
    Log to console and logfile    Interconnect state is ${interconnectname_1}:${State}
    Should Be Equal As Strings    ${State}    ${IC_Configured}

Get IC
    [Documentation]    Get IC by name
    ...             Example:
    ...             Get IC    ${ICM_NAME}
    [Arguments]        ${ICM_NAME}
    ${resp} =   fusion api get interconnect
    Log        ${resp}
    ${ics} =     Get From Dictionary     ${resp}    members
    ${l} =     Get Length    ${ics}
    :FOR    ${x}    IN RANGE    0    ${l}
    \   ${ic} =     Get From List   ${ics}    ${x}
    \     Exit For Loop If     '${ic['name']}' == '${ICM_NAME}'
    [Return]    ${ic}

Get from IC
    [Documentation]    Get the required element from the interconnect
    ...             Example:
    ...             Get from IC    ${ic}    ${element}
    [Arguments]     ${ic}   ${element}
    ${return} =     Get From Dictionary     ${ic}   ${element}
    [Return]    ${return}

Built the Alert list
    [Documentation]    Build the alert message list and sort list
    [Arguments]    ${Alert_message_compliance}
    ${Line_count}    Get Line Count    ${Alert_message_compliance}
    ${Alert_List}    Create List
    :For    ${x}    INRANGE    0    ${Line_count}
    \    ${Get_line}    Get Line    ${Alert_message_compliance}    ${x}
    \    Append to list    ${Alert_List}    ${Get_line}
    Log to console and logfile    ${Alert_List}
    Sort List    ${Alert_List}
    Log to console    \n\nAlert:${Alert_List}
    [Return]    ${Alert_List}

Get Alert and Compliance Message
    [Documentation]    Get Compliance alert Messages
    [Arguments]    ${Alert_message_compliance}
    ${Get_Alerts}    Fusion Api Get Alerts
    ${Get_alert_count}    Get From Dictionary    ${Get_Alerts}    count
    :For    ${x}    INRANGE    0    ${Get_alert_count}
    \    ${Alertstate}    Get From Dictionary    ${Get_Alerts['members'][${x}]}    alertState
    \    Run Keyword If    '${Alertstate}' != 'Active'    Continue For Loop
    \    ${AlertID}    Get From Dictionary    ${Get_Alerts['members'][${x}]}    alertTypeID
    \    Run Keyword If    '${AlertID}' != 'crm.complianceChange'    Continue For Loop
    \    ${Event_uri}    Get From Dictionary    ${Get_Alerts['members'][${x}]}    associatedEventUris
    \    ${Get_event_details}    Fusion Api Get Alerts    ${Event_uri[0]}
    \    ${Event_Details}    Get From Dictionary    ${Get_event_details}    eventDetails
    \    ${Count}    Get Length    ${Event_Details}
    \    ${Event_item_value}    Get Event Item Value    ${Count}    ${Event_Details}
    \    Lists Should Be Equal    ${Event_item_value}    ${Alert_message_compliance}

Get Event Item Value
    [Documentation]    Get Event Item Values from the corresponding
    [Arguments]    ${count}    ${event_details}
    :For    ${x}    INRANGE    0    ${count}
    \    ${Get_event_name}    Get From Dictionary    ${event_details[${x}]}    eventItemName
    \    Run Keyword If    '${Get_event_name}' != 'snmp'    Continue For Loop
    \    ${Event_item_value}    Get From Dictionary    ${event_details[${x}]}    eventItemValue
    \    ${Actual_Alert}    Built the Alert list    ${Event_item_value}

    [Return]    ${Actual_Alert}

Perform an LI Update From Group
    [Documentation]    Perform Update From Group in LI
    ...             Example:
    ...             Perform an LI Update From Group    ${li}    ${interval}
    [Arguments]       ${li}=${LE}-${LIG_1}     ${timeout}=30 min    ${interval}=15s
    ${resp} =       Fusion Api Update from group    ${li}
    ${task} =       Wait For Task       ${resp}     ${timeout}        ${interval}
    ${valDict} =    Create Dictionary   status_code=${200}
    ...                                 taskState=Completed
    Validate Response    ${task}    ${valDict}

Verify LI/LIG Consistent Status
    [Documentation]    Verifying Consistency Status of  LI/LIG
    [Arguments]    ${Expected_Consistency_Status}    ${li}=${LE}-${LIG_1}
    Sleep    90
    ${Li_resp}= Fusion Api Get Li
    ${l} =  Get Length  ${Li_resp['members']}
    :FOR    ${x}    IN RANGE    0   ${l}
    \   Run Keyword If  '${Li_resp['members'][${x}]['name']}' != '${li}'        Continue For Loop
    \   Should Be Equal As Strings  ${Li_resp['members'][${x}]['consistencyStatus']}    ${Expected_Consistency_Status}
    Log to console and logfile    LI/LIG are ${Expected_Consistency_Status}.

Cleanup For Suite

    [Documentation]    Returns appliance to a 'clean' state by removing all resources\enclosures
    Log to console and logfile    [Cleanup]
    Login to OneView via REST
    Power off ALL Servers
    Remove All Server Profiles
    Remove All Enclosures
    Remove ALL Enclosure Groups
    Remove ALL LIGs
    Remove All Network Sets
    Remove ALL Ethernet Networks
    Remove ALL FC Networks
    Remove ALL FCoE Networks