*** Settings ** *
Documentation      	Continuous Integration Tests for RoboGalaxy dev Branch
Resource           	lig-eg-le_config.txt
Library				Screenshot
Force Tags         	Buildup
Suite Setup         Load Test Data and Open Browser
Suite Teardown      Logout And Close All Browsers
Test Teardown       CaptureScreenShot


*** Variables ***
${Permissible_IC_STATES_BeforeUpdate}=    ['configured','unmanaged']
${Permissible_IC_STATES_AfterUpdate}=    ['configured']


*** Keywords ***
CaptureScreenShot
	Run Keyword IF Test Failed    Take Screenshot
	

*** Test Cases ***

Login to appliance
		Set Log Level    TRACE
    	Log Variables
   		${user}=	Get Data By Property	${TestData.users}	name	Administrator
        Fusion UI Login to Appliance   ${user[0].name}
 
 		
create networks and Cleanup

    	#Log to Console   Create Ethernet Network
 	    #Fusion UI Create Ethernet Network	  @{TestData.networks}
        
        
        #delete Server profiles
		#fusion_ui_power_off_server_profile    @{TestData.profiles}
		#fusion_ui_delete_server_profile     @{TestData.profiles}
        
       	#fusion_ui_power_off_server_profile    @{TestData.deleteprofiles}
		#fusion_ui_delete_server_profile     @{TestData.deleteprofiles}
        
         
        #delete LEs before creation
		fusion_ui_delete_logical_enclosure    @{TestData.les}
	
		#delete the EGs to be created
		#fusion_ui_delete_enclosure_group    @{TestData.encgroups} 
	
		#delete LIG before creation
        #fusion_ui_delete_logical_interconnect_group    @{TestData.ligs}
       	
        #fusion_ui_delete_logical_interconnect_group    @{TestData.editligs}
        
        #delete iprange
        #fusion_ui_delete_ipv4_address_range  @{TestData.editAddressIdentifiers}
    
    
#Create the IPV4 address range-required by EG
#    	Log To Console    *********************Create the IPV4 address range*********************************
#    	${Status}=	 fusion_ui_create_ipv4_address_range   @{TestData.editAddressIdentifiers}
#   		Run Keyword And Continue On Failure    Should Be Equal    '${Status}'   'True'   ${Status} 
#    	Run Keyword If	 '${Status}' == 'True'	 Log to Console	 IPV4 Addresses are created Successfully.    ELSE     Log to Console   Errors seen While creating IpV4 address!!
#		Log To Console    *********************Create the IPV4 address range Completed*********************************
    
#Create LIG and verify creation
 #       #Create LIG
 #       Log To Console    ******CREATE LIG**********
#		${Status}=    fusion_ui_create_logical_interconnect_group_tbird 		@{TestData.ligs}
#		Run Keyword And Continue On Failure   Should Be Equal   '${Status}'   'True'   ${Status}
#		Log To Console    ******CREATE LIG operations completed**********	
#		
#		#verify LIG
#		Log To Console    ******Verify LIG after Create operation**********
#		${Status}=    fusion_ui_verify_logical_interconnect_group 		@{TestData.ligs}
#		Run Keyword And Continue On Failure   Should Be Equal   '${Status}'   'True'   ${Status} 
#		Log To Console    ******Verify LIG complete**********
		
#EDIT LIG and verify edit	
#		#Edit LIG
#		Log To Console    ******EDIT LIG**********
#		${Status}=    fusion_ui_edit_logical_interconnect_group_tbird 		@{TestData.editligs}
#		Run Keyword And Continue On Failure   Should Be Equal   '${Status}'   'True'   ${Status}
#		Log To Console    ******EDIT LIG operations completed**********	
		
#		#Log To Console    ******Verify LIG after Edit operation**********
#		${Status}=    fusion_ui_verify_logical_interconnect_group 		@{TestData.editligs}
#		Run Keyword And Continue On Failure   Should Be Equal   '${Status}'   'True'   ${Status} 
#		Log To Console    ******Verify LIG complete**********
		
#Create EG		
#		#create EG
#		Log To Console    ******CREATE EG**********
#		${Status}=    fusion_ui_create_enclosure_group    @{TestData.encgroups} 
#		Run Keyword And Continue On Failure   Should Be Equal   '${Status}'   'True'   ${Status}
		#verify EG creation
		#fusion_ui_verify_enclosuregroup    @{TestData.encgroups} 
		#Log To Console    ******CREATE EG operations completed**********
		
Create LE	
		#create LE
		Log To Console    ******CREATE LE**********
		${Status}=    fusion_ui_create_logical_enclosure    @{TestData.les} 
		Run Keyword And Continue On Failure   Should Be Equal   '${Status}'   'True'   ${Status}
		Log To Console    ******CREATE LE operations completed**********

Verify IC and server ILO IPv4 IPs are from custom range specified
		
		Log To Console   ****VERIFY THE IC IPV4 IP IS FROM CUSTOME RANGE DEFINED*********
		${Status}=   fusion_ui_verify_ic_ipv4address_of_li_in_le_within_range_pool   ${TestData.les[0].name}   @{TestData.editAddressIdentifiers}   
		Run Keyword And Continue On Failure   Should Be Equal   '${Status}'   'True'   One or more of the IC ipv4 IPs are not from the custom range defined
		
		Log To Console   ****VERIFY THE SERVER ILO IPV4 IP IS FROM CUSTOME RANGE DEFINED*********
		${Status}=   fusion_ui_verify_ilo_ipv4ips_of_servers_in_le_within_range_pool   	${TestData.les[0].name}   @{TestData.editAddressIdentifiers}  
		Run Keyword And Continue On Failure   Should Be Equal   '${Status}'   'True'   One or more of the Server ILO ipv4 IPs are not from the custom range defined
		
		
Create Server profiles
		#create Server profile
		Log To Console    *********Power OFF Server ****************
		${status}=    fusion_ui_power_off_server   ${TestData.profiles[0].server}
		Log To Console    Server Hardware power OFF status : ${status}
		${status}=    fusion_ui_power_off_server   ${TestData.profiles[1].server}
		Log To Console    Server Hardware power OFF status : ${status}
		
		
		Log To Console    *********Create Server profile**************** 
		${Status}=    fusion_ui_create_server_profile     @{TestData.profiles}
		Log to Console   Server profile creation status: ${Status}
		
		#power on server 
		Log To Console    *********Power On Server ****************
		${Status}=    fusion_ui_power_on_server_profile     @{TestData.profiles}
		Log to Console   Server profile power on status: ${Status}
		
#verify EG creation
#		#verify EG creation
#		Log To Console    ******Verify EG*******************************
#		${Status}=     fusion_ui_verify_enclosuregroup    @{TestData.encgroups} 
#		Run Keyword And Continue On Failure   Should Be Equal   '${Status}'   'True'   ${Status}
#		Log To Console    ******Verify EG operations completed**********
		
	

#Upgrade FW of LE--force-Shared Infrastructure
#		Log to Console	****** CHECK AND WAIT FOR ENCLOSURE REFRESH ACTIVITY TO COMPLETE ********
#		fusion_ui_wait_for_enclosure_refresh_complete   ${TestData.firmware1.enclosure[0].name}
#		fusion_ui_wait_for_enclosure_refresh_complete   ${TestData.firmware1.enclosure[1].name}
		
#		Log To Console  ******VERIFY IC STACKING DOMAIN ROLE of LE BEFORE FW UPDATE******
#		${Status}=   fusion_ui_verify_ic_stacking_domain_role_of_le    ${TestData.firmware1}
#		Run Keyword and Continue on Failure	 Should Be Equal		'${Status}'		'True'  	Something Wrong with IC stacking Roles.FW update might Not be successful!!
		
		
#		Log to Console	****** VERIFY IC STATE OF LE BEFORE FW UPDATE ********
#		${Status}=   fusion_ui_verify_ic_state_of_le   ${Permissible_IC_STATES_BeforeUpdate}   ${TestData.firmware1}
#		Run Keyword If    '${Status}'=='True'   Log To Console  IC Sates as desired   ELSE     Fail
		
#		# UPDATE FIRMWARE
#		${Status}=	fusion_ui_update_tbird_logical_enclosure_firmware   	${TestData.firmware1}
#		Run Keyword and Continue on Failure  Should Be Equal		'${Status}'		'True'  	${Status}
		
#		Log to Console	****** VERIFY LE FW UPDATE ACTIVITY ********
#		${Status}=	fusion_ui_validate_le_firmware_upgrade_activity_details 	${TestData.firmware1}
#		Run Keyword and Continue on Failure  Should Contain    ${Status}    TEST PASSED    LE FW Update Test FAILED
		
#		Log to Console	****** VERIFY IC FW ********
#		${Status}=   fusion_ui_verify_li_and_ic_firmware_versions  ${TestData.firmware1}   
#		Run Keyword and Continue on Failure 	Should Be Equal  '${Status}'		'True'  	Error during Firmware Version and IC activity Messages Validation

#		Log To Console  ******VERIFY IC STACKING DOMAIN ROLE of LE AFTER FW UPDATE******
#		${Status}=   fusion_ui_verify_ic_stacking_domain_role_of_le    ${TestData.firmware1}
#		Run Keyword and Continue on Failure	 Should Be Equal		'${Status}'		'True'  	Something Wrong with IC stacking Roles.FW update might Not be successful!!
	

#		Log to Console	****** VERIFY IC STATE OF LE AFTER FW UPDATE ********
#		${Status}=   fusion_ui_verify_ic_state_of_le   ${Permissible_IC_STATES_AfterUpdate}   ${TestData.firmware1}
#		Run Keyword If    '${Status}'=='True'   Log To Console  IC Sates as desired   ELSE     Fail
		



#Edit server profile
#		#edit server profile
#		Log To Console    *********Power Off Server profile****************
#		#power off server profile
#		${Status}=    fusion_ui_power_off_server_profile    ${TestData.profiles[1]}
#		Log to Console   Server profile power off status: ${Status}
#		Log To Console    *********Edit Server profile****************
#		${Status}=    fusion_ui_edit_server_profile    ${TestData.profiles[1]}
#		Log to Console   Server profile EDIT status: ${Status}
		
		

#Delete Server PRofile
#	Log To Console    *********Delete Server profile****************
#	#delete Server profiles
#	fusion_ui_power_off_server_profile    ${TestData.profiles[0]}
#	${Status}=     fusion_ui_delete_server_profile     ${TestData.profiles[0]}
#    Log to Console   Server profile delete status: ${Status} 
    
     
#    fusion_ui_power_off_server_profile    @{TestData.deleteprofiles}
#	${Status}=       fusion_ui_delete_server_profile     @{TestData.deleteprofiles}
#   	Log to Console   Server profile delete status: ${Status} 
    

#Delete Logical Enclosure
#	Log To Console    *********Delete LE****************
#	#delete the LE Created
#	${Status}=   fusion_ui_delete_logical_enclosure    @{TestData.les} 
#	Run Keyword And Continue On Failure   Should Be Equal   '${Status}'   'True'   ${Status}
#	Log To Console    ******DELETE LE operations completed**********
	

#Edit Enclosure Group and verify Update
#	#edit EG
#	Log To Console    *********Edit EG****************
#	${Status}=    fusion_ui_edit_enclosure_group   @{TestData.editencgroups}
#	Run Keyword And Continue On Failure   Should Be Equal   '${Status}'   'True'   ${Status}
#	#verify Edit
#	${Status}=     fusion_ui_verify_enclosuregroup    @{TestData.editencgroups}
#	Run Keyword And Continue On Failure   Should Be Equal   '${Status}'   'True'   ${Status}
#	Log To Console    ******EDIT operations completed**********
	
	
#Delete EG- After Creation and Update
#	Log To Console    *********Delete EG****************
#	#delete the EGs created
#	${Status}=   fusion_ui_delete_enclosure_group    @{TestData.encgroups} 
#	Run Keyword And Continue On Failure   Should Be Equal   '${Status}'   'True'   ${Status}
	
	
#	#delete the EGs edited
#	#${Status}=   fusion_ui_delete_enclosure_group    @{TestData.editencgroups} 
#	#Run Keyword And Continue On Failure   Should Be Equal   '${Status}'   'True'   ${Status}
#	#Fusion UI Logout of Appliance
#	#Log To Console    ******DELETE EG operations completed**********
				
		
    	
        
