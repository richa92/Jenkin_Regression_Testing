

*** Settings ***

Resource			firmware_config.txt
Force Tags			Buildup
Suite Setup			Load Test Data and Open Browser
Suite Teardown		Logout And Close All Browsers



*** Variables ***
${ExpectedErrorMsg1}=    No update required
${ExpectedErrorMsg2}=    Selected firmware is already installed in the logical interconnect
${ExpectedErrorMsg3}=    Selected firmware is already installed
${ExpectedErrorMsg4}=    Unable to update firmware for the logical interconnect
${ExpectedErrorMsg5}=    an attempt was made to downgrade the firmware without selecting the force option
${ExpectedErrorMsg5.1}=    Retry the downgrade operation by selecting force option in the logical interconnect firmware update page
${ExpectedErrorMsg6}=    Firmware activation failed for logical interconnect
${ExpectedErrorMsg7}=    Activation failed due to failure of firmware update operation on interconnect
${ExpectedErrorMsg8}=    If the interconnects are in configured, unmanaged, maintenance or configuration error state, try the firmware activation again
${ExpectedErrorMsg9}=	 If the interconnect is in any other state, refresh the enclosure and then retry the firmware update
${ExpectedErrorMsg10}=    If the problem continues to occur, contact your authorized support representative and provide them with a support dump
${ExpectedErrorMsg11}=    One or more interconnects are not in a valid state for firmware update
${ExpectedErrorMsg11.1}=   Visit the listed interconnects and examine the Activity view and follow the problem resolution steps listed there in order to bring the interconnects back to a Configured state or an Unmanaged state
${ExpectedErrorMsg11.2}=   AddedWithErrors state
${ExpectedErrorMsg12}=    There is an ongoing operation on the resource

${ExpectedErrorMsg13}=    One or more interconnects are not in a valid state for firmware update
${ExpectedErrorMsg14}=    Configuring state

*** Test Cases ***

Login to appliance
		Set Log Level    TRACE
    	Log Variables

 		${user}=	Get Data By Property	${TestData.users}	name	Administrator
		Fusion UI Login to Appliance   ${user[0].name}
   



#########################NEGATIVE SCENARIOS####################################################

		
#1.Same Version FW update for LE--without force option-Shared Infrastructure
#		#fusion_ui_wait_for_enclosure_refresh_complete   ${TestData.firmware10.enclosure[0].name}
#		#fusion_ui_wait_for_enclosure_refresh_complete   ${TestData.firmware10.enclosure[1].name}
#		#fusion_ui_wait_for_enclosure_refresh_complete   ${TestData.firmware10.enclosure[2].name}
		
#		${Status}=	fusion_ui_update_tbird_logical_enclosure_firmware   	${TestData.firmware10}
#		Run Keyword and Continue on Failure	Should Be Equal		'${Status}'		'True'  	${Status}
#		
#		${Status}=	fusion_ui_validate_le_firmware_upgrade_activity_details 	${TestData.firmware10}

#		${Status}=   			Convert To Lowercase    ${Status}
#		${ExpectedErrorMsg1}=   Convert To Lowercase    ${ExpectedErrorMsg1}
#		${ExpectedErrorMsg2}=   Convert To Lowercase    ${ExpectedErrorMsg2}

#		Run Keyword and Continue on Failure	   Should Contain		'${Status}'		${ExpectedErrorMsg1}  	Expected Error Message Not seen
#		Run Keyword and Continue on Failure	   Should Contain		'${Status}'		${ExpectedErrorMsg2}  	Expected Error Message Not seen


#2.Downgrade FW of LE--without force option-Shared Infrastructure
#		fusion_ui_wait_for_enclosure_refresh_complete   ${TestData.firmware11.enclosure[0].name}
#		fusion_ui_wait_for_enclosure_refresh_complete   ${TestData.firmware11.enclosure[1].name}
		#fusion_ui_wait_for_enclosure_refresh_complete   ${TestData.firmware10.enclosure[2].name}
		
#		${Status}=	fusion_ui_update_tbird_logical_enclosure_firmware   	${TestData.firmware11}
#		Run Keyword and Continue on Failure	Should Be Equal		'${Status}'		'True'  	${Status}
		
#		${Status}=	fusion_ui_validate_le_firmware_upgrade_activity_details 	${TestData.firmware11}
#
#		${Status}=   			Convert To Lowercase    ${Status}
#		${ExpectedErrorMsg4}=   Convert To Lowercase    ${ExpectedErrorMsg4}
#		${ExpectedErrorMsg5}=   Convert To Lowercase    ${ExpectedErrorMsg5}
#		${ExpectedErrorMsg5.1}=   Convert To Lowercase    ${ExpectedErrorMsg5.1}

#		Run Keyword and Continue on Failure	   Should Contain		'${Status}'		${ExpectedErrorMsg4}  	Expected Error Message Not seen
#		Run Keyword and Continue on Failure	   Should Contain		'${Status}'		${ExpectedErrorMsg5}  	Expected Error Message Not seen
#		Run Keyword and Continue on Failure	   Should Contain		'${Status}'		${ExpectedErrorMsg5.1}  	Expected Error Message Not seen
		

#Same Version FW update for LE--without force option-EM only
#		fusion_ui_wait_for_enclosure_refresh_complete   ${TestData.firmware14.enclosure[0].name}
#		fusion_ui_wait_for_enclosure_refresh_complete   ${TestData.firmware14.enclosure[1].name}
		#fusion_ui_wait_for_enclosure_refresh_complete   ${TestData.firmware10.enclosure[2].name}
		
#		${Status}=	fusion_ui_update_tbird_logical_enclosure_firmware   	${TestData.firmware14}
#		Run Keyword and Continue on Failure	Should Be Equal		'${Status}'		'True'  	${Status}
		
#		${Status}=	fusion_ui_validate_le_firmware_upgrade_activity_details 	${TestData.firmware14}
		
#		${Status}=   			Convert To Lowercase    ${Status}
#		${ExpectedErrorMsg1}=   Convert To Lowercase    ${ExpectedErrorMsg1}
#		${ExpectedErrorMsg3}=   Convert To Lowercase    ${ExpectedErrorMsg3}
		
		
#		Run Keyword and Continue on Failure	   Should Contain		'${Status}'		${ExpectedErrorMsg1} 	Expected Error Message Not seen
#		Run Keyword and Continue on Failure	   Should Contain		'${Status}'		${ExpectedErrorMsg3}  	Expected Error Message Not seen
		



#4.Downgrade FW of LE--without force option-EM only
#		${Status}=	fusion_ui_update_tbird_logical_enclosure_firmware   	${TestData.firmware15}
#		Run Keyword and Continue on Failure	Should Be Equal		'${Status}'		'True'  	${Status}
		
#		${Status}=	fusion_ui_validate_le_firmware_upgrade_activity_details 	${TestData.firmware15}
#		Run Keyword and Continue on Failure	   Should Contain		'${Status}'		${ExpectedErrorMsg5}  	Expected Error Message Not seen
		
	
#Same Version FW update for LE--without force option-Shared Infrastructure and profiles
		#fusion_ui_wait_for_enclosure_refresh_complete   ${TestData.firmware12.enclosure[0].name}
		#fusion_ui_wait_for_enclosure_refresh_complete   ${TestData.firmware12.enclosure[1].name}
		
#		${Status}=	fusion_ui_update_tbird_logical_enclosure_firmware   	${TestData.firmware12}
#		Run Keyword and Continue on Failure	Should Be Equal		'${Status}'		'True'  	${Status}
		
#		${Status}=	fusion_ui_validate_le_firmware_upgrade_activity_details 	${TestData.firmware12}
		
#		${Status}=   			Convert To Lowercase    ${Status}
#		${ExpectedErrorMsg1}=   Convert To Lowercase    ${ExpectedErrorMsg1}
#		${ExpectedErrorMsg2}=   Convert To Lowercase    ${ExpectedErrorMsg2}
		   
#		Run Keyword and Continue on Failure	   Should Contain		'${Status}'		${ExpectedErrorMsg1}  	Expected Error Message Not seen
#		Run Keyword and Continue on Failure	   Should Contain		'${Status}'		${ExpectedErrorMsg2}  	Expected Error Message Not seen
		


#Downgrade FW of LE--without force option-Shared Infrastructure and profiles
#		fusion_ui_wait_for_enclosure_refresh_complete   ${TestData.firmware13.enclosure[0].name}
#		fusion_ui_wait_for_enclosure_refresh_complete   ${TestData.firmware13.enclosure[1].name}
		#fusion_ui_wait_for_enclosure_refresh_complete   ${TestData.firmware10.enclosure[2].name}
		
		
#		${Status}=	fusion_ui_update_tbird_logical_enclosure_firmware   	${TestData.firmware13}
#		Run Keyword and Continue on Failure	Should Be Equal		'${Status}'		'True'  	${Status}
		
#		${Status}=	fusion_ui_validate_le_firmware_upgrade_activity_details 	${TestData.firmware13}

#		${Status}=   			Convert To Lowercase    ${Status}
#		${ExpectedErrorMsg4}=   Convert To Lowercase    ${ExpectedErrorMsg4}
#		${ExpectedErrorMsg5}=   Convert To Lowercase    ${ExpectedErrorMsg5}
#		${ExpectedErrorMsg5.1}=   Convert To Lowercase    ${ExpectedErrorMsg5.1}

#		Run Keyword and Continue on Failure	   Should Contain		'${Status}'		${ExpectedErrorMsg4}  	Expected Error Message Not seen
#		Run Keyword and Continue on Failure	   Should Contain		'${Status}'		${ExpectedErrorMsg5}  	Expected Error Message Not seen
#		Run Keyword and Continue on Failure	   Should Contain		'${Status}'		${ExpectedErrorMsg5.1}  	Expected Error Message Not seen
		


#7.Simulate an Activation failure scenario and verify it throws appropriate error in the LE activity page
#		fusion_ui_wait_for_enclosure_refresh_complete   ${TestData.firmware16.enclosure[0].name}
#		fusion_ui_wait_for_enclosure_refresh_complete   ${TestData.firmware16.enclosure[1].name}
		
#		${Status}=	fusion_ui_update_tbird_logical_enclosure_firmware   	${TestData.firmware16}
#		Should Contain   '${Status}'	Error  	Firmware Update should have failed!!Seems like it Passed!!No Point Validating Rest!!
		
#		${Status}=	 fusion_ui_validate_le_firmware_upgrade_activity_details 	${TestData.firmware16}
		
#		${Status}=   			Convert To Lowercase    ${Status}
#		${ExpectedErrorMsg6}=   Convert To Lowercase    ${ExpectedErrorMsg6}
#		${ExpectedErrorMsg7}=   Convert To Lowercase    ${ExpectedErrorMsg7}
#		${ExpectedErrorMsg8}=   Convert To Lowercase    ${ExpectedErrorMsg8}
#		${ExpectedErrorMsg9}=   Convert To Lowercase    ${ExpectedErrorMsg9}
#		${ExpectedErrorMsg10}=   Convert To Lowercase    ${ExpectedErrorMsg10}
		
		
#		Run Keyword and Continue on Failure	   Should Contain		'${Status}'		${ExpectedErrorMsg6} 	Expected Error Message Not seen
#		Run Keyword and Continue on Failure	   Should Contain		'${Status}'		${ExpectedErrorMsg7}  	Expected Error Message Not seen
#		Run Keyword and Continue on Failure	   Should Contain		'${Status}'		${ExpectedErrorMsg8} 	Expected Error Message Not seen
#		Run Keyword and Continue on Failure	   Should Contain		'${Status}'		${ExpectedErrorMsg9}  	Expected Error Message Not seen
#		Run Keyword and Continue on Failure	   Should Contain		'${Status}'		${ExpectedErrorMsg10} 	Expected Error Message Not seen
		
		
#8.Update when IC's are in added with errors/Configuration error/configuring/adding state- with Force flag
#		fusion_ui_wait_for_enclosure_refresh_complete   ${TestData.firmware17.enclosure[0].name}
#		fusion_ui_wait_for_enclosure_refresh_complete   ${TestData.firmware17.enclosure[1].name}
		
		#${Status}=	fusion_ui_update_tbird_logical_enclosure_firmware   	${TestData.firmware17}
		#Run Keyword and Continue on Failure	Should Be Equal		'${Status}'		'True'  	${Status}
		
#		${Status}=	 fusion_ui_validate_le_firmware_upgrade_activity_details 	${TestData.firmware17}
#		${Status}=   			Convert To Lowercase    ${Status}
#		${ExpectedErrorMsg11}=   Convert To Lowercase    ${ExpectedErrorMsg11}   
#		${ExpectedErrorMsg11.1}=   Convert To Lowercase    ${ExpectedErrorMsg11.1}
#		${ExpectedErrorMsg11.2}=   Convert To Lowercase   ${ExpectedErrorMsg11.2}  
		
#		Run Keyword and Continue on Failure	   Should Contain		'${Status}'		${ExpectedErrorMsg11} 	Expected Error Message Not seen
#		Run Keyword and Continue on Failure	   Should Contain		'${Status}'		${ExpectedErrorMsg11.1}  	Expected Error Message Not seen
#		Run Keyword and Continue on Failure	   Should Contain		'${Status}'		${ExpectedErrorMsg11.2} 	Expected Error Message Not seen
		
		
#positive
#9.Firmware Update after Activation Failure scenario-Positive scenario
#		fusion_ui_wait_for_enclosure_refresh_complete   ${TestData.firmware17.enclosure[0].name}
#		fusion_ui_wait_for_enclosure_refresh_complete   ${TestData.firmware17.enclosure[1].name}

#		${Status}=	fusion_ui_update_tbird_logical_enclosure_firmware   	${TestData.firmware17}
#		Run Keyword and Continue on Failure	Should Be Equal		'${Status}'		'True'  	${Status}
		
#		${Status}=	fusion_ui_validate_le_firmware_upgrade_activity_details 	${TestData.firmware17}
#		Should Contain    ${Status}    TEST PASSED    LE FW Update Test FAILED
#		${Status}=   fusion_ui_verify_li_and_ic_firmware_versions  ${TestData.firmware17}   
#		Run Keyword and Continue on Failure 	Should Be Equal		'${Status}'		'True'  	LI and IC Firmwares are not the same
	

#Refresh Enclosure and trigger FW update - UPdate fails with message- There is an ongoing operation on the resource		
#		fusion_ui_refresh_enclosure     ${TestData.firmware17.enclosure[0].name}   False 
#		${Status}=	fusion_ui_update_tbird_logical_enclosure_firmware   	${TestData.firmware17}  		
#		${Status}=  Convert To Lowercase    ${Status}
#		${ExpectedErrorMsg12}=   Convert To Lowercase    ${ExpectedErrorMsg12}
#		Run Keyword and Continue on Failure	   Should Contain		'${Status}'		${ExpectedErrorMsg12} 	Expected Error Message Not seen


#Negative : Trigger Upgrade from LI , and then From LE
#Unable to update firmware for logical enclosure as firmware update is in progress for one or more logical interconnects 
#Firmware update is already in progress for one or more logical interconnects. Please wait for it to complete.

#Reapply LI configuration and trigger FW update-UPdate fails with message-There is an ongoing operation on the resource		

#		fusion_UI_reapply_li_configuration_of_le  ${TestData.firmware17.lename}   false 
#		${Status}=	fusion_ui_update_tbird_logical_enclosure_firmware   	${TestData.firmware17}  		
#		Run Keyword and Continue on Failure	 Should Be Equal		'${Status}'		'True'  	${Status}
		
#		${Status}=	 fusion_ui_validate_le_firmware_upgrade_activity_details 	${TestData.firmware17}
#		${Status}=   Convert To Lowercase    ${Status}
#		${ExpectedErrorMsg11.1}=   Convert To Lowercase    ${ExpectedErrorMsg11.1}
#		${ExpectedErrorMsg13}=   Convert To Lowercase    ${ExpectedErrorMsg13}
#		${ExpectedErrorMsg14}=   Convert To Lowercase    ${ExpectedErrorMsg14}

#		Run Keyword and Continue on Failure	   Should Contain		'${Status}'		${ExpectedErrorMsg13} 	Expected Error Message Not seen
#		Run Keyword and Continue on Failure	   Should Contain		'${Status}'		${ExpectedErrorMsg14} 	Expected Error Message Not seen
#		Run Keyword and Continue on Failure	   Should Contain		'${Status}'		${ExpectedErrorMsg11.1} 	Expected Error Message Not seen
  
		