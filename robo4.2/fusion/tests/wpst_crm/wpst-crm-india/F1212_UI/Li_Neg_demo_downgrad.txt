*** Settings ***
Documentation      Continuous Integration Tests for  F1212 Feature
Resource           F1212OVAConfig.txt
Force Tags         Buildup
Suite Setup         Load Test Data and Open Browser
Suite Teardown      Logout And Close All Browsers
Library             Dialogs
Library             String
Library             Collections

*** Variables ***
${ExpectedErrorMsg1}=           Unable to update firmware for the logical interconnect SGH420HHYA-LIG_B1 as an attempt was made to downgrade the firmware without selecting the force option.
${ExpectedErrorMsg3}=           No update required. Selected firmware is already installed in the logical interconnect SGH420HHYA-LIG_B1.
${ExpectedErrorMsg1}=    No update required
${ExpectedErrorMsg2}=    Selected firmware is already installed in the logical interconnect
${ExpectedErrorMsg3}=    Selected firmware is already installed
${ExpectedErrorMsg4}=    Unable to update firmware for the logical interconnect
${ExpectedErrorMsg5}=    an attempt was made to downgrade the firmware without selecting the force option
${ExpectedErrorMsg5.1}=    Retry the downgrade operation by selecting force option in the logical interconnect firmware update page
${ExpectedErrorMsg6}=    Firmware activation failed for logical interconnect
${ExpectedErrorMsg7}=    Activation failed due to failure of firmware update operation on interconnect
${ExpectedErrorMsg8}=    If the interconnects are in configured, unmanaged, maintenance or configuration error state, try the firmware activation again
${ExpectedErrorMsg9}=    If the interconnect is in any other state, refresh the enclosure and then retry the firmware update
${ExpectedErrorMsg10}=    If the problem continues to occur, contact your authorized support representative and provide them with a support dump
${ExpectedErrorMsg11}=    One or more interconnects are not in a valid state for firmware update
${ExpectedErrorMsg11.1}=   Visit the listed interconnects and examine the Activity view and follow the problem resolution steps listed there in order to bring the interconnects back to a Configured state or an Unmanaged state
${ExpectedErrorMsg11.2}=   AddedWithErrors state
${ExpectedErrorMsg12}=    There is an ongoing operation on the resource

${ExpectedErrorMsg13}=    One or more interconnects are not in a valid state for firmware update
${ExpectedErrorMsg14}=    Configuring state

${Permissible_IC_STATES_BeforeUpdate}=    ['configured','unmanaged']
${Permissible_IC_STATES_AfterUpdate}=    ['configured']

${li_list} =    SGH420HHYA-LIG_B1

*** Test Cases ***

###############################    Downgrading the firmware without force flag ############################
TC01 downgrading the firmware without force flag

        Set Log Level    TRACE
        Log Variables
        ${user}=    Get Data By Property    ${TestData.users}   name    Administrator
        Fusion UI Login to Appliance   ${user[0].name}

        Log To Console   "###############  downgrading the firmware without force flag############"
        [Documentation]    "1.3.1.1 Hill FW update LI: Staging of firmware of hill module without force flag"
        Log to Console    "Testcase_ID: TP section 1.3.1.1 F1212_TC_UI_58 --> Staging of firmware of hill module without force flag"

        ${Status}=  fusion_ui_update_firmware_logical_interconnect      @{TestData.Update_firmware_ebb_neg}[1]
        run keyword if    '${status}'=='False'    Fail      " Update Firmware(Stage+Activate) of Hill via LI Failed "


#       ${Status}=    fusion_ui_update_firmware_logical_interconnect      @{TestData.NegUpdate_firmware_ebb}[0]   # Lower version

        ${Status}=    fusion_ui_validate_error_message_li     ${TestData.firmwareLi1}
        Log to Console    ${Status}
        ${Status}=              Convert To Lowercase    ${Status}
        ${ExpectedErrorMsgbb}=   Convert To Lowercase    ${ExpectedErrorMsg1}
        #${ExpectedErrorMsg3}=   Convert To Lowercase    ${ExpectedErrorMsg3}

        Run Keyword and Continue on Failure    Should Contain       '${Status}'     ${ExpectedErrorMsgbb}   Expected Error Message Not seen
        Log to Console     Found the desired Alert message ${ExpectedErrorMsgbb}
        #Run Keyword and Continue on Failure       Should Contain       '${Status}'     ${ExpectedErrorMsg3}    Expected Error Message Not seen

