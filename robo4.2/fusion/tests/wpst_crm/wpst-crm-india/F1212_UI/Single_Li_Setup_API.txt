*** Settings ***
Documentation       Feature  test  : Firmware update F1212 of Hill Module
...                 on Enclosure G3,G2 G1
Variables           data_variables.py
#Resource           ../../resources/resource.txt
Resource            ../../../../resource/fusion_api_all_resource_files.txt
Library             Collections
Library             json
Library             OperatingSystem
Library             Selenium2Library

*** Variables ***
${firmwareVersion_upgrade}     3.00
${SSH_PASS}                 hpvse1
${DataFile}                 ./OVAData.xml
${APPLIANCE_IP}             10.10.0.215
${X-API-VERSION}            300

${ICM_NAME1}                         SGH420HHYA, interconnect 3
${ICM_NAME2}                         SGH420HHYA, interconnect 4
${ICM_NAME3}                         SGH420HHYA, interconnect 6
${ICM_NAME4}                         SGH420HHYA, interconnect 7
${ICM_NAME5}                         SGH420HHYA, interconnect 1
${ICM_NAME6}                         SGH420HHYA, interconnect 2
${BAY1}                              1
${IP}                           192.168.144.132

${Last_AlertID}            0
${Starting_AlertID}        1
${E_value}                       No update required. Selected firmware is already installed in the logical interconnect
${RR_BB}                         Staging started for the interconnect SGH420HHYA, interconnect 3 with firmware version 3.00 v7.2.1_33 from baseline
${RR_BB_st_succ}                 Staging success for the interconnect SGH420HHYA, interconnect 3 with firmware version 3.00 v7.2.1_33 from baseline

${RR_BB_act_suc}                 Activation success for the interconnect SGH420HHYA, interconnect 3 with firmware version 3.00 v7.2.1_33 from baseline
${RR_BB_act_str}                 Activation started for the interconnect SGH420HHYA, interconnect 3 with firmware version 3.00 v7.2.1_33 from baseline

${ICM_Alert1}                    Staging started for the interconnect SGH420HHYA, interconnect 3 with firmware version 3.01 v7.2.1_38 from baseline
${ICM_Alert2}                    Staging success for the interconnect SGH420HHYA, interconnect 3 with firmware version 3.01 v7.2.1_38 from baseline

${ICM_Alert3}                    Activation success for the interconnect SGH420HHYA, interconnect 3 with firmware version 3.01 v7.2.1_38 from baseline
${ICM_Alert4}                    Activation started for the interconnect SGH420HHYA, interconnect 3 with firmware version 3.01 v7.2.1_38 from baseline

${LE_N_Alert1}                  No update required. Selected firmware is already installed for the Onboard Administrator.
${LE_N_Alert2}                  No update required. Selected firmware is already installed in the logical interconnect
${ICM_Alert1_stg_star}           Staging started for the interconnect
${ICM_Alert1_stg_str_end}        \  with firmware version 3.00 v7.2.1_33 from baseline

${ICM_Alert1_stg_succ}           Staging success for the interconnect
${ICM_Alert1_stg_succ_end}       \  with firmware version 3.00 v7.2.1_33 from baseline

${ICM_Alert1_act_star}          Activation started for the interconnect
${ICM_Alert1_act_star_end}      \  with firmware version 3.00 v7.2.1_33 from baseline

${ICM_Alert1_act_succ}          Activation success for the interconnect
${ICM_Alert1_act_succ_end}      \  with firmware version 3.00 v7.2.1_33 from baseline

#1 4.40 2014-10-12T08:56:22Z    4.40 2014-10-12T08:56:22Z
${ICM_Alert1_stg_star_1_end}    \  with firmware version 4.40 2014-10-12T08:56:22Z from baseline

${ICM_Alert1_stg_star_2_end}    \  with firmware version 4.40 2014-10-12T08:27:55Z from baseline


#5 4.40 2014-10-12T08:27:55Z

@{LE_N_Alerts}=    ${LE_N_Alert1}
...                ${LE_N_Alert2}

@{LI_alerts}=    ${ICM_Alert1}
...              ${ICM_Alert2}
...              ${ICM_Alert3}
...              ${ICM_Alert4}

@{LI_u_vc_names}=    ${ICM_NAME3}

@{LI_vc_names}=    ${ICM_NAME5}
...             ${ICM_NAME6}

@{LI_names}=    ${ICM_NAME1}
...             ${ICM_NAME2}
...             ${ICM_NAME4}

${Resource_Filter}                  /rest/interconnects/c6790660-4112-45a5-9bcb-c31e9c02197e
${Last_AlertID}            0
${Starting_AlertID}        1
#SGH420HHYA, interconnect 7

${firmwareVersion_exp}           0.60
${li}                         SGH420HHYA-LIG_B1
${IP}                      192.168.144.132
${ExpectedErrorMsg1}=       Activate operation is not allowed at this state. One or more interconnects may not have been baselined to this firmware or all interconnects are already activated/activating to this baseline

@{LI_namesall}=    ${ICM_NAME1}
...             ${ICM_NAME2}
...             ${ICM_NAME3}
...             ${ICM_NAME4}
...             ${ICM_NAME5}
...             ${ICM_NAME6}


*** Test Cases ***

        ######  Importing Enclosure  #######################

TC01 Verify the FW Update operation (Stage + Activate) of hill module during LE creation using parallel mode with force flag
    [Documentation]     "3.1 : Verify the FW Update operation (Stage + Activate) of hill module during LE creation using parallel mode with force flag"
    Log to Console    Testcase_ID: TP section 3.1.2 API Test Cases F1212_TC_API_51 -->  Verify the FW Update operation (Stage + Activate) of hill module during LE creation using parallel mode with force flag

    [Tags]   Performance  LIG-condition-LIG_6ICM_2FCUS

    Fusion Api Login Appliance      ${APPLIANCE_IP}     ${admin_credentials}

    # Create FC Network1
    ${FCNW_ONE}=     Get Variable Value     ${fc_networks_NW1}
    Run Keyword If     ${FCNW_ONE} is not ${null}         Add FC Networks from variable      ${FCNW_ONE}
    Sleep   60
    # Create FC Network2
    ${FC_NETWORKTWO}=     Get Variable Value     ${fc_networks_NW2}
    Run Keyword If     ${FC_NETWORKTWO} is not ${null}        Add FC Networks from variable      ${FC_NETWORKTWO}
    Sleep    80

    ${body} =   Build LIG body      ${ligs['new_lig1']}
    ${resp} =   Fusion Api Create LIG   ${body}

    ${task} =   Wait For Task   ${resp}     80s   2s



TC02 Create EG
    [Tags]   Performance  Enclosure Group-condition-EG_6ICM_3US
    Add Enclosure Group from variable       ${enc_group}

TC03 Create enclosure using Created EG
    [Tags]   Performance  Enclosure-condition-SE_6ICM_1S
    Add Enclosures from variable   ${encs}
#   BBAdd Enclosures from variable   ${encsbb_new_parm}
    Fusion Api Logout Appliance
    
TC04 Create Server Profile

	Fusion Api Login Appliance     ${APPLIANCE_IP}     ${admin_credentials}
	
	Power off ALL servers
	#${server_profiles} =    Get Variable Value    ${server_profiles_2FC_Data_SP}
	Run Keyword If    ${server_profiles} is not ${null}     Add Server Profiles from variable     ${server_profiles_2FC_Data_SP}
	Fusion Api Logout Appliance
	
