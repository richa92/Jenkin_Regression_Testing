*** Settings ***
Documentation     
...    Covers the following testcase:
...              :3.5.5.14  Different LIG where Network Set already exists
...    Note: Update the Uplink ports X*, fabric ports, EG, LIG name when the test is moved into production environment
Library           RoboGalaxyLibrary
Library           FusionLibrary
Library           ../lib/WPSTUtil.py

Variables                       ../resources/defaults.py
Variables                       ../resources/credentials_wpst.py   Austin4
Force Tags                      Austin4
Resource                        ../resources/keywords.txt
Resource                        ../resources/keywords_ovcli.txt
Suite Setup                     Suite Setup Tasks
Test Setup                      Test Setup Tasks

*** Variables ***
${vc_config_file_1}     config/NetworkSet-already-exists.txt
${vc_config_file_2}     config/NetworkSet-already-exists-mismatch.txt
@{ignoreL}              uuid
@{bayNumbers}           3   4

*** Test Cases ***
Create-OV-LIG--Test Compatibility
    [Documentation]     Cleaning the OV and VC, later importing a configuration file.
    CleanOV.CleanVC
    Import VC
    # Detect, reset and sleep to workaround QXCR1001467844: Utah module in No Comm state after import enclosure
    Check Interconnect In No Comm And Recover If Needed   ${bayNumbers}
    Config VC    ${vc_config_file_1}
    Report.Write.Compare

Create-OV-LIG--Migrate
    [Documentation]     Cleaning the OV and VC, later importing a configuration file.
    Migrate
    GetOVResources.Write.Compare

Migrate-against-DifferentLIG--Test Compatibility
    [Documentation]     Migrate against the different LIG. Migration will be success.
    ${OVAVersion}   ${OVXAPIVersion}   Get OneView Appliance And Api Versions
    ${response} =   Run Keyword If   ${OVAVersion} >= 300   Set LIG    LIG_2S1409P9XR_1   ROOT   name=LIG_USE12345XP
    ...                         ELSE   Set LIG    LIG_2S1409P9XR   ROOT   name=LIG_USE12345XP
    ${task} =   Wait For Task and Fail On Error  ${response}
    Remove All Server Profiles
    Remove All Enclosures
    Remove All Enclosure Groups
    Import VC
    # Detect, reset and sleep to workaround QXCR1001467844: Utah module in No Comm state after import enclosure
    Check Interconnect In No Comm And Recover If Needed   ${bayNumbers}
    Config VC    ${vc_config_file_1}
    Report.Write.Compare

Migrate-against-DifferentLIG--Migrate
    [Documentation]     Migrate against the different LIG. Migration will be success.
    Migrate
    GetOVResources.Write.Compare        ignoreList=${ignoreL}

Migrate-modified-networkset--Test Compatibility
    [Documentation]     Modifying the networkset using a different configuration file so that networkset mismatch should come.
    Remove All Server Profiles
    Remove All Enclosures
    Remove All Enclosure Groups
    ${OVAVersion}   ${OVXAPIVersion}   Get OneView Appliance And Api Versions
    ${response} =   Run Keyword If   ${OVAVersion} >= 300   Fusion Api Delete LIG       name=LIG_2S1409P9XR_1
    ...                         ELSE   Fusion Api Delete LIG       name=LIG_2S1409P9XR
    ${task} =   Wait For Task and Fail On Error  ${response}
    Import VC
    # Detect, reset and sleep to workaround QXCR1001467844: Utah module in No Comm state after import enclosure
    Check Interconnect In No Comm And Recover If Needed   ${bayNumbers}
    Config VC    ${vc_config_file_2}
    Report.Write.Compare

Migrate-modified-networkset--Migrate
    [Documentation]     Modifying the networkset using a different configuration file so that networkset mismatch should come.
    Migrate
    GetOVResources.Write.Compare        ignoreList=${ignoreL}

