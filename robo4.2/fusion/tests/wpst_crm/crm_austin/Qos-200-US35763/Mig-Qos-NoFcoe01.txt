*** Settings ***
Documentation     VC to OV Migration QoS  -- without FCoE
...               Covers the following test cases in ALM: 
...                 The following are under 4.1.4.1 Migrate to a new enclosure group (no existing LIG) in WPST F678 VCMigration2.0 Test Plan document:
...                   17437 - [1]QoS Configuration Type . Custom (without FCoE Lossless) . RealTime is selected (MaxShare=50), unusual supported classnames, mix value for Share-MaxShare
...                   17438 - [1]QoS Configuration Type . Custom (without FCoE Lossless) . RealTime is selected, all traffic classes are Enabled, different Classification for uplinks and downlinks
...                   17439 - [1]Verify error when migrating with capitalization uniqueness issue (Active configuraton)
...                   17476 - [1]Verify error when migrating with capitalization uniqueness issue (Inactive configuraton)
...
...                 The following are under 4.1.4.10 Migrate to an existing enclosure group (with existing LIG) in WPST F678 VCMigration2.0 Test Plan document:
...                   17443 - [1]QoS Configuration Type . Custom (without FCoE Lossless) . RealTime is selected (MaxShare=50), unusual supported classnames, mix value for Share-MaxShare (Active)
...                   17479 - [1]QoS Configuration Type . Custom (without FCoE Lossless) . RealTime is selected (MaxShare=50), unusual supported classnames, mix value for Share-MaxShare (Inactive)
...                   [NOTE: Also in Mig-Qos-Fcoe01.txt, Mig-Qos-PassThru01.txt] 17449 - [1]Verify error when Classification for downlinks setting is different between VC and the LIG (Active configuraton)
...                   [NOTE: Also in Mig-Qos-Fcoe01.txt, Mig-Qos-PassThru01.txt] 17480 - [1]Verify error when Classification for downlinks setting is different between VC and the LIG (Inactive configuraton)
...                   [NOTE: Also in Mig-Qos-Fcoe01.txt, Mig-Qos-PassThru01.txt] 17448 - [1]Verify error when Classification for uplinks setting is different between VC and the LIG (Active configuraton)
...                   [NOTE: Also in Mig-Qos-Fcoe01.txt, Mig-Qos-PassThru01.txt] 17481 - [1]Verify error when Classification for uplinks setting is different between VC and the LIG (Inactive configuraton)
...                   [NOTE: Also in Mig-Qos-Fcoe01.txt, Mig-Qos-PassThru01.txt] 17450 - [1]Verify error when Traffic Classes having different DOT1P mappings between VC and the LIG (Active configuraton)
...                   [NOTE: Also in Mig-Qos-Fcoe01.txt, Mig-Qos-PassThru01.txt] 17485 - [1]Verify error when Traffic Classes having different DOT1P mappings between VC and the LIG (Inactive configuraton)
...                   [NOTE: Also in Mig-Qos-Fcoe01.txt, Mig-Qos-PassThru01.txt] 17451 - [1]Verify error when Traffic Classes having different DSCP mappings between VC and the LIG (Active configuraton)
...                   [NOTE: Also in Mig-Qos-Fcoe01.txt, Mig-Qos-PassThru01.txt] 17486 - [1]Verify error when Traffic Classes having different DSCP mappings between VC and the LIG (Inactive configuraton)
...                   17454 - [1]Verify error when any non-qos fields from OV LIG editor window having different value compare to VC
...                   [NOTE: Also in Mig-Qos-Fcoe01.txt, Mig-Qos-PassThru01.txt] 17446 - [1]Verify error when one or more traffic classes are present in LIG but not in VC (Active configuraton)
...                   [NOTE: Also in Mig-Qos-Fcoe01.txt, Mig-Qos-PassThru01.txt] 17482 - [1]Verify error when one or more traffic classes are present in LIG but not in VC (Inactive configuraton)
...                   [NOTE: Also in Mig-Qos-Fcoe01.txt, Mig-Qos-PassThru01.txt] 17445 - [1]Verify error when one or more traffic classes are present in VC but not in the LIG (Active configuration)
...                   [NOTE: Also in Mig-Qos-Fcoe01.txt, Mig-Qos-PassThru01.txt] 17483 - [1]Verify error when one or more traffic classes are present in VC but not in the LIG (Inactive configuration)
...                   17444 - [1]Verify error when the QoS Configuration Type is different between VC and LIG
...                   [NOTE: Also in Mig-Qos-Fcoe01.txt, Mig-Qos-PassThru01.txt] 17447 - [1]Verify error when traffic class contains different attribute values between VC and the LIG (Active configuraton)
...                   [NOTE: Also in Mig-Qos-Fcoe01.txt, Mig-Qos-PassThru01.txt] 17484 - [1]Verify error when traffic class contains different attribute values between VC and the LIG (Inactive configuraton)
...
...               Note: Configuration for with FCoE Lossless is inactive, domain has no network and profile, non QoS LIG config

Library           RoboGalaxyLibrary
Library           FusionLibrary
Library           ../lib/WPSTUtil.py

Variables                       ../resources/defaults.py
Variables                       ../resources/credentials_wpst.py   Austin3
Force Tags                      OV200   QOS   Austin3

Resource                        ../resources/keywords.txt
Suite Setup                     Suite Setup Tasks
Suite Teardown                  Suite Teardown Tasks    ${grepDefaultString2}
Test Setup                      Test Setup Tasks

*** Variables ***
${vc_config_file1}     config/vc_austin3_Qos-NoFcoe01-NewLIG.txt
${vc_config_file2}     config/vc_austin3_Qos-NoFcoe01a-ExistingLIG.txt
${vc_config_file3}     config/vc_austin3_Qos-NoFcoe01b-ExistingLIG.txt
@{delResList}                   server-profiles   enclosures
@{ignoreL}          status


*** Test Cases ***
TC001--CleanOV
    [Tags]   CleanOV
    CleanOV

TC002--CleanVC
    [Tags]   CleanVC
    CleanVC

TC400--Config VC
    Import.ConfigVC    ${vc_config_file1}

TC401--Test report against new LIG
    Report.Write.Compare
    Set Suite Variable    ${DATA_RPT_401}   ${DATA_OV}

TC401--Migrate
    Migrate   runReport=${True}
    GetOVResources.Write.Compare       ignoreList=${ignoreL}

TC410--Reconfig VC
    Delete OneView Selected    ${delResList}
    Import.ConfigVC    ${vc_config_file2}

TC411a--Validate errorCode in detail report (active config is modified)
    ${validation_unmatch_qosTrafficClass}   Create Dictionary   errorCode=FAIL_TO_MATCH_QOS_TRAFFIC_CLASS_CONFIGURATION
    ...                                 level=Critical
    ...                                 key=qosTrafficClass
    ${validation_unmatch_qosDot1pMapping}   Create Dictionary   errorCode=FAIL_TO_MATCH_QOS_DOT1P_MAPPING
    ...                                 level=Critical
    ...                                 key=qosDot1pMapping
    ${validation_unmatch_qosDSCPMapping}   Create Dictionary   errorCode=FAIL_TO_MATCH_QOS_DSCP_MAPPING
    ...                                 level=Critical
    ...                                 key=qosDSCPMapping
    ${validation_unmatch_qosTrafficClassNotFound}   Create Dictionary   errorCode=FAIL_QOS_CLASS_DOES_NOT_EXIST
    ...                                 level=Critical
    ...                                 key=qosTrafficClassNotFound
    ${validation_unmatch_qosConfigurationType}   Create Dictionary   errorCode=FAIL_TO_MATCH_QOS_CONFIGURATION_TYPE
    ...                                 level=Critical
    ...                                 key=qosConfigurationType
    ${validation_unmatch_qos_traffic_class_case_sensitive_name}   Create Dictionary   errorCode=FEATURE_ISSUE_QOS_TRAFFIC_CLASS_CASE_SENSITIVE_NAME
    ...                                 level=Critical
    ...                                 key=qos_traffic_class_case_sensitive_name
    ${validation_configuration-not-match}   Create Dictionary   errorCode=UTILIZATION_SAMPLING
    ...                                 level=Critical
    ...                                 key=utilization_sampling_conflict
    ${validation_unmatch_qosClassificationTypeInactive}   Create Dictionary   errorCode=FAIL_TO_MATCH_QOS_CLASSIFICATION_TYPE_INACTIVE
    ...                                 level=High
    ...                                 key=qosClassificationTypeInactive
    Validate Detail Report with Existing EG If General Issues Exists       allMigrationIssues   EG_2S1320P2RW   errorCode
    ...                 ${validation_unmatch_qosTrafficClass}
    ...                 ${validation_unmatch_qosDot1pMapping}
    ...                 ${validation_unmatch_qosDSCPMapping}
    ...                 ${validation_unmatch_qosTrafficClassNotFound}
    ...                 ${validation_unmatch_qosConfigurationType}
    ...                 ${validation_unmatch_qos_traffic_class_case_sensitive_name}
    ...                 ${validation_unmatch_qosClassificationTypeInactive}
    ...                 ${validation_configuration-not-match}

TC411b--Compare compatiblity report (active config is modified)
    Report.Write.Compare      ${EMPTYLIST}  ${OAVC_CREDENTIALS}  ${EMPTYLIST}  ${True}   EG_2S1320P2RW

TC420--Reconfig VC
    Delete VC Domain
    Import.ConfigVC    ${vc_config_file3}

TC421--Validate errorCode in detail report (inactive config is modified)
    ${validation_unmatch_qosDot1pMappingInactive}   Create Dictionary   errorCode=FAIL_TO_MATCH_QOS_DOT1P_MAPPING_INACTIVE
    ...                                 level=High
    ...                                 key=qosDot1pMappingInactive
    ${validation_unmatch_qosDSCPMappingInactive}   Create Dictionary   errorCode=FAIL_TO_MATCH_QOS_DSCP_MAPPING_INACTIVE
    ...                                 level=High
    ...                                 key=qosDSCPMappingInactive
    Validate Detail Report with Existing EG If General Issues Exists       allMigrationIssues   EG_2S1320P2RW   errorCode
    ...                 ${validation_unmatch_qosDot1pMappingInactive}
    ...                 ${validation_unmatch_qosDSCPMappingInactive}

TC422--Test report against existing LIG
    Report.Write.Compare      ${EMPTYLIST}  ${OAVC_CREDENTIALS}  ${EMPTYLIST}  ${True}   EG_2S1320P2RW
    Set Suite Variable    ${DATA_RPT_422}   ${DATA_OV}

TC422--Migrate
    Migrate   runReport=${True}
    GetOVResources.Write.Compare       ignoreList=${ignoreL}

TC423--Verify modified inactive config not get into OV
    Compare All with Expected    ${DATA_RPT_401}   ${DATA_RPT_422}   ${ignoreL}
