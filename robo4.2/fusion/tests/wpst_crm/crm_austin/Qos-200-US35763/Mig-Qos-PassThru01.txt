*** Settings ***
Documentation     VC to OV Migration QoS  -- Pass Through
...               Covers the following test cases in ALM: 
...                 The following are under 4.1.4.1 Migrate to a new enclosure group (no existing LIG) in WPST F678 VCMigration2.0 Test Plan document:
...                   17433 - [1]QoS Configuration Type - Passthrough
...
...                 The following are under 4.1.4.10 Migrate to an existing enclosure group (with existing LIG) in WPST F678 VCMigration2.0 Test Plan document:
...                   17440 - [1]QoS Configuration Type . Passthrough (same QoS Configuration Type in VC and the LIG, and same qos configuration in both Inactive configurations - default setting)
...                   17453 - [1]QoS Configuration Type . Passthrough (same QoS Configuration Type in VC and the LIG, and same qos configuration in both Inactive configurations - user modified setting)
...                   [NOTE: Also in Mig-Qos-Fcoe01.txt, Mig-Qos-NoFcoe01.txt] 17445 - [1]Verify error when one or more traffic classes are present in VC but not in the LIG (Active configuration)
...                   [NOTE: Also in Mig-Qos-Fcoe01.txt, Mig-Qos-NoFcoe01.txt] 17483 - [1]Verify error when one or more traffic classes are present in VC but not in the LIG (Inactive configuration)
...                   [NOTE: Also in Mig-Qos-NoFcoe01.txt, Mig-Qos-Fcoe01.txt] 17446 - [1]Verify error when one or more traffic classes are present in LIG but not in VC (Active configuraton)
...                   [NOTE: Also in Mig-Qos-NoFcoe01.txt, Mig-Qos-Fcoe01.txt] 17482 - [1]Verify error when one or more traffic classes are present in LIG but not in VC (Inactive configuraton)
...                   [NOTE: Also in Mig-Qos-NoFcoe01.txt, Mig-Qos-Fcoe01.txt] 17447 - [1]Verify error when traffic class contains different attribute values between VC and the LIG (Active configuraton)
...                   [NOTE: Also in Mig-Qos-NoFcoe01.txt, Mig-Qos-Fcoe01.txt] 17484 - [1]Verify error when traffic class contains different attribute values between VC and the LIG (Inactive configuraton)
...                   [NOTE: Also in Mig-Qos-Fcoe01.txt, Mig-Qos-NoFcoe01.txt] 17448 - [1]Verify error when Classification for uplinks setting is different between VC and the LIG (Active configuraton)
...                   [NOTE: Also in Mig-Qos-Fcoe01.txt, Mig-Qos-NoFcoe01.txt] 17481 - [1]Verify error when Classification for uplinks setting is different between VC and the LIG (Inactive configuraton)
...                   [NOTE: Also in Mig-Qos-Fcoe01.txt, Mig-Qos-NoFcoe01.txt] 17449 - [1]Verify error when Classification for downlinks setting is different between VC and the LIG (Active configuraton)
...                   [NOTE: Also in Mig-Qos-Fcoe01.txt, Mig-Qos-NoFcoe01.txt] 17480 - [1]Verify error when Classification for downlinks setting is different between VC and the LIG (Inactive configuraton)
...                   [NOTE: Also in Mig-Qos-NoFcoe01.txt, Mig-Qos-Fcoe01.txt] 17450 - [1]Verify error when Traffic Classes having different DOT1P mappings between VC and the LIG (Active configuraton)
...                   [NOTE: Also in Mig-Qos-NoFcoe01.txt, Mig-Qos-Fcoe01.txt] 17485 - [1]Verify error when Traffic Classes having different DOT1P mappings between VC and the LIG (Inactive configuraton)
...                   [NOTE: Also in Mig-Qos-Fcoe01.txt, Mig-Qos-NoFcoe01.txt] 17451 - [1]Verify error when Traffic Classes having different DSCP mappings between VC and the LIG (Active configuraton)
...                   [NOTE: Also in Mig-Qos-Fcoe01.txt, Mig-Qos-NoFcoe01.txt] 17486 - [1]Verify error when Traffic Classes having different DSCP mappings between VC and the LIG (Inactive configuraton)
...
...                 Note: Configurations for without FCoE and with FCoE are inactive, domain has network and profile,
...                 Note: Configuration for with FCoE Lossless and without FCoE Lossless are inactive

Library           RoboGalaxyLibrary
Library           FusionLibrary
Library           ../lib/WPSTUtil.py

Variables                       ../resources/defaults.py
Variables                       ../resources/credentials_wpst.py   Austin3
Force Tags                      OV200   QOS   Austin3

Resource                        ../resources/keywords.txt
Suite Setup                     Suite Setup Tasks
Suite Teardown                  Suite Teardown Tasks    ${grepDefaultString2}
Test Setup                      Test Setup Tasks

*** Variables ***
${vc_config_file1}     config/vc_austin3_Qos-PassThru01-NewLIG.txt
${vc_config_file2}     config/vc_austin3_Qos-PassThru01-ExistingLIG.txt
@{delResList}                   server-profiles   enclosures
@{ignoreL}          status
${dataRpt201}    data-Mig-Qos-PassThru01-TC201-api200.json
${dataRpt212}    data-Mig-Qos-PassThru01-TC212-api200.json

*** Test Cases ***
TC001--CleanOV
    [Tags]   CleanOV
    CleanOV

TC002--CleanVC
    [Tags]   CleanVC
    CleanVC

TC200--Config VC
    Import.ConfigVC    ${vc_config_file1}

TC201--Test report against new LIG and migrate Test Compatibility
    Report.Write.Compare

TC201--Test report against new LIG and migrate Migrate
    Migrate   runReport=${True}
    GetOVResources.Write.Compare    ignoreList=${ignoreL}

TC210--Reconfig VC
    Delete OneView Selected    ${delResList}
    Import.ConfigVC    ${vc_config_file2}

TC211--Validate errorCode in detail report (inactive config is modified)
    [Tags]    API200
    ${validation_unmatch_qosTrafficClassInactive}   Create Dictionary   errorCode=FAIL_TO_MATCH_QOS_TRAFFIC_CLASS_CONFIGURATION_INACTIVE
    ...                                 level=High
    ...                                 key=qosTrafficClassInactive
    ${validation_unmatch_qosClassificationTypeInactive}   Create Dictionary   errorCode=FAIL_TO_MATCH_QOS_CLASSIFICATION_TYPE_INACTIVE
    ...                                 level=High
    ...                                 key=qosClassificationTypeInactive
    ${validation_unmatch_qosDot1pMappingInactive}   Create Dictionary   errorCode=FAIL_TO_MATCH_QOS_DOT1P_MAPPING_INACTIVE
    ...                                 level=High
    ...                                 key=qosDot1pMappingInactive
    ${validation_unmatch_qosDSCPMappingInactive}   Create Dictionary   errorCode=FAIL_TO_MATCH_QOS_DSCP_MAPPING_INACTIVE
    ...                                 level=High
    ...                                 key=qosDSCPMappingInactive
    Validate Detail Report with Existing EG If General Issues Exists       allMigrationIssues   EG_2S1320P2RW   errorCode
    ...                 ${validation_unmatch_qosTrafficClassInactive}
    ...                 ${validation_unmatch_qosClassificationTypeInactive}
    ...                 ${validation_unmatch_qosDot1pMappingInactive}
    ...                 ${validation_unmatch_qosDSCPMappingInactive}

TC212--Test Compatibility against existing LIG
    Report.Write.Compare      ${EMPTYLIST}  ${OAVC_CREDENTIALS}  ${EMPTYLIST}  ${True}   EG_2S1320P2RW

TC212--Migrate to an existin LIG
    Migrate   runReport=${True}
    GetOVResources.Write.Compare    ignoreList=${ignoreL}

TC213--Verify modified inactive config not get into OV
    Compare All with Expected    ${dataRpt201}   ${dataRpt212}   ${ignoreL}
