*** Settings ***
Documentation     This testsuite is intended to commonize applicable blocking ALM's Limitations Testcases.
...               = Usage =
...               cmdline: pybot -d ../logs  --timestampoutputs -t <target test case> <target test file>
...               This test suite covers the following testcases in ALM:
...                 [1]3.4.2 Profile Connections - Network Not Assigned
...                 3.4.11 Profile Connections - Unmapped
...                 [1]3.4.3 Profile unassigned

Library               RoboGalaxyLibrary
Library               FusionLibrary
Library               ../lib/WPSTUtil.py

Variables             ../resources/defaults.py
Variables             ../resources/credentials_wpst.py   Austin4
Force Tags            Austin4

Resource              ../resources/keywords.txt

Suite Setup                     Suite Setup Tasks
Test Setup                      Test Setup Tasks

*** Variables ***
${profileScenarios}   config/vc_austin4_profile_scenarios.txt
@{bayNumbers}         3   4

*** Test Cases ***
TC0
    [Tags]   CleanOV.CleanVC
    CleanOV
    CleanVC

TC1-Profile-Scenarios--Connection network not assigned, unmapped connection, and profile unassigned. Test Compatibility
    [Documentation]    3.4.2 Profile downlink connections with unassigned network are not supported.
    ...                Expected result: Migration Manager should report a high issue.
    ...
    ...                3.4.11 Profile downlink connections which are unmapped (there are currently more profile connections than available 
    ...                physical ports and physical functions) should be migrated without error.
    ...                Expected result: Migration Manager reporting a high severity issue.
    ...
    ...                3.4.3 The Migration manager will ignore a profile not assigned to a bay.
    ...                Expected result: Migration Manager reporting a high severity issue.
    ...
    ...                All these to be verified for all connection types: Ethernet, FCoE, FC

    # Import and configure VC from config_file
    Import VC
    # Detect, reset and sleep to workaround QXCR1001467844: Utah module in No Comm state after import enclosure
    Check Interconnect In No Comm And Recover If Needed   ${bayNumbers}
    Config VC     ${profileScenarios}
    Set Test Variable   ${IsCompare}   ${True}
    # Generate Compatibility report; write to Json file and compare with saved Json file
    Report.Write.Compare

TC1-Profile-Scenarios--Connection network not assigned, unmapped connection, and profile unassigned. Migrate to OneView
    [Documentation]    3.4.2 Profile downlink connections with unassigned network are not supported.
    ...                Expected result: Migration Manager should report a high issue.
    ...
    ...                3.4.11 Profile downlink connections which are unmapped (there are currently more profile connections than available 
    ...                physical ports and physical functions) should be migrated without error.
    ...                Expected result: Migration Manager reporting a high severity issue.
    ...
    ...                3.4.3 The Migration manager will ignore a profile not assigned to a bay.
    ...                Expected result: Migration Manager reporting a high severity issue.
    ...
    ...                All these to be verified for all connection types: Ethernet, FCoE, FC

    # Migrate into OV; get all resources in OV; write to Json file and compare with saved Json file
    Migrate
    GetOVResources.Write.Compare
