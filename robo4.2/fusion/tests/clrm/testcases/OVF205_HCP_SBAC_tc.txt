*** Settings ***
Documentation   SBAC tests for Hypervisor Cluster Profile
Library         FusionLibrary
Library         RoboGalaxyLibrary
Library         OperatingSystem
Library         BuiltIn
Library         Collections
Library         XML
Library         String
Library         json
Library         Process

Resource                        ../../../Resources/api/fusion_api_resource.txt
Resource                        ../support_files/clrm_common.txt
Variables                       ../data_variables_files/OVF204_OVF205_OVF206_SBAC_data_variables.py
Suite Setup                     Setup environment
#Suite Teardown                  Teardown environment

Test Template         Hypervisor Cluster Profile SBAC Operations

*** Variables ***

${Appliance_IP}     15.212.173.4

*** Test Cases ***              Role                                    Scope               Operation       Status          errorCode   Data_for_HCP_create         Data_for_HCP_update
OVTC74436                       Infrastructure administrator            None                Create          True            ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74437                       Infrastructure administrator            None                Get             True            ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74438                       Infrastructure administrator            None                Update          True            ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74439                       Infrastructure administrator            None                Delete          True            ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74440                       Infrastructure administrator            Scope1              Create          False           ${CFS}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74441                       Infrastructure administrator            Scope1              Get             True            ${CFS}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74442                       Infrastructure administrator            Scope1              Update          False           ${CFS}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74443                       Infrastructure administrator            Scope1              Delete          False           ${CFS}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74444                       Read only                               None                Create          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74445                       Read only                               None                Get             True            ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74446                       Read only                               None                Update          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74447                       Read only                               None                Delete          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74448                       Read only                               Scope1              Create          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74449                       Read only                               Scope1              Get             True            ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74450                       Read only                               Scope1              Update          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74451                       Read only                               Scope1              Delete          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74452                       Backup administrator                    None                Create          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74453                       Backup administrator                    None                Get             True            ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74454                       Backup administrator                    None                Update          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74455                       Backup administrator                    None                Delete          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74456                       Backup administrator                    Scope1              Create          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74457                       Backup administrator                    Scope1              Get             True            ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74458                       Backup administrator                    Scope1              Update          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74459                       Backup administrator                    Scope1              Delete          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74460                       Network administrator                   None                Create          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74461                       Network administrator                   None                Get             True            ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74462                       Network administrator                   None                Update          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74463                       Network administrator                   None                Delete          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74464                       Network administrator                   Scope1              Create          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74465                       Network administrator                   Scope1              Get             True            ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74466                       Network administrator                   Scope1              Update          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74467                       Network administrator                   Scope1              Delete          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74468                       Scope administrator                     None                Create          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74469                       Scope administrator                     None                Get             True            ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74470                       Scope administrator                     None                Update          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74471                       Scope administrator                     None                Delete          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74472                       Scope administrator                     Scope1              Create          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74473                       Scope administrator                     Scope1              Get             True            ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74474                       Scope administrator                     Scope1              Update          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74475                       Scope administrator                     Scope1              Delete          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74476                       Scope operator                          None                Create          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74477                       Scope operator                          None                Get             True            ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74478                       Scope operator                          None                Update          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74479                       Scope operator                          None                Delete          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74480                       Scope operator                          Scope1              Create          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74481                       Scope operator                          Scope1              Get             True            ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74482                       Scope operator                          Scope1              Update          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74483                       Scope operator                          Scope1              Delete          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74484                       Server administrator                    None                Create          True            ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74485                       Server administrator                    None                Get             True            ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74486                       Server administrator                    None                Update          True            ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74487                       Server administrator                    None                Delete          True            ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74488                       Server administrator                    Scope1              Create          False           ${CFS}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74489                       Server administrator                    Scope1              Get             True            ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74490                       Server administrator                    Scope1              Update          False           ${CFS}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74491                       Server administrator                    Scope1              Delete          False           ${CFS}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74492                       Server firmware operator                None                Create          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74493                       Server firmware operator                None                Get             True            ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74494                       Server firmware operator                None                Update          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74495                       Server firmware operator                None                Delete          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74496                       Server firmware operator                Scope1              Create          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74497                       Server firmware operator                Scope1              Get             True            ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74498                       Server firmware operator                Scope1              Update          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74499                       Server firmware operator                Scope1              Delete          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74500                       Server profile administrator            None                Create          True            ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74501                       Server profile administrator            None                Get             True            ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74502                       Server profile administrator            None                Update          True            ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74503                       Server profile administrator            None                Delete          True            ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74504                       Server profile administrator            Scope1              Create          False           ${CFS}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74505                       Server profile administrator            Scope1              Get             True            ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74506                       Server profile administrator            Scope1              Update          False           ${CFS}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74507                       Server profile administrator            Scope1              Delete          False           ${CFS}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74508                       Server profile architect                None                Create          True            ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74509                       Server profile architect                None                Get             True            ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74510                       Server profile architect                None                Update          True            ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74511                       Server profile architect                None                Delete          True            ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74512                       Server profile architect                Scope1              Create          False           ${CFS}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74513                       Server profile architect                Scope1              Get             True            ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74514                       Server profile architect                Scope1              Update          False           ${CFS}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74515                       Server profile architect                Scope1              Delete          False           ${CFS}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74516                       Server profile operator                 None                Create          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74517                       Server profile operator                 None                Get             True            ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74518                       Server profile operator                 None                Update          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74519                       Server profile operator                 None                Delete          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74520                       Server profile operator                 Scope1              Create          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74521                       Server profile operator                 Scope1              Get             True            ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74522                       Server profile operator                 Scope1              Update          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74523                       Server profile operator                 Scope1              Delete          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74524                       Software administrator                  None                Create          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74525                       Software administrator                  None                Get             True            ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74526                       Software administrator                  None                Update          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74527                       Software administrator                  None                Delete          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74528                       Software administrator                  Scope1              Create          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74529                       Software administrator                  Scope1              Get             True            ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74530                       Software administrator                  Scope1              Update          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74531                       Software administrator                  Scope1              Delete          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74532                       Storage administrator                   None                Create          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74533                       Storage administrator                   None                Get             True            ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74534                       Storage administrator                   None                Update          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74535                       Storage administrator                   None                Delete          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74536                       Storage administrator                   Scope1              Create          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74537                       Storage administrator                   Scope1              Get             True            ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74538                       Storage administrator                   Scope1              Update          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}
OVTC74539                       Storage administrator                   Scope1              Delete          False           ${AFR}      ${SBAC_Cluster_1}           ${SBAC_Cluster_1_Update}


*** Keywords ***
Hypervisor Cluster Profile SBAC Operations
    [Documentation]     Hypervisor Cluster Profile SBAC Operations
    [Arguments]    ${Role}  ${Scope}    ${Operation}    ${Status}   ${errorCode}    ${Data_for_HCP_create}  ${Data_for_HCP_update}
    Fusion Api Login Appliance      ${Appliance_IP}     ${admin_credentials}
    ${body}     Build body for user update  ${Role}     ${Scope}        ${User1_credentials['userName']}
    ${result}   ${task}=    Update Users    ${body}
    Fusion Api Logout Appliance
    Log to console      Test SBAC for user with role : ${Role} and scope : ${Scope}
    Run Keyword If      '${Operation}' == 'Create'      HCP Creation    ${Data_for_HCP_create}  ${Status}   ${errorCode}
    ...     ELSE IF     '${Operation}' == 'Get'         HCP Get     ${Data_for_HCP_create}  ${Status}   ${errorCode}
    ...     ELSE IF     '${Operation}' == 'Update'      HCP Update  ${Data_for_HCP_update}  ${Status}   ${errorCode}
    ...     ELSE IF     '${Operation}' == 'Delete'      HCP Delete  ${Data_for_HCP_create}  ${Status}   ${errorCode}
    ...     ELSE        Log to console      "Operation is not specified"

HCP Creation
    [Documentation]     Create hypervisor-cluster-profile
    [Arguments]     ${Data_for_HCP_create}  ${status}   ${errorCode}
    Fusion Api Login Appliance      ${Appliance_IP}     ${User1_credentials}
    ${errorCode_status}     Set variable    True
    ${resp}=    Add Cluster Profile     ${Data_for_HCP_create}
    ${errorCode_status} Run keyword if  ${resp[0]['status']} != ${status}   Set variable    False
    ${err}  Run keyword and return status   Dictionary Should Contain Key   ${resp[0]['rest_resp']}     errorCode
    ${compare_status}   Run keyword if  ${err}==True    Run keyword if  ${resp[0]['status']} != ${status}   Compare Error Code Message  ${errorCode}    ${resp[0]['rest_resp']['errorCode']}
    Run keyword if  ${errorCode_status} == False and '${compare_status}' == 'False' FAIL    HCP Creation failed for ${User1_credentials['userName']}:(${resp[0]['rest_resp']['errorCode']}, ${resp[0]['rest_resp']['status_code']}) and it was expected to fail with ${errorCode} error code
    Run keyword if  ${errorCode_status} == False and '${resp[0]['task_status']}' != 'False' FAIL    HCP Creation failed for ${User1_credentials['userName']}:(${resp[0]['rest_resp']['errorCode']}, ${resp[0]['rest_resp']['status_code']})
    Run keyword if  '${errorCode_status}' == 'None' and '${resp[0]['task_status']}' == 'False'  FAIL    HCP Creation failed for ${User1_credentials['userName']}
    Log to Console and log file     SBAC for HCP Creation is successful for '${User1_credentials['userName']}'
    Fusion Api Logout Appliance

HCP Get
    [Documentation]     GET hypervisor-cluster-profile-profile
    [Arguments]     ${data} ${status}   ${errorCode}
    Fusion Api Login Appliance      ${Appliance_IP}     ${User1_credentials}
    ${resp} ${count}=   Get Cluster Profile     ${data[0]['name']}
    Log to console  ${resp}
    Run Keyword If  ${count} != 0   Run keyword if  '${resp['status']}' != 'OK'    Run keyword if   '${resp['status']}' != 'Warning'    FAIL    SBAC for HCP GET Failed for '${User1_credentials['userName']}'
    Log to Console and log file     SBAC for HCP GET is successful for '${User1_credentials['userName']}'
    Fusion Api Logout Appliance

HCP Update
    [Documentation]    PUT on hypervisor-cluster-profile
    [Arguments]     ${data}         ${status}   ${errorCode}
    Sleep   2 seconds
    Fusion Api Login Appliance      ${Appliance_IP}     ${User1_credentials}
    ${errorCode_status}     Set variable    True
    ${resp}=    Update Cluster Profile      ${data}
    Log to console  ${resp}
    ${length} =  Get Length  ${resp}
    ${errorCode_status} Run Keyword If  ${length} != 0  Run keyword if  ${resp[0]['status']} != ${status}   Set variable    False
    ${compare_status}   Run Keyword If  ${length} != 0  Run keyword if  ${resp[0]['status']} != ${status}   Compare Error Code Message  ${errorCode}    ${resp[0]['rest_resp']['errorCode']}
    Run Keyword If  ${length} != 0  Run keyword if  ${errorCode_status} == False and ${compare_status} == False     FAIL    HCP Update failed for ${User1_credentials['userName']}:(${resp[0]['rest_resp']['errorCode']}, ${resp[0]['rest_resp']['status_code']}) and it was expected to fail with ${errorCode} error code
    Run Keyword If  ${length} != 0  Run keyword if  ${errorCode_status} == False    FAIL    HCP Update failed for ${User1_credentials['userName']}:(${resp[0]['rest_resp']['errorCode']}, ${resp[0]['rest_resp']['status_code']})
    Log to Console and log file     SBAC for HCP Update is successful for '${User1_credentials['userName']}'
    Fusion Api Logout Appliance

HCP Delete
    [Documentation]     DELETE hypervisor-cluster-profile
    [Arguments]     ${data}         ${status}   ${errorCode}
    Fusion Api Login Appliance      ${Appliance_IP}     ${User1_credentials}
    ${errorCode_status}     Set variable    True
    ${cp}    Create list
    Append to list    ${cp}    ${data[0]}
    ${resp}=    Delete cluster profile      ${cp}   True
    Log to console  ${resp}
    ${length} =  Get Length  ${resp}
    ${err}  Run Keyword If  ${length} != 0  Run keyword and return status   Dictionary Should Contain Key   ${resp[0]['rest_resp']}     errorCode
    ${errorCode_status} Run Keyword If  ${length} != 0  Run keyword if  ${resp[0]['status']} != ${status}   Set variable    False
    ${compare_status}   Run Keyword If  ${length} != 0  Run keyword if  ${err}==True    Run keyword if  ${errorCode_status} == False    Compare Error Code Message  ${errorCode}    ${resp[0]['rest_resp']['errorCode']}
    Run Keyword If  ${length} != 0  Run keyword if  ${errorCode_status} == False    Run keyword if  ${err}==True    Run keyword if  ${compare_status} == False  FAIL    HCP Delete failed for ${User1_credentials['userName']}:(${resp[0]['rest_resp']['errorCode']}, ${resp[0]['rest_resp']['status_code']})
    Run Keyword If  ${length} != 0  Run keyword if  ${errorCode_status} == False    Run keyword if  ${err}==True    FAIL    HCP Delete failed for ${User1_credentials['userName']}:(${resp[0]['rest_resp']['errorCode']}, ${resp[0]['rest_resp']['status_code']})
    Run Keyword If  ${length} != 0  Run keyword if  ${errorCode_status} == False    FAIL    HCP Delete failed for ${User1_credentials['userName']}
    Log to Console and log file     SBAC for HCP Delete is successful for '${User1_credentials['userName']}'
    Fusion Api Logout Appliance

Setup Environment
    [Documentation]     Setup Environment for Hypervisor Cluster Profile SBAC tests
    Fusion Api Login Appliance  ${Appliance_IP}     ${admin_credentials}
    Add Users from variable     ${users}
    :FOR    ${scope}    in  @{scopes}
    \   ${resp} =   Fusion Api Create Scope     ${scope}
    \   Run Keyword If  '${resp['status_code']}' != '202'   Fail    ${resp}    ELSE  log to console  \n-${scope['name']} : Scope Created successfully!
    Add Ethernet Networks from variable     ${ethernet_networks}
    Add LIG from variable       ${ligs}
    Add Enclosure Group from variable       ${enc_groups}
    Add Enclosures from variable        ${enclosures}
    Add Non Existing Server Profile Templates           ${server_profile_templates}
    Create ID Pools IPV4 Subnet         ${ipv4_subnet}
    :FOR    ${sub_assc} in  @{subnet_association}
    \   Edit network        ${sub_assc}
    ${result}   Add Hypervisor Manager  ${SBAC_HM_1}
    Run keyword if  '${result[0]['status']}' != 'True'  Run keyword if  '${result[0]['task_status']}' != 'True'     FAIL    Hypervisor Manager registration failed
    Add Deployment Manager  ${deployment_managers}  False
    Fusion Api Logout Appliance

Teardown environment
    [Documentation]     Teardown Environment for Hypervisor Cluster Profile SBAC tests
    Fusion Api Login Appliance  ${Appliance_IP}     ${admin_credentials}
    Remove All Users
    Fusion Api Logout Appliance
