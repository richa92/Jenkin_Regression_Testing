*** Settings ***
Documentation     Add a TBird enclosure using the Fusion TBird API.
...    = USAGE =
...    | pybot | -v FUSION_IP:tbird-OneView.rsn.hp.com | add_tbird_enclosure.txt |
...    = Variables =
...    | FUSION_IP | Required. IP address or hostname of the Fusion 2.0 appliance. |
...    | EM_IP | Optional. IP address or hostname of the Enclosure Manager to which the enclosure belongs.  Default value is for DCS. |

Force Tags          DCS     HW              # Force tags on all test cases

Library           RoboGalaxyLibrary            # DVTs Robot Framework extensions
Library           FusionLibrary                # DVTs Robot Framework extensions
Variables	  ../resources/variables.py    ${ENCLOSURE}
Resource          ../resources/defaults.txt
Resource          ../resources/fusion_api.txt
Suite Setup       Login to Fusion Via REST
Suite Teardown    Logout of Fusion Via REST


*** Variables ***


*** Test Cases ***
Add Tbird Enclosure
    Fusion Api TBird Add Enclosure    ""   200
    # Wait for OneView to add
    Log		Wait for OneView to add...	console=yes
    Sleep 	60
    ${Response}=      Fusion Api Get Enclosures
    ${Enclosures}=    Get From Dictionary	${Response}	members
    ${Enclosure}=	     Get From List	${Enclosures}      0
    Set Suite Variable	     ${Enclosure}

Verify Enclosure Managers
    Verify Enclosure Elements	managers	2

Verify CI ManagersBays
    Verify Enclosure Elements	ciManagerBays	2

Verify PowerBays
    Verify Enclosure Elements	powerSupplyBays		6

Verify FanBays
    Verify Enclosure Elements	fanBays		10

*** Keywords ***

Verify Enclosure Elements
    [Arguments]	      ${el_name}            ${length}
    ${elements}=	      Get From Dictionary   ${Enclosure}       ${el_name}
    Length Should Be  ${elements}	    ${length}
    
