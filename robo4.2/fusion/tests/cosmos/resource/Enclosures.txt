*** Settings ***

Library           RoboGalaxyLibrary

Resource          resource.txt


*** Keywords ***

Add Enclosure By Name
	[Arguments]    ${Enclname}
	${Encl} =  Get data by property  ${TestData.enclosures}  name  ${Enclname}
	Fusion UI add enclosure   ${Encl[0]}
	
Validate Enclosure LIG By Enclosure Name
	[Arguments]    ${Enclname}
	${Encl} =  Get data by property  ${TestData.enclosures}  name  ${Enclname}
	${value} =	Fusion UI Validate Enclosure LIG		${Encl[0]}
	Run Keyword If 	'${value}' == 'True'	Log 	Enclosure is configured with the expected LIG
	Run Keyword Unless 	'${value}' == 'True' 	Fail  	Failed to configure Enclosure with the expected LIG
	
Get Power Supply Attribute From Overview Page
	[Documentation]		Retrieve the POWER SUPPLY attribute from UI Overivew Page
	...
	...					`Note`: pass the attribute argument ( below are the valid attribute types ... passing "All" will return a dictionary of all attributes) 
	...
	... 				`Supported Attributes`:	Status, Model, Name
	...
	...					Examples: 
	...
	...							|	${result}=	|	Get Power Supply Attribute From Overview Page	|	Encl1	|	5	|	Status	|
	...
	...							|	${result}=	|	Get Power Supply Attribute From Overview Page	|	Encl1	|	5	|	Model	|
	
	
	[Arguments]	${ENC_NAME}	${BAY NO}	${ATTRIBUTE}
	[Return]	${status}
	
   	${status}=	Fusion UI Get Power Supply Attribute	${ENC_NAME}		overview	${BAY NO}	${ATTRIBUTE}
   	LOG 	${status}
 
 Get Power Supply Attribute From Mouseover
	[Documentation]		Retrieve the POWER SUPPLY attribute from UI Overivew Page Mouseover
	...
	...					`Note`: pass the attribute argument ( below are the valid attribute types ... passing "All" will return a dictionary of all attributes) 
	...
	... 				`Supported Attributes`:	Status, Model, Name
	...
	...					Examples: 
	...
	...							|	${result}=	|	Get Power Supply Attribute From Mouseover	|	Encl1	|	5	|	Status	|
	...
	...							|	${result}=	|	Get Power Supply Attribute From Mouseover	|	Encl1	|	5	|	Model	|
	
	[Arguments]	${ENC_NAME}	${BAY NO}	${ATTRIBUTE}
	[Return]	${status} 	
	
	${ps_dict}=	Fusion UI Get Powersupply Data From Mouseover	${ENC_NAME}		${BAY NO}
	${status}=	Run Keyword If	'${ATTRIBUTE}' == 'All'	Set Variable	${ps_dict}
   	...		ELSE	Get From Dictionary 	${ps_dict}	${ATTRIBUTE}
	LOG 	${status}
	  	
 
 Get Power Supply Attribute From Details Page
	[Documentation]		Retrieve the POWER SUPPLY attribute from UI Details Page
	...
	...					`Note`: pass the attribute argument ( below are the valid attribute types ... passing "All" will return a dictionary of all attributes) 
	...
	... 				`Supported Attributes`:	Status, Bay, Model, Serial Number, Part Number, Spare Part Number, All 
	...
	...					Examples: 
	...
	...							|	${result}=	|	Get Power Supply Attribute From Details Page	|	Encl1	|	5	|	Status	|
	...
	...							|	${result}=	|	Get Power Supply Attribute From Details Page	|	Encl1	|	5	|	Model	|
	
	[Arguments]	${ENC_NAME}	${BAY NO}	${ATTRIBUTE}
	[Return]	${status}
	
   	${status}=	Fusion UI Get Power Supply Attribute	${ENC_NAME}		details		${BAY NO}	${ATTRIBUTE}
   	LOG 	${status}
  	
 Get Power Supply Count From UI
 	[Documentation]		Retrieve the number of power supply filtered by argument type
 	...
   	...					`Note`: pass the type argument( below are the possible types) 
   	...
	... 				`Supported Types`:	all, failed, not present, present, ok, degraded, unknown
	...
	...					`Returned data will be a list with the 1st item being the count and then a list of PS bay numbers`
	...
	...					Examples: 
	...
	...							|	${count}=	|	Get Power Supply Count From UI	|	Encl1	|	all	|
	...
	...							|	${count}=	|	Get Power Supply Count From UI	|	Encl1	|	present	|
	
	[Arguments]	${ENC_NAME}	${TYPE}
	[Return]	${count}
	${ps_dict}=		Fusion UI Get Power Supply Details	${ENC_NAME}
	${count}=		Fusion UI Get Power Supply Count	${ps_dict}	${TYPE}
	LOG		${count}
	

VERIFY THE FAN DETAILS FROM OVERVIEW AND DETAILS	
    [Documentation]    This keywords compare the inventory details received from Details page and overview page 
    ...                Example:
    ...                        |    ${result}=    |    VERIFY THE FAN DETAILS FROM OVERVIEW AND DETAILS    ${ui_inventory_details}     ${ui_overview_details}    |
    ...                        |    ${result}=    |    GET FAN COUNT FROM OA    present    |                      
    [Arguments]    ${ui_inventory_details}    ${ui_overview_details}
    ${ui_list}=    Create List    Status    Model    State
    ${list_length}=    Get Length    ${ui_list}
    :FOR    ${INDEX}    IN RANGE    ${list_length}
    \    ${oa_property}=    Get From Dictionary    ${ui_inventory_details}    @{ui_list}[${INDEX}]
    \    ${ui_property}=    Get From Dictionary    ${ui_overview_details}    @{ui_list}[${INDEX}]
    \    Should be equal    ${oa_property}    ${ui_property}

GET FAN COUNT FROM UI
    [Documentation]    Retrieve the number of fan filtered by argument type
    ...
    ...                Note: pass the type argument in lower case(below are the possible types)	
    ...
    ...                all,failed,ok,degraded,missing,misplaced
    ...
    ...                Return data will be a list with the 1st item being the count and then a list of fan bay number
    ...
    ...                Example : 
    ...                        |    ${result}=    |    GET FAN COUNT FROM UI    all    |
    ...                        |    ${result}=    |    GET FAN COUNT FROM UI    present    |
     
    [Arguments]    ${type}	
    [Return]    ${count}
    ${fan_inf}=    Fusion UI Get Fan Overview
    ${count}=    Fusion UI Get Fan Count    ${fan_inf}    ${type}
    LOG    ${count}

VALIDATE FAN STATUS IN DETAILS PAGE AFTER REMOVE AND INSERT 
    [Documentation]    To validate the Fan status in details page after removing and inserting fan
    ...
    ...                Example:
    ...                       |    ${result}=    |    VALIDATE FAN STATUS IN DETAILS PAGE AFTER REMOVE AND INSERT    [1,3]    [8,1,2,4,5,6,7,9,10]    |
    ...                       |    ${result}=    |    VALIDATE FAN STATUS IN DETAILS PAGE AFTER REMOVE AND INSERT    [3]    [6,3,4,5,8,9,10]    |
    [Arguments]    ${bay_list}    ${fan_rule_list}
    ${present_list_length}=    Get Length    ${bay_list}
    :FOR    ${bay_num}    IN    @{bay_list}
    \    REMOVE THE FAN FROM C7000    ${bay_num}
    \    sleep    30    #Explicit wait time provided after removal of Fan
    \    ${oa_inventory_details}=    GET FAN STATUS FROM OA    ${bay_num}    all
    \    ${oa_converted_details}=    tbird convert oa fan data to ui format    ${oa_inventory_details}    ${bay_num}    ${fan_rule_list}
    \    ${ui_inventory_details}=    GET FUSION FAN ATTRIBUTE DETAILS PAGE    ${bay_num}    all
    \    INSERT THE FAN TO C7000    ${bay_num}
    \    sleep    30    #Explicit wait time provided after inserting a Fan
    \    ${oa_inventory_details_after_insert}=    GET FAN STATUS FROM OA    ${bay_num}    all
    \    ${oa_converted_details_after_insert}=    tbird convert oa fan data to ui format    ${oa_inventory_details_after_insert}    ${bay_num}    ${fan_rule_list}
    \    ${ui_inventory_details_after_insert}=    GET FUSION FAN ATTRIBUTE DETAILS PAGE    ${bay_num}    all
    \    Dictionaries Should Be Equal    ${oa_converted_details}    ${ui_inventory_details}	
    \    Dictionaries Should Be Equal    ${oa_converted_details_after_insert}    ${ui_inventory_details_after_insert}	
    Run Keyword If    ${present_list_length}== 0    LOG    There are no Fans present in the enclosure    WARN

VALIDATE FAN STATUS IN OVERVIEW PAGE AFTER REMOVE AND INSERT
    [Documentation]    To validate the Fan status in Overview page after removing and inserting fan
    ...
    ...                Example:
    ...                       |    ${result}=    |    VALIDATE FAN STATUS IN OVERVIEW PAGE AFTER REMOVE AND INSERT    [1,3]    [8,1,2,4,5,6,7,9,10]    |
    ...                       |    ${result}=    |    VALIDATE FAN STATUS IN OVERVIEW PAGE AFTER REMOVE AND INSERT    [3]    [6,3,4,5,8,9,10]    |
    [Arguments]    ${bay_list}    ${fan_rule_list}
    ${present_list_length}=    Get Length    ${bay_list}
    :FOR    ${bay_num}    IN    @{bay_list}
    \    REMOVE THE FAN FROM C7000    ${bay_num}
    \    sleep    40    #Explicit wait time provided after removal of Fan
    \    ${oa_inventory_details}=    GET FAN STATUS FROM OA    ${bay_num}    all
    \    ${oa_converted_details}=    tbird convert oa fan data to ui format    ${oa_inventory_details}    ${bay_num}    ${fan_rule_list}
    \    ${oa_remove_status}=    Get From Dictionary    ${oa_converted_details}    status
    \    ${ui_remove_status}=    GET FUSION FAN ATTRIBUTE OVERVIEW PAGE    ${bay_num}    status
    \    INSERT THE FAN TO C7000    ${bay_num}
    \    sleep    40    #Explicit wait time provided after inserting a Fan
    \    ${oa_inventory_details_after_insert}=    GET FAN STATUS FROM OA    ${bay_num}    all
    \    ${oa_converted_details_after_insert}=    tbird convert oa fan data to ui format    ${oa_inventory_details_after_insert}    ${bay_num}    ${fan_rule_list}
    \    ${oa_insert_status}=    Get From Dictionary    ${oa_converted_details_after_insert}    status
    \    ${ui_insert_status}=    GET FUSION FAN ATTRIBUTE OVERVIEW PAGE    ${bay_num}    status
    \    Should Be Equal    ${oa_remove_status}    ${ui_remove_status}
    \    Should Be Equal    ${oa_insert_status}    ${ui_insert_status}
    Run Keyword If    ${present_list_length}== 0    LOG    There are no Fans present in the enclosure    WARN

GET FUSION FAN ATTRIBUTE DETAILS PAGE
    [Documentation]    This keyword provides the fan attribute for particular fan bay in details page
    ...
    ...                Example:
    ...                       |    ${result}=    |    GET FUSION FAN ATTRIBUTE DETAILS PAGE    3    all    |
    ...                       |    ${result}=    |    GET FUSION FAN ATTRIBUTE DETAILS PAGE    3    status    |
    ...                       |    ${result}=    |    GET FUSION FAN ATTRIBUTE DETAILS PAGE    3    part number    |
    ...                       |    ${result}=    |    GET FUSION FAN ATTRIBUTE DETAILS PAGE    3    state    |
    [Arguments]    ${bay_num}    ${status_type}
    [Return]    ${attribute_details}

    ${attribute_details}=    fusion ui get fan attribute    details    ${bay_num}	${status_type}

GET FUSION FAN ATTRIBUTE OVERVIEW PAGE
    [Documentation]    This keyword provides the fan attribute for particular fan bay in overview page
    ...
    ...                Example:
    ...                       |    ${result}=    |    GET FUSION FAN ATTRIBUTE OVERVIEW PAGE    3    all    |
    ...                       |    ${result}=    |    GET FUSION FAN ATTRIBUTE OVERVIEW PAGE    3    status    |
    ...                       |    ${result}=    |    GET FUSION FAN ATTRIBUTE OVERVIEW PAGE    3    model   |
    ...                       |    ${result}=    |    GET FUSION FAN ATTRIBUTE OVERVIEW PAGE    3    state    |
    [Arguments]    ${bay_num}    ${status_type}
    [Return]    ${attribute_overview}
    ${attribute_overview}=    fusion ui get fan attribute    overview    ${bay_num}    ${status_type}  
	