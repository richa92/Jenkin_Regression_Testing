*** Settings ***
Library           RoboGalaxyLibrary
Library           BuiltIn
Library           String
Library           Collections
Variables         ../../../FusionLibrary/ui/business_logic/general/base_elements.py
Variables         ../../../FusionLibrary/ui/business_logic/servers/serverhardware_elements.py
Variables         ../../../FusionLibrary/ui/business_logic/general/activity_elements.py


*** Keywords ***
Validate Server hardware page
	[Arguments]    ${encl}
	${enclosure} =  Get data by property  ${TestData.encl_existingEG}  name  ${encl}
	Fusion UI Validate Server hardware page		${enclosure[0]}

Navigate to Server hardware page
	Open Fusion Main Menu
	wait for element visible    ${FusionUIBaseElements.ID_MENU_LINK_SERVER_HARDWARE}	10
	wait for element and click    ${FusionUIBaseElements.ID_MENU_LINK_SERVER_HARDWARE}
	${status} 	${value} =  Run Keyword And Ignore Error	wait for element visible    ${FusionServerHardwarePage.ID_LINK_ADD_SERVER_HARDWARE}	10
	Run Keyword If	'${status}' == 'PASS'	Log	Successfully navigated to Server hardware page
	Run Keyword Unless	'${status}' == 'PASS'	Fail	Failed while navigating to Server hardware page.

Select Server Hardware
	[Arguments]    ${ServerName}
	${Modified_object}=  Get Ui Object	${FusionServerHardwarePage.ID_ELEMENT_SERVER_HARDWARE}	${ServerName}
	wait for element visible    ${Modified_object}	10
	wait for element and click	${Modified_object}
	${Modified_object}=  Get Ui Object	${FusionServerHardwarePage.ID_ELEMENT_SERVER_HARDWARE_LABEL}	${ServerName}
	${status} 	${value} = 	Run Keyword And Ignore Error	wait for element visible    ${Modified_object}
	Run Keyword If	'${status}' == 'PASS'	Comment	Given Server ${ServerName} is selected successfully.
	Run Keyword Unless	'${status}' == 'PASS'	Fail	Failed to select given Server ${ServerName}
	wait for element visible    ${FusionServerHardwarePage.ID_MENU_ACTION_POWERON}	20

Power On
	[Arguments]    ${ServerNames}
	wait for element visible	${FusionServerHardwarePage.ID_MENU_ACTION_MAIN_BTN}	10
	wait for element and click	${FusionServerHardwarePage.ID_MENU_ACTION_MAIN_BTN}
	wait for element visible	${FusionServerHardwarePage.ID_MENU_ACTION_POWERON}	10
	wait for element and click	${FusionServerHardwarePage.ID_MENU_ACTION_POWERON}
	${status} 	${value} = 	Run Keyword And Ignore Error	wait for element visible    ${FusionServerHardwarePage.ID_ELEMENT_SERVER_HARDWARE_POWER_STATUS_ON}	${PerfConstants.SERVER_POWER_OFF}
	Run Keyword If	'${status}' == 'PASS'	Comment		Given server ${ServerNames} is powered on successfully
	Run Keyword Unless	'${status}' == 'PASS'	Fail	Failed to power on Given server ${ServerNames}

Power On Server
	[Arguments]    ${ServerName}
	[return]	${date}
	${status} 	${value} =  Run Keyword And Ignore Error	wait for element visible    ${FusionServerHardwarePage.ID_LINK_ADD_SERVER_HARDWARE}	${PerfConstants.DEFAULT_SYNC_TIME}
	Run Keyword Unless	'${status}' == 'PASS'	Navigate to Server hardware page
	Select Server Hardware	${ServerName}
	wait for element visible	${FusionServerHardwarePage.ID_PANEL}
	wait for element and click	${FusionServerHardwarePage.ID_PANEL}
	wait for element visible	${FusionServerHardwarePage.ID_SELECT_OVERVIEW}
	wait for element and click	${FusionServerHardwarePage.ID_SELECT_OVERVIEW}
	wait for element visible    ${FusionServerHardwarePage.ID_ELEMENT_POWER_STATE}
	${power_state} =	Get Text    ${FusionServerHardwarePage.ID_ELEMENT_POWER_STATE}
	${status} 	${value} =  Run Keyword And Ignore Error	wait for element visible    ${FusionServerHardwarePage.ID_ELEMENT_SERVER_HARDWARE_POWER_STATUS_OFF}
	Run Keyword If	'${status}' == 'PASS'	Power On	${ServerName}
	Run Keyword Unless	'${status}' == 'PASS'	Fail	Given Server ${ServerName} is not in power on state ${value}
	${date} =	Get Text    ${FusionServerHardwarePage.ID_POWER_TIMESTAMP}

Verify Alert In Activity Tab
	[Arguments]    ${Name}	${Date}
	wait for element visible	${FusionServerHardwarePage.ID_PANEL}
	wait for element and click	${FusionServerHardwarePage.ID_PANEL}
	wait for element visible	${FusionServerHardwarePage.ID_SELECT_ACTIVITY}
	wait for element and click	${FusionServerHardwarePage.ID_SELECT_ACTIVITY}
	${Activity_object} = 	Get Ui Object	${FusionServerHardwarePage.ID_SERVER_ACTIVITY}	${Name}	${Date}
	${status} 	${value} = 	Run Keyword And Ignore Error	wait for element visible    ${Activity_object}
	Run Keyword If	'${status}' == 'PASS'	Log		Given alert "${Name} -- ${Date}" is present in the activity tab
	Run Keyword Unless	'${status}' == 'PASS'	Fail	Given alert "${Name} - ${Date}" is not present in the activity tab
	Run Keyword Unless	'${value}' == 'True'	Fail	Given alert "${Name} -- ${Date}"is not listed in activity page


