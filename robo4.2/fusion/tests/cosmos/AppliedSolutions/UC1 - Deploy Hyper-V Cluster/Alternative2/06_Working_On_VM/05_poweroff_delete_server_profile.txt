*** Settings ***
Documentation		Power off and delete server profiles
Resource 	        ../resource.txt
Test Setup          Load Test Data and Open Browser
Test Teardown       Logout and close all browsers
Variables			../../../../../../FusionLibrary/ui/storage/volumes.py

*** Test Cases ***
Power off server after applying server profiles
	Log into Fusion appliance as Administrator
	${bln_powerOffServer} =	Fusion UI Power Off Server	${TestData.profile_postupgrade[0].server}
	Run Keyword If		'${bln_powerOffServer}' == '${blnExpected}'    Log		Server is successfully powered off.
	Run Keyword Unless		'${bln_powerOffServer}' == '${blnExpected}'    Fail	Failed power off server profile

Delete server profile
	Log into Fusion appliance as Administrator
	${bln_deleteServer} =	Fusion UI Delete Server Profile	@{TestData.profile_postupgrade}
	Run Keyword If		'${bln_deleteServer}' == '${blnExpected}'    Log		server profile is deleted successfully.
	Run Keyword Unless		'${bln_deleteServer}' == '${blnExpected}'    Fail	Failed to to delete server profile

Check volume has been deleted after server profile is deleted
	Log into Fusion appliance as Administrator
	Fusion UI Navigate To Storage Volumes Page
	${volume_path} =	Get Ui Object		${FusionStorageVolumesPage.ID_TABLE_VOLUMES_FIND}	${TestData.profile_postupgrade[3].sanvolume}
	${volume} =	wait for element notvisible	${volume_path}
	Run Keyword If		'${volume}' == '${blnExpected}'    Log		volume has also been deleted successfully
	Run Keyword Unless		'${volume}' == '${blnExpected}'    Fail	Failed to delete volume
