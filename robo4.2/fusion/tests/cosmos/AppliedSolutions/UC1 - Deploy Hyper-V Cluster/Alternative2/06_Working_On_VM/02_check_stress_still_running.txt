*** Settings ***
Documentation		Access VM over network
Resource			../resource.txt
Test Setup			Load Test Data	${DataFile}
Library				OperatingSystem


*** Test Cases ***
Copy files to VM
	: For	${item}		in	@{list_ip}
	\	Run		powershell Enable-PSRemoting -Force
	\	Check MeatGrinder stress tool is still running in VM		${item}


*** Keywords ***
Check MeatGrinder stress tool is still running in VM
	[Arguments]		${item}
	: FOR	${vn}	In	@{TestData.copy_file}
	\	Run		powershell Enable-PSRemoting -Force	
	\	Run		powershell Set-Item wsman:\\localhost\\client\\trustedhosts * -Force
	\	Run		powershell Restart-Service WinRM
	\	${username} =	set variable	${vn.username}
	\	${password} =	set Variable	${vn.password}
	\	${hostname} =	set variable	${item}
	\	${check} =	Set Variable	$Username = '${username}'; $Password = '${password}'; $hostname = '${hostname}'; $pass = ConvertTo-SecureString -AsPlainText $Password -Force; $Cred = New-Object System.Management.Automation.PSCredential -ArgumentList $Username,$pass; Invoke-Command -ComputerName $hostname -ScriptBlock { Get-Process etdntmg } -credential $Cred
	\	Log	${check}
	\	${check_status} =	Run		powershell "${check}"
