*** Settings ***
Resource			../resource.txt
Test Setup         	Load Test Data and Open Browser
Test Teardown      	Logout and close all browsers
Variables			../../../../../../FusionLibrary/ui/storage/storagetemplates_elements.py
Variables			../../../../../../FusionLibrary/wpstui/business_logic/storage/storagesystems_elements.py

*** Test Cases ***
Refresh Storage System
	Log into Fusion appliance as Administrator
	${storage_system_data} =		Set Variable	${Testdata.storagesystems[0]}
	${storage_system_name} =		Set Variable	${storage_system_data.simplename}

	Fusion UI Navigate to storage systems Page
	Log	"select storage system"
	${select_storage} =		Fusion UI Select storage system		${storage_system_name}
	Run Keyword Unless	${select_storage} == True	Fail	Storage system is not present in appliance

    Wait For Element And Click	${GeneralStorageSystemElements.ID_DROPDOWN_ACTIONS}
    Wait For Element And Click	${RefreshStorageSystemElements.ID_SELECT_ACTION_REFRESH}
    ${STORAGE_ERROR_STATUS} =	Get Ui Object	${GeneralStorageSystemElements.ID_STATUS_STORAGE_SYSTEM_ERROR}		${storage_system_name}
	${BLN_STORAGE_STATUS} =		Wait For Element Visible	${STORAGE_ERROR_STATUS}	20
	Run Keyword If	${BLN_STORAGE_STATUS} == True	Log	Storage status is changed as per expected after refresh
    Run Keyword Unless	${BLN_STORAGE_STATUS} == True	Fail	Storage status is not changed as per expected after refresh

Check for the alert received in appliance for storage disconnect
	Log into Fusion appliance as Administrator
	${blnAlert} =  Fusion UI Verify Alert Generated In Appliance	@{TestData.storage_disconnect_alert}
	Run Keyword If		'${blnAlert}' == '${blnExpected}'    Log		Trap Alert for over heat on managed device received in appliance successfully
	Run Keyword Unless		'${blnAlert}' == '${blnExpected}'    Fail	Failed to receive Trap Alert in appliance for over heat on managed device
	Logout and close all browsers
