*** Settings ***
Resource			../resource.txt
Test Setup         	Load Test Data and Open Browser
Test Teardown      	Logout and close all browsers
Variables			../../../../../../FusionLibrary/ui/storage/volumes_elements.py
Variables			../../../../../../FusionLibrary/wpstui/business_logic/storage/volumes_elements.py


*** Test Cases ***
Refresh Storage Volume
	Log into Fusion appliance as Administrator
	${volume_data} =		Set Variable	${Testdata.storagevolumes[0]}
	${volume_name} =		Set Variable	${volume_data.name}
	${storage_data} =		Set Variable	${Testdata.storagesystems[0]}
	${storage_name} =		Set Variable	${storage_data.simplename}

	Fusion UI Navigate to storage volumes Page
	Log	"select refresh"
    Wait For Element And Click	${GeneralVolumeElements.ID_DROPDOWN_ACTIONS}
    Wait For Element And Click	${RefreshVolumeElements.ID_SELECT_ACTION_REFRESH}
    ${VOLUME_ERROR_STATUS} =	Get Ui Object	${GeneralVolumeElements.ID_STATUS_VOLUME_ERROR}		${volume_name}
	${BLN_VOLUME_STATUS} =		Wait For Element Visible	${VOLUME_ERROR_STATUS}	20
	Run Keyword If	${BLN_VOLUME_STATUS} == True	Log	volume status is changed as per expected after refresh
    Run Keyword Unless	${BLN_VOLUME_STATUS} == True	Fail	volume status is not changed as per expected after refresh

Verify the Storage volume Status In Dashboard Page
	Log into Fusion appliance as Administrator
	${volume_staus}=	Fusion UI Verify Dashboard Component Status		@{TestData.vol_status_after_stopping_storage_api}
	Run Keyword If		'${volume_staus}' == '${blnExpected}'    Log		volume status is as per expected.
	Run Keyword Unless		'${volume_staus}' == '${blnExpected}'    Fail	volume status is not as per expected.

Validate Dashboard Graphs
 	Log into Fusion appliance as Administrator
 	Fusion UI Validate Dashboard Graphs		@{TestData.vol_status_after_stopping_storage_api}
