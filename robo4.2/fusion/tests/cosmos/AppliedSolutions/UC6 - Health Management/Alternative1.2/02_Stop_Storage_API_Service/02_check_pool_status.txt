*** Settings ***
Resource			../resource.txt
Test Setup         	Load Test Data and Open Browser
Test Teardown      	Logout and close all browsers
Variables			../../../../../../FusionLibrary/ui/storage/storagepools_elements.py
Variables			../../../../../../FusionLibrary/wpstui/business_logic/storage/storagepools_elements.py


*** Test Cases ***
Refresh Storage pool
	Log into Fusion appliance as Administrator
	${pool_data} =		Set Variable	${Testdata.storagepools[0]}
	${pool_name} =		Set Variable	${pool_data.name}
	${storage_data} =		Set Variable	${Testdata.storagesystems[0]}
	${storage_name} =		Set Variable	${storage_data.simplename}

	Fusion UI Navigate to storage pools Page
	Log	"select refresh"
    Wait For Element And Click	${GeneralStoragePoolElements.ID_BUTTON_ACTIONS}
    Wait For Element And Click	${RefreshStoragePoolElements.ID_SELECT_ACTION_REFRESH}
    Wait For Element Text		${GeneralStoragePoolElements.ID_TEXT_GENERAL_STATE}	Refreshing	15
    Wait For Element Text		${GeneralStoragePoolElements.ID_TEXT_GENERAL_STATE}	Configured	30
    ${POOL_ERROR_STATUS} =		Get Ui Object	${GeneralStoragePoolElements.ID_STATUS_STORAGE_POOL_ERROR}	${pool_name}	${storage_name}
	${BLN_POOL_STATUS} =		Wait For Element Visible	${POOL_ERROR_STATUS}	15
	Run Keyword If	${BLN_POOL_STATUS} == True	Log	Pool status is changed as per expected after refresh
    Run Keyword Unless	${BLN_POOL_STATUS} == True	Fail	Pool status is not changed as per expected after refresh

Verify the Storage pool Status In Dashboard Page
	Log into Fusion appliance as Administrator
	${pool_staus}=	Fusion UI Verify Dashboard Component Status		@{TestData.pool_status_after_stopping_storage_api}
	Run Keyword If		'${pool_staus}' == '${blnExpected}'    Log		Storage Pool status is as per expected.
	Run Keyword Unless		'${pool_staus}' == '${blnExpected}'    Fail	Storage Pool status is not as per expected.

Validate Dashboard Graphs
 	Log into Fusion appliance as Administrator
 	Fusion UI Validate Dashboard Graphs		@{TestData.pool_status_after_stopping_storage_api}
