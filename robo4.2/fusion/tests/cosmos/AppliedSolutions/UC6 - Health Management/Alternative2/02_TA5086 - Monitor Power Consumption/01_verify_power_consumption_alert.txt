*** Settings ***
Documentation	Monitor Power Consumption And Verify Alert
Resource 		../resource.txt
Test Setup		Load Test Data and Open Browser
Test Teardown	Logout and close all browsers

***Variables***
${blnExpected}		True

*** Test Cases ***
Add Alert Notifications in fusion:
	Log into Fusion appliance as Administrator
	Fusion UI Add Alert Notifications	${TestData.notifications_TA5086}

Validate server hardware power Consumption
	Log into Fusion appliance as Administrator
	${blnValidatePower} =  Fusion UI Validate Server Hardware Power		@{TestData.server_TA5086}
	Set Global Variable		${blnValidatePower}
	Run Keyword If		'${blnValidatePower}' == '${blnExpected}'    Log		Power consumption values displayed in appliance and OA are same
	Run Keyword Unless		'${blnValidatePower}' == '${blnExpected}'    Fail	Power consumption values displayed in appliance and OA are not same

Send trap to simulate power Consumption on server hardware
	Log into Fusion appliance as Administrator
	${blnSendTrap} =  Send Trap		@{TestData.trap_TA5086}
	Run Keyword If		'${blnSendTrap}' == '${blnExpected}'    Log		Trap has been sent successfully to simulate Power consumption on managed device
	Run Keyword Unless		'${blnSendTrap}' == '${blnExpected}'    Fail	Failed to send Trap to simulate Power consumption on managed device

Check alert received in appliance for Power consumption on device
	Log into Fusion appliance as Administrator
	Run Keyword Unless		'${blnValidatePower}' == '${blnExpected}'    Fail	Power cap validation for enclosure is failed.
	${blnAlert} =  Fusion UI Verify Alert Generated In Appliance	@{TestData.activity_TA5086}
	Run Keyword If		'${blnAlert}' == '${blnExpected}'    Log		Trap Alert for Power consumption on managed device received in appliance successfully
	Run Keyword Unless		'${blnAlert}' == '${blnExpected}'    Fail	Failed to receive Trap Alert in appliance for Power consumption on managed device
	Logout and close all browsers
