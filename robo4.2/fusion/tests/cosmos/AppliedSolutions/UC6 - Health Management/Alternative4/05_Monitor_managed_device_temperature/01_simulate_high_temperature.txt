*** Settings ***
Documentation		Send trap to simulate high temperature and Check for the alert received in appliance
Resource			../resource.txt
Test Setup			Load Test Data and Open Browser
Test Teardown		Logout and close all browsers


*** Test Cases ***
Load Test data and Log into appliance as Administrator
	Log into Fusion appliance as Administrator
	
Send trap to simulate high temperature on managed devices
	${blnSendTrap} =	Set Variable  False
	${blnSendTrap} =  Send Trap	@{TestData.temp_trap}
	Set Global Variable		${blnSendTrap}
	Run Keyword If		'${blnSendTrap}' == '${blnExpected}'	Log		Trap has been sent successfully to simulate high temperature on managed device
	Run Keyword Unless		'${blnSendTrap}' == '${blnExpected}'	Fail	Failed to send Trap to simulate high temperature on managed device

Check for alert received in appliance for over heat on device
	Run Keyword Unless		'${blnSendTrap}' == '${blnExpected}'	Fail	Failed to send Trap to simulate high temperature on managed device
	Log into Fusion appliance as Administrator
	${blnAlert} =  Fusion UI Verify Alert Generated In Appliance	@{TestData.trap_activity}
	Run Keyword If		'${blnAlert}' == '${blnExpected}'	Log		Trap Alert for over heat on managed device received in appliance successfully
	Run Keyword Unless		'${blnAlert}' == '${blnExpected}'	Fail	Failed to receive Trap Alert in appliance for over heat on managed device

Verify server health status
	Log into Fusion appliance as Administrator
	${helthStatus}=	Fusion UI Validate Server Health Status	@{TestData.temp_trap}
	Run Keyword If		'${helthStatus}' == '${blnExpected}'	Log		Server health status is as per expected
	Run Keyword Unless		'${helthStatus}' == '${blnExpected}'	Fail	Server health status is not as per expected
	
Change activity status
	Log into Fusion appliance as Administrator
	${blnChangeState} =	Fusion UI Change Activity State In Activity Page	@{TestData.trap_activity}
	Run Keyword If		'${blnChangeState}' == '${blnExpected}'		Log	Activity state is changed successfully
	Run Keyword Unless		'${blnChangeState}' == '${blnExpected}'		Fail	Failed to change activity