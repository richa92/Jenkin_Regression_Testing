*** Settings ***
Documentation		Add server and deploy OS
Resource			../../resource.txt
Test Setup			Load Test Data	${DataFile}
Force Tags			altair	critical
Variables			../../../../../../../../altair/AltairLibrary/ui/objectrepo/altair_elements_servers_page.py
Library				AltairLibrary


*** Variables ***
${init_status1}		True


*** Test Cases ***
Add Servers
	Log into Altair appliance as Administrator
	: FOR	${server}	In		${TestData.add_server_and_deploy1}
	\	Altair UI_Go_To Servers Page
	\	Altair_ui_add_server		${server}
	\	Sleep	20
	Altair UI Logout Appliance Console
	Close All Browsers

Get Add Server Job status
	Log into Altair appliance as Administrator
	: FOR	${server}	In	${TestData.add_server_and_deploy1}
	\	Altair UI Go to Servers Page
	\	${ilo_ip} =		Set Variable	${server.ip}
	\	${status} =		Select Server and get job status		${ilo_ip}
	\	Run keyword and Continue on failure		Should Be Equal As Strings		${status}		True
	\	${job_status} =		Set variable if		'${status}'=='${init_status1}'	Succeeded	Failed
	\	Log		job - add server ${job_status} for ${server.ip}		WARN
	Altair UI Logout Appliance Console
	Close All Browsers


*** Keywords ***
Select Server and get job status
	[Arguments]		${ilo_ip}
	[return]	${status}
	${server_dict} =	Create Dictionary
	@{server_names} =	Create List
	${server_dict} =	altair_ui_get_complete_server_list	none
	${server_names} =	Get Dictionary Values		${server_dict}
	${server_list_length} =		Get Length		${server_names}
	: FOR	${i}	IN RANGE	1	${server_list_length+1}
	\	${locator} = 	Get UI Object	${AltairServersPage.ID_TABLE_SERVER_NAME}	${i}
	\	${ser_details} =	altair_ui_get_server_details		${locator}
	\	${server_details} =		Convert To List		${ser_details}
	\	Log		${server_details}
	\	${status} =		Run Keyword if		'${ilo_ip}'=='${server_details[5]}'		Altair trace job status
	\	Run Keyword if		'${ilo_ip}'=='${server_details[5]}'		Exit For Loop
