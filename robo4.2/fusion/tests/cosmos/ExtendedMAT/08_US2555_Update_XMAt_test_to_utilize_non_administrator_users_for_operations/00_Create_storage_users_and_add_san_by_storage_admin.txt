*** Settings ***
Documentation		Create user as Storage Administrator
Resource          	../resource.txt
Test Setup			Load Test Data and Open Browser
Test Teardown		Logout and close all browsers
Force Tags          dcs  users  storage  sanmanager

***Variables***
${user}					cosmosuser
${adminrole}			Infrastructure administrator
${multiroleuser}		Storage administrator
${cosmosusers}			StorageAdminUser
${blnExpected}			True

*** Test Cases ***
As an Administrator I want to add Storage Admin user to Fusion
	Log into Fusion appliance as Administrator
	${blnLoggedInUser}=		Verify user logged in    Administrator	 ${adminrole}
	Run Keyword Unless	'${blnLoggedInUser}' == '${blnExpected}'	Fail	Failed to verify logged in User and user role

	Log		create Storage Admin User
	${blnCreateUser}=	Create user by Name		${cosmosusers}
	Set Suite Variable		${blnCreateUser}
	Run Keyword If	'${blnCreateUser}' == '${blnExpected}'	Log		User created successfully
	Run Keyword Unless	'${blnCreateUser}' == '${blnExpected}'	Fail	Fail to created User

 Page validation for Storage Admin user, verify user data by Name
	Run Keyword Unless	'${blnCreateUser}' == '${blnExpected}'	Fail	Fail to created User
	Log into Fusion appliance as Administrator
	${blnVerifyUserData}=	Verify user data by Name	${cosmosusers}
	Run Keyword If	'${blnVerifyUserData}' == '${blnExpected}'	Log		User data validation was successfully
	Run Keyword Unless	'${blnVerifyUserData}' == '${blnExpected}'	Fail	Failed to validate user data

Verify Storage admin user and roles
	Run Keyword Unless	'${blnCreateUser}' == '${blnExpected}'	Fail	Fail to created User
    Fusion UI login to appliance   ${cosmosusers}
    ${blnVerifyUserLogged}=		Verify user logged in    ${cosmosusers}	 	${multiroleuser}
    Run Keyword If	'${blnVerifyUserLogged}' == '${blnExpected}'	Log		logged in user was verified Successfully
 	Run Keyword Unless	'${blnVerifyUserLogged}' == '${blnExpected}'	Fail	Failed to verify logged in User and user role

As an Storage Administrator I want to add SAN Manager to my fusion appliance
	Run Keyword Unless	'${blnCreateUser}' == '${blnExpected}'	Fail	Fail to created User
	Fusion UI login to appliance	${cosmosusers}
	${blnAddSan}=		Fusion UI Add San Manager 	@{TestData.sanmanagers}
	Run Keyword If	'${blnAddSan}' == '${blnExpected}'	Log		All SAN manager(s) were created Successfully
	Run Keyword Unless	'${blnAddSan}' == '${blnExpected}'	Fail	Failed to add some/all SAN manager(s)