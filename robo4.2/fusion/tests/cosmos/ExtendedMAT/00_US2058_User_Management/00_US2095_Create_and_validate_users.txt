*** Settings ***
Documentation		Add users to Fusion as Administrator
Resource            ../resource.txt
Test Setup			Load Test Data and Open Browser
Test Teardown		Logout and close all browsers
Force Tags          critical  users  dcs

***Variables***
${user}					cosmosuser
${aduser}				AD-User-Aruna
${adminrole}			Infrastructure administrator
@{multiroleuser}		Infrastructure administrator	Server administrator	Network administrator	Backup administrator
@{cosmosusers}			FullAdminUser	ServerAdminUser	NetworkAdminUser	BackupAdminUser
${aduserdomain}			domain1002.net
${status}				None

*** Test Cases ***
Add Active Directory Groups to Fusion Appliance
    [Tags]    ad
    Log into Fusion appliance as Administrator
    Add active directory users and groups to appliance by userName		${aduser}
    Fusion UI Logout of Appliance
    Fusion UI login to appliance   ${aduser}
    Verify AD user logged in    ${aduser}	${aduserdomain}


As an Administrator I want to add Infra Admin, NW Admin, Server Admin & Backup Admin users to Fusion
 	Log into Fusion appliance as Administrator
 	Verify user logged in    Administrator	 ${adminrole}

 	#create users
    Fusion UI Create User   @{TestData.users}

 	# Page validation for all the users, verify user data by Name
  	Fusion UI verify Userdata   @{TestData.users}


verify user and roles
    :FOR	${user}	IN	@{TestData.users}
    \	${value} =		get variable value	${user.domainName}
    \	Fusion UI login to appliance   ${user.name}
    \	Run keyword if	'${value}' == '${status}'		Verify user logged in          ${user.name}	 	${user.role}
    \	Log out of Fusion appliance


*** Keywords ***
Verify AD user logged in
	[Arguments]    ${user}	${domain}
    wait for element visible    ${FusionBasePage.ID_MAIN_MENU_CONTROL}
	wait for element visible    ${FusionUserandGroupsPage.ID_ELEMENT_USER_SESSION}
	Click Element	${FusionUserandGroupsPage.ID_ELEMENT_USER_SESSION}
	${user_name_AD_object}=  Get Ui Object	${FusionUserandGroupsPage.ID_ELEMENT_USER_NAME_AD_ADDED}	${domain}		${user}
	Page Should Contain Element		${user_name_AD_object}