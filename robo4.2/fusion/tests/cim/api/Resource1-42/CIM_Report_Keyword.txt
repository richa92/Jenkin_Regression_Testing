*** Settings ***
Library        RoboGalaxyLibrary
Library        FusionLibrary
Library        OperatingSystem
Library        BuiltIn
Library        Collections
Library        XML
Library        SSHLibrary
Library        String

*** Keywords ***

Get Reports from Appliance
    [Documentation]    Gets all report from oneview
    ${Response}=    Get Request    rest/reports/    1000
    Should be Equal    ${Response.status_code}    ${200}    msg=Operation failed ${Response.content}
    ${data}    Evaluate    json.loads('''${Response.text}''')    json
    log    ${data}
    [Return]    ${data}

Get ReportUri
    [Documentation]    Gets Report Uri
    ${data}=    Get Reports from Appliance
    ${members}=    Get From Dictionary    ${data}    members
    :FOR    ${Report}  IN  @{members}
    \    ${name}=   Get From Dictionary  ${Report}  name
    \    Run keyword if    '${name}'=='${reportName}'    Exit For Loop
    ${saveReportUri}=    Get From Dictionary    ${Report}    saveReportUri
    [Return]    ${saveReportUri}

Save Report
    [Documentation]    Saves Report in given format
    [Arguments]    ${reportName}    ${format}
    Remove File    ${Downloadpath}/*.${format}
    ${reportUri}=    Get ReportUri
    ${resp}=    Get Request    ${reportUri}?${format}    1000
    Should be Equal    ${resp.status_code}    ${200}    msg=Operation failed ${resp.content}
    Create File    ${Downloadpath}/Localuser.${format}    ${resp.content}
