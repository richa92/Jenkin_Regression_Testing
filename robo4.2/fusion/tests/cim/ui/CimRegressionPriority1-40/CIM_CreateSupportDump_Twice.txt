*** Settings ***
Documentation          Run create support dump (Twice)
Resource               ../Resource/CIM_CommonResource.txt
Resource               ../Resource/CIM_Activity.txt
Resource               ../Resource/CIM_Settings.txt
Resource               ../Resource/CIM_SupportDump.txt
Test Setup             Load Test Data and Open Browser
Test Teardown          Logout and close all browsers

*** Variables ***
${searchtext}          Support dump created successfully
${activityname}        Create support dump and preview dump
${resource}            Appliance
${activitystate}       Completed
${activityowner}       Administrator

*** Test Cases ***
As an Administrator I want to Create Support Dump twice
    [Documentation]    Create Support Dump Twice
    Log into Fusion appliance as Administrator
    :FOR    ${Index}    IN RANGE    1    2
    \    Log    Create Support Dump iteration ${Index}
    \    ${status} =    Fusion UI Create Support Dump From Data File    @{TestData.supportdump}
    \    Should Be True    ${status}    msg=Failed to create Support Dump
    \    wait for element visible    ${FusionSettingsPage.ID_VALIDATE_SUCCESS}

    #Verify Create Support Dump activity in Activity Page
    Verify Activity Existence in Activity Page    ${activityname}    ${resource}    ${activitystate}    ${activityowner}

    #Verify entry in Auditlog file
    Download and verify entry in Audit log file    ${DownloadPath}    ${searchtext}
