*** Settings ***
Documentation    Create Support Dump with Encrypt toggle
Resource             ../Resource/CIM_CommonResource.txt
Resource             ../Resource/CIM_Activity.txt
Test Setup           Load Test Data and Open Browser
Test Teardown        Logout and close all browsers
Variables            ../../../../FusionLibrary/ui/settings/settings_elements.py

*** Variables ***
${searchtext}        Support dump created successfully
${activityname}      Create support dump and preview dump
${resource}          Appliance
${activitystate}     Completed
${activityowner}     Administrator

*** Test Cases ***
As an Administrator I want to Create Support Dump with Encrypt Enabled followed by Disabled
    [Documentation]    Create SupportDump with Encrypt Enable followed by Disable
    Log into Fusion appliance as Administrator
    :FOR    ${supportdump}    IN    @{TestData.createsupportdump}
    \    Navigate to page    Settings
    \    ${status} =    Fusion UI Create Support Dump From Data File    ${supportdump}
    \    Should Be True    ${status}    msg=Failed to create Support Dump
    \    wait for element visible    ${FusionSettingsPage.ID_VALIDATE_SUCCESS}

    #Verify Create Support Dump activity in Activity Page
    Verify Activity Existence in Activity Page    ${activityname}    ${resource}    ${activitystate}    ${activityowner}

    #Verify entry in Auditlog file
    Download and verify entry in Audit log file    ${DownloadPath}    ${searchtext}
