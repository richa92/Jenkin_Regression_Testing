*** Settings ***
Documentation       Edit Alert Filter created
Resource            ../Resource/CIM_CommonResource.txt
Resource            ../Resource/CIM_Activity.txt
Library             XML
Library             FusionLibrary
Force Tags          Buildup
Suite Setup         Load Test Data and Open Browser
Suite Teardown      Logout And Close All Browsers
Variables           ../../../../FusionLibrary/ui/business_logic/settings/notifications_elements.py


***Variables***
${count}            1


*** Test Cases ***

#################################Scenario############################################

Edit Alert Email Filter
    [Documentation]    Editing ALert Filter To Add Or Remove Resources
    Log into Fusion appliance as Administrator
    ${status} =  Fusion UI Edit ALert Filter   @{TestData.edit_alertFilter}
    Run Keyword If  '${status}'=='True'   Log   Successfully edited all alert filter
    Run Keyword Unless  '${status}'=='True'   Fail    Failed to edited all alert filter
    Verify Edit Filter Add Resource Activity in Activity Page
    ${status} =  Fusion UI Edit ALert Filter   @{TestData.edit_filter_remove_resource}
    Run Keyword If  '${status}'=='True'   Log   Successfully edited all alert filter
    Run Keyword Unless  '${status}'=='True'   Fail    Failed to edited all alert filter
    Verify Edit Filter Remove Resource Activity in Activity Page


***Keywords***

Verify Edit Filter Add Resource Activity in Activity Page
    [Documentation]    Navigate toActivity Page and Validate that Activity is Listed for Editing ALert Filter
    Navigate to Activity page
    wait for element visible    ${FusionActivityPage.ID_ACTIVITY_TABLE} 10
    ${dataele}=   XML.Get Elements    ${DATAFILE}    edit_alertFilter/alert
    ${datacount}=   Get Length  ${dataele}
    :FOR    ${filter}    IN    @{TestData.edit_alertFilter}
    \   ${count}=   Get Matching XPath Count    //*[@id='hp-activities']/tbody//tr[${datacount}][//span[text()='Update notifications'] and td/a[text()='Notifications']]
    \   Run Keyword If  ${count} >= 1   Log    Update notifications is listed in activity page
    \   Run Keyword Unless  ${count} >= 1   Fail    Update notifications is not listed in activity page
    \   ${datacount}=   Evaluate    ${datacount}-${count}

Verify Edit Filter Remove Resource Activity in Activity Page
    [Documentation]    Navigate to Activity Page and Validate that Activity is Listed for Editing ALert Filter
    Navigate to Activity page
    wait for element visible    ${FusionActivityPage.ID_ACTIVITY_TABLE} 10
    ${dataele}=   XML.Get Elements    ${DATAFILE}    edit_filter_remove_resource/filter
    ${datacount}=   Get Length  ${dataele}
    :FOR    ${filter}    IN    @{TestData.edit_filter_remove_resource}
    \   ${count}=   Get Matching XPath Count    //*[@id='hp-activities']/tbody//tr[${datacount}][//span[text()='Update notifications'] and td/a[text()='Notifications']]
    \   Run Keyword If  ${count} >= 1   Log    Update notifications is listed in activity page
    \   Run Keyword Unless  ${count} >= 1   Fail    Update notifications is not listed in activity page
    \   ${datacount}=   Evaluate    ${datacount}-${count}

