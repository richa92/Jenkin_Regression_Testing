*** Settings ***
Documentation       Creation Of Self Sign Certificate
Resource            ../Resource/CIM_CommonResource.txt
Resource            ../Resource/CIM_Certificate.txt
Force Tags          Buildup
Library             String
Library             Collections
Library             DateTime
Variables         ../../../../FusionLibrary/ui/business_logic/general/base_elements.py
Variables         ../../../../FusionLibrary/ui/business_logic/general/activity_elements.py
Suite Setup         Load Test Data and Open Browser
Suite Teardown      Logout And Close All Browsers


*** Variables ***

${activityname}     Certificate SelfSigned Configuration.
${activitystate}    Completed
${activityowner}    Administrator


*** Test Cases ***

#################################Scenario############################################

Create Self Signed certificate
    Log into Fusion appliance as Administrator
    Generate Self Signed Certificate

    #Validate Activity Page
    Verify Activity Existence in Activity Page  ${activityname}   ${activitystate}   ${activityowner}


*** Keywords ***

Navigate to Activity page
    Open Fusion Main Menu
    wait for element visible    ${FusionBasePage.ID_MENU_LINK_ACTIVITY}
    wait for element and click    ${FusionBasePage.ID_MENU_LINK_ACTIVITY}
    ${status}   ${value} =  Run Keyword And Ignore Error    wait for element visible    ${FusionActivityPage.ID_PAGE_LABEL} 10
    Run Keyword If  '${status}' == 'PASS'   Log    Successfully navigated to Activity page
    Run Keyword Unless  '${status}' == 'PASS'   Fail    Failed while navigating to Activity page.

Verify Activity Existence in Activity Page
    [Arguments]    ${activityname}    ${activitystate}    ${activityowner}
    Navigate to Activity page
    wait for element visible    //*[@id='hp-activities']/tbody//tr[1][//span[text()='${activityname}'] and td/span[text()='${activitystate}'] and td/div[text()='${activityowner}']] 10
    ${count}=    Get Matching XPath Count    //*[@id='hp-activities']/tbody//tr[1][//span[text()='${activityname}'] and td/span[text()='${activitystate}'] and td/div[text()='${activityowner}']]
    Run Keyword If  ${count} == ${activityCount}   Log   Given alert '${activityname}' with state '${activitystate}' is present in the activity page
    Run Keyword Unless  ${count} == ${activityCount}   Fail   Given alert '${activityname}' with state '${activitystate}' is not present in the activity page ${activityCount} and ${count}
