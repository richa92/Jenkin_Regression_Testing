*** Settings ***
Documentation		Delete Licenses from Fusion Appliance
Resource			../Resource/CIM_CommonResource.txt
Test Setup			Load Test Data and Open Browser
Test Teardown		Logout and close all browsers
Library				SSHLibrary

*** Variables ***
${COMMAND1}		cd /ci/bin
${COMMAND2}		cd /ci/bin && ./licmgr -t key -d all

*** Test Cases ***
As an Administrator I want to Delete Licenses from Fusion Appliance
	Log into Fusion appliance as Administrator
	${Appliance_IP} =	Fetch From Right	${ApplianceUrl}	/
	Fusion UI Navigate To Settings Page
	Sleep	5
	${LicenseNone}=	Run Keyword And Return Status	Element Should Be Visible	//*[@id='[object Object]' and text()='none']
	Run Keyword if	'${LicenseNone}'== 'False'	Delete License	${Appliance_IP}	${TestData.RootUserCredentials[0].username}	${TestData.RootUserCredentials[0].password}	${COMMAND1}	${COMMAND2}

*** Keywords ***
Delete License
	[Arguments]	${Appliance_IP}	${USERNAME}	${PASSWORD}	${COMMAND1}	${COMMAND2}
	Log	Deleting the available license
	Open Connection	${Appliance_IP}
	Login	${USERNAME}	${PASSWORD}
	Sleep	2
	Write	${COMMAND1}
	Sleep	2
	Write	${COMMAND2}
	Sleep	5
	Read Until	Are you sure you want to remove all licenses, as this operation cannot be reverted? [Y/N]:
	Write	Y
	Sleep	5
	${Output}=	Read Until	All licenses removed.
	Close All Connections
	Log	Licenses deleted successfully
