*** Settings ***
Documentation		Add Directory servers
Resource			../Resource/CIM_CommonResource.txt
Resource			../Resource/CIM_Security.txt
Test Setup			Load Test Data and Open Browser
Test Teardown		Logout and close all browsers
Variables			../../../../FusionLibrary/ui/settings/settings_elements.py
Library				XML

*** Variables ***
${search_text}		A login domain configuration was added to the system
@{available_directory}
@{new_testdata}

*** Test Cases ***
As an Administrator I want to Add Directory server
	Log into Fusion appliance as Administrator
	Fusion UI Navigate To Settings Page
	wait for element visible	${FusionSettingsPage.ID_ELEMENT_DIRECTORIES}

	#Check for existing Directories in appliance before adding.
	${dir_count}=	Get Matching XPath Count	//*[@id='fs-settings-security-overview-directories']/li
	Run Keyword If	'${dir_count}' == '1'	Add Directory and Verify in Activity and Audit log	${TestData.AddDirectory}
	${avail_dir} =	Run Keyword If	'${dir_count}' > '1'	Fetch available Directories from Appliance	${dir_count}	${available_directory}
	${test_data} =	Run Keyword If	'${dir_count}' > '1'	Exclude available Directory in Test Data	${avail_dir}

	#Add Directory with new test data
	${data_count} =	Run Keyword If	'${dir_count}' > '1'	Get Length	${test_data}
	Run Keyword If	${data_count} > 0	Add Directory and Verify in Activity and Audit log	${test_data}
	Run Keyword If	'${data_count}' == '0'	Log	Instruct to provide new Domain names in data file to add directory	WARN
