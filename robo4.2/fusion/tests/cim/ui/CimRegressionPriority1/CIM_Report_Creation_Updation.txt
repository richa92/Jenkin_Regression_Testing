*** Settings ***
Documentation       Generation Of Report
Resource            ../Resource/CIM_CommonResource.txt
Resource            ../../../../Resources/ui/reports/report_localuser.txt
Resource            ../Resource/CIM_Activity.txt
Library             FusionLibrary
Force Tags          Buildup
Suite Setup         Load Test Data and Open Browser
Suite Teardown      Logout And Close All Browsers

*** Variables ***
${user}    administrator


*** Test Cases ***

#################################Scenario############################################

Create and Update User Report
    Log into Fusion appliance as Administrator
    Navigate To Reports Page
    Select Local Users and Validate Reports Table    ${user}
    ${user_count}=    Get Users Count In Report Page
    Run Keyword If    ${user_count} > 1    Fusion UI Remove User    @{TestData.users}
    Run Keyword Unless    ${user_count} > 1    Log    No Existing user

    #Add Users and validate report
    Navigate To Reports Page
    ${user_count}=    Get Users Count In Report Page
    Fusion UI Create User    @{TestData.users}
    Navigate To Reports Page
    :FOR    ${users_added}    IN    @{TestData.users}
    \    ${value} =    get variable value    ${users_added.name}
    \    ${name} =    Convert To Lowercase    ${value}
    \    Select Local Users and Validate Reports Table    ${value}
    ${count}=   Get Users Count In Report Page
    Run Keyword If    ${count} > ${user_count}    Log    The new users are Updated in the report
    Run Keyword Unless    ${count} > ${user_count}    Fail    Failed to update the report with new users

    #Remove Users and validate report
    Fusion UI Remove User    @{TestData.users}
    Navigate To Reports Page
    ${new_count}=   Get Users Count In Report Page
    Run Keyword If    ${new_count} < ${count}    Log    The new users are Updated in the report
    Run Keyword Unless    ${new_count} < ${count}    Fail    Failed to update the report with new users
