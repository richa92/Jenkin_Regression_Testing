*** Settings ***
Library            RoboGalaxyLibrary
Library            FusionLibrary
Library            BuiltIn
Library            XML
Library            String
Resource        ../Resource/CIM_Activity.txt
Resource        ../Resource/CIM_UsersAndGroups.txt
Variables        ../../../../FusionLibrary/ui/settings/settings_elements.py

*** Keywords ***
Add Directory and Verify in Activity page and Audit log file
    [Documentation]    Add Directory verify activity page and audit log file
    [Arguments]    ${test_data}
    :FOR    ${dir}    IN    @{test_data}
    \    ${Status}=    Fusion UI Add Directory Server    ${dir}
    \    Should Be True    ${Status}    msg=Failed to add directory server
    \    Verify Activity Existence in Activity Page    ${activityname}    ${resource}    ${activitystate}    ${activityowner}

    #Verify entry in auditlog file
    ${file_path}=    Download and unzip Audit log file    ${DownloadPath}
    ${bln_logentry_exists} =    file_contains    ${file_path}    ${search_text}
    Should Be Equal As Strings    ${bln_logentry_exists}    ${blnExpected}    msg=Entry ${search_text} not available in log file.
