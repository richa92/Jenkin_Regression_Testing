*** Settings ***
Documentation       Create BackUp as BackupAdmin user
Resource            ../Resource/CIM_CommonResource.txt
Resource            ../Resource/CIM_Activity.txt
Resource            ../Resource/CIM_Settings.txt
Test Setup          Load Test Data and Open Browser
Test Teardown       Logout and close all browsers

*** Variables ***
${searchtext}       A backup was created
${activityname}     Create backup
${resource}         Backup
${activitystate}    Completed
${activityowner}    BackupAdminUser

*** Test Cases ***
As an BackAdmin I want to Create a Backup
    [Documentation]    Create Backup as BackupAdmin user
    #Log into Fusion appliance as BackupAdminUser
    ${user} =    Get data by property    ${TestData.users}    role    Backup administrator
    Fusion UI Login To Appliance    ${user[0].name}

    #Create Backup as BackupAdminUser
    ${bkpfile} =    Create BackUp
    Log    ${bkpfile} created successfully

    #Verify Create Backup activity in Activity Page
    Verify Activity Existence in Activity Page    ${activityname}    ${resource}    ${activitystate}    ${activityowner}

    #Logout and Login as Administrator to Download Audit Logs
    Logout and close all browsers
    Open Browser    ${ApplianceUrl}    ${Browser}
    Log into Fusion appliance as Administrator

    #Verify entry in Auditlog file
    Download and verify entry in Audit log file    ${DownloadPath}    ${searchtext}
