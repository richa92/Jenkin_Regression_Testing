*** Settings ***
Documentation   Prepare for copy server profile test
Resource        ../resource.txt
Test Teardown   Pause Test Execution and Relogin Appliance On Failure



*** Test Cases ***
Prepare for copy server profile test
    ${data}=                        Get Data By Xpath   //BLServerProfiles/Create/profile[contains(@desc, "Prepare for")]
    ${n}=	Evaluate	0
    Convert To Integer	${n}
    :FOR    ${profile}    IN    @{data.profile}
    \       ${ret_bay}=     Get Lines Matching Regexp     ${profile.hardwareType}     \\$\\{.*\\}
    \       ${blade_name}=   Get Substring   ${profile.hardwareType}     2   -1
    \       Set Global Variable             ${blade_name}       ${blade_name}
    \       Run Keyword If  "${ret_bay}" != ""      Get Server Hardware Type By Blade Name
    \       Run Keyword If  "${ret_bay}" != ""      Set Value For Property      ${data.profile[${n}]}   hardwareType    ${global_server_type}
    \       ${n}=	Evaluate    ${n}+1
    ${result}=                      Fusion UI Create Server Profile                     @{data.profile}
    Should Be True                  ${result}                                           Failed to create server profile due to error.
    ${result}=                      Fusion UI Verify Server Profile General Info        @{data.profile}
    Should Be True                  ${result}                                           Failed to verify server profile general information.
    
*** Keywords ***
Get Server Hardware Type By Blade Name
    ${server_type}=                 Fusion UI Get Type Of Server Hardware               ${blade_name}
    Set Global Variable             ${global_server_type}                               ${server_type}