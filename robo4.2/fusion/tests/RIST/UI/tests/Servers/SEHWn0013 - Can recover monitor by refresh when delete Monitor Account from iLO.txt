*** Settings ***
Documentation   SEHWn0013 - Can recover monitor by refresh when delete Monitor Account from iLO
Library         robot.api.logger
Resource        ../resource.txt
Test Setup      Load Test Data and Open Browser
Test Teardown	Pause And Close Browser


*** Variables ***
${user}         Administrator


*** Test Cases ***
As an Administrator I want to force refresh a server by providing iLO credentials
    Fusion UI Login To Appliance    ${user}
    ${rc}=                              Fusion UI Add Server Hardware           @{TestData.DLG6ForMonitoring}
    Should be True                      ${rc}   msg=Failed to add Server Hardware for monitoring
    Fusion UI Delete Monitor Account    @{TestData.DLG6ForMonitoring}
    # The first time refresh should fail due to Monitor acccount was removed
    Fusion UI Force Refresh Server  @{TestData.DLG6ForMonitoring}
    # The second time refresh should fail and should have detected Monitor account was removed
    Fusion UI Force Refresh Server  @{TestData.DLG6ForMonitoring}
    # The third time refresh should create Monitor account again and recover the Monitoring
    Fusion UI Force Refresh Server  @{TestData.DLG6ForMonitoring}