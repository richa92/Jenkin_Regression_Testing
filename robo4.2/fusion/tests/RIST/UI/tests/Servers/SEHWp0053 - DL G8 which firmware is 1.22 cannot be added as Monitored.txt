*** Settings ***
Documentation   SEHWp0053 - DL G8 which firmware is 1.22 cannot be added as Monitored
Library         robot.api.logger
Resource        ../resource.txt
Test Setup      Load Test Data and Open Browser
Test Teardown	Pause And Close Browser


*** Variables ***
${user}         Administrator


*** Test Cases ***
As an Administrator I want to add a server hardware into Fusion as Monitored when its FW is less than 1.30
    Fusion UI Login To Appliance    ${user}

    # remove all server profiles that may have been created by previous tests,
    # to make sure the afterward removing of server hardware is not restrained
    Fusion UI Delete All Appliance Server Profiles

    :FOR    ${SERVER}   IN  @{TestData.DLGen8ForMonitoring}
    \   ${rc}=                              Fusion UI Remove Server Hardware           @{TestData.DLGen8ForMonitoring}
    \   Should be True                      ${rc}   msg=Failed to remove Server Hardware for monitoring

    \   Fusion SRM iLO API Init             ${SERVER.iloIP}    ${SERVER.iloUserName}   ${SERVER.iloPassword}
    \   Fusion SRM iLO Update Firmware      ftp://wpstwork4.vse.rdlabs.hpecorp.net/firmware/ilo/ilo4/ilo4_120.bin
    \   sleep   3 minutes

    # verify the error message is expected
    Fusion UI Validate Server Hardware Meet Minimum ilo4    @{TestData.DLGen8ForMonitoring}
