*** Settings ***
Documentation   SPBLp0034 - SP connection add and edit with virtual

Resource    ../resource.txt

Test Setup      Load Multi Test Data and Open Browser
Test Teardown   Pause And Close Browser

*** Variables ***
${user}         Administrator

*** Test Cases ***
As an Administrator I want to add and edit server profile via virtual
    Fusion UI Login To Appliance    ${user}

    # Create server profile
    ${data}=                        Get Data By Xpath                       //SPBLp0034/ServerProfile/Create
    ${Status}=                      Fusion UI Create Server Profile     @{data.Create}
    Should Be True                  ${Status}  msg=Failed to create server profile

    # Verify server profile advanced info
    ${data}=                        Get Data By Xpath                       //SPBLp0034/ServerProfile/Create
    ${Status}=                      Fusion UI Verify Server Profile Advanced Info     @{data.Create}
    Should Be True                  ${Status}  msg=Failed to verify the advanced info of server profile

    # Verify the allocated number in Address and Indentifers
    ${data}=                        Get Data By Xpath                       //SPBLp0034/AddressIdentifier/Verify1
    ${Status}=                      Fusion UI Verify Address And Identifier Used Number   @{data.Verify1}
    Should Be True                  ${Status}  msg=Failed to verify address and identifier used number

    # Edit server profile
    ${data}=                        Get Data By Xpath                       //SPBLp0034/ServerProfile/Edit
    ${Status}=                      Fusion UI Edit Server Profile       @{data.Edit}
    Should Be True                  ${Status}  msg=Failed to edit server profile

    # Verify the allocated number in Address and Indentifers
    ${data}=                        Get Data By Xpath                       //SPBLp0034/AddressIdentifier/Verify2
    ${Status}=                      Fusion UI Verify Address And Identifier Used Number   @{data.Verify2}
    Should Be True                  ${Status}  msg=Failed to verify address and identifier used number

    # Remove server profile
    ${data}=                        Get Data By Xpath                       //SPBLp0034/ServerProfile/Delete
    ${Status}=                      Fusion UI Delete Server Profile     @{data.Delete}
    Should Be True                  ${Status}  msg=Failed to remove server profile

    # Remove enclosure afte test completed
    As an Administrator I want to remove Enclosure after completed Server Profile cases


*** Keywords ***

As an Administrator I want to remove Enclosure after completed Server Profile cases
    Fusion UI Login To Appliance    ${user}
    ${data}=                            Get Data By Xpath                 //ENCLp0017/enclosure
    ${rc}=                              Fusion UI Remove Enclosure    @{data.enclosure}
    Should Be True                      ${rc}   msg=Failed to add enclosure