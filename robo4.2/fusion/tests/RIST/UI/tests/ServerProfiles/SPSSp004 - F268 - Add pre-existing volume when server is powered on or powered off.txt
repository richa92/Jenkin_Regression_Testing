*** Settings ***
Documentation   SPSSp004 - F268 - Add pre-existing volume when server is powered on or powered off
Library         robot.api.logger
Resource        ../resource.txt
Test Setup      Load Multi Test Data and Open Browser
Test Teardown	Pause And Close Browser


*** Variables ***
${user}         Administrator

*** Test Cases ***

As an Administrator I want to Add pre-existing volume when server is powered on or powered off
    Fusion UI Login To Appliance        ${user}

    # Add Storage System
    ${data}=                            Get Data By Xpath                       //SPSSp004/storagesystem
    ${rc}=                              Fusion UI Add Storage Systems           @{data.storagesystem}
    Should be True                      ${rc}                                   msg=Failed to Verify Can not use invalid text for zone and alias format

    # Add Storage Pool
    ${data}=                            Get Data By Xpath                       //SPSSp004/storagepool
    ${rc}=                              Fusion UI Add Storage Pools             @{data.storagepool}
    Should be True                      ${rc}                                   msg=Failed to add Storage Pools

    # Create Storage volume
    ${data}=                            Get Data By Xpath                       //SPSSp004/storagevolume
    ${Status}=                          Fusion UI Create Storage Volumes        @{data.storagevolume}
    Should Be True                      ${Status}                               msg=Failed to create storage volumes

    # Add Enclosure
    Fusion UI Add Enclosure             @{TestData.enclosure}

    # Create a server profile for a BL server
    ${data}=                            Get Data By Xpath                       //SPSSp004/profile
    ${rc}=                              Fusion UI Create Server Profile         @{data.profile}
    Should be True                      ${rc}                                   msg=Failed to create Server Profile

    Sleep                               10
    # Power on a server hardware
    ${data}=                            Get Data By Xpath                       //SPSSp004/PowerOn
    ${rc}=                              Fusion UI Power On Server Hardware      @{data.PowerOn}
    Should be True                      ${rc}                                   msg=Failed to power on Server Hardware

    # Power off a server hardware
    ${data}=                            Get Data By Xpath                       //SPSSp004/PowerOff
    ${rc}=                              Fusion UI Power Off Server Hardware     @{data.PowerOff}
    Should be True                      ${rc}                                   msg=Failed to power on Server Hardware

    ${data}=                            Get Data By Xpath                       //SPSSp004/deleteprofile
    Fusion UI Delete Server Profile     @{data.deleteprofile}

    # Delete Storage Volume
    ${data}=                            Get Data By Xpath                       //SPSSp004/storagevolume
    Fusion Ui Delete Storage Volumes    @{data.storagevolume}

    # Delete Storage Volume
    ${data}=                            Get Data By Xpath                       //SPSSp004/storagesystem
    Fusion Ui Remove Storage Systems    @{data.storagesystem}

