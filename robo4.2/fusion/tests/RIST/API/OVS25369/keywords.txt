*** Settings ***
Library             RoboGalaxyLibrary
Library             FusionLibrary
Library             OperatingSystem
Library             BuiltIn
Library             Collections
Library             XML
Library             SSHLibrary
Library             String
Library             Dialogs
Resource            ../../../../Resources/api/fusion_api_resource.txt
Resource            ../global_variables.robot
Variables           ./Regression_Data2.py

*** Keywords ***
Case Setup
    [Documentation]    Login oneview appliance
    [Arguments]        ${APPLIANCE_IP}    ${credentials}
    Log    \n- Logging in OneView appliance    console=True
    Should Not Be Equal           ${APPLIANCE_IP}  unknown  msg=The appliance IP must be defined, Example:'APPLIANCE_IP:16.114.209.231'
    Fusion Api Login Appliance    ${APPLIANCE_IP}    ${credentials}

Case Teardown
    [Documentation]    Logout oneview appliance
    Log    \n- Delete compatibility report    console=True
    ${resp}=    Fusion Api Delete Security Compatibility Report
    Wait For Task2  ${resp}
    Log    \n-Logging out OneView appliance    console=True
    Fusion Api Logout Appliance

Verify Directory Server In Cnsa Report
    [Documentation]   verify the contents of directory server in CNSA compatibility report
    [Arguments]       ${member}
    :FOR    ${item}    IN   @{DOMAIN_MEMBERS}
    \        Run Keyword If    '${item['deviceName']}'!='${member['deviceName']}'    Continue For Loop
    \        ...        ELSE        Dictionaries Should Be Equal    ${member}    ${item}

Generate Leaf Certificate Payload
    [Documentation]    Generate Leaf Certificate Payload
    [Arguments]      ${leaf_cert_body}  ${cert}  ${aliasname}=${None}
    ${body} =  Copy Dictionary    ${leaf_cert_body}
    Set To Dictionary    ${body['certificateDetails'][2]}    base64Data    ${cert}
    Run Keyword If  '${aliasname}' != '${None}'   Set To Dictionary    ${body['certificateDetails'][2]}  aliasName   ${aliasname}
    [Return]    ${body}
