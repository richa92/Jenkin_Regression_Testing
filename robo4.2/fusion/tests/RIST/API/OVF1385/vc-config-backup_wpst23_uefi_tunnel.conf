### Modify 'ExitOnFailure' property value to FALSE, when executing in script
### mode to avoid exiting (vcmcli returning FAILURE) on a command failure
###     set cli ExitOnFailure=TRUE
### This script can be generated by 'show config' cmd on VCM.


set domain Name=wpst23_vc_domain

set stackinglink -quiet DomainStackingMode=Full

set snmp enet -quiet ReadCommunity=public EnableV1V2=true EnableV3=false
set snmp fc -quiet ReadCommunity=public EnableV1V2=true EnableV3=false

### Setting the ssl-strength causes the web server to restart. Any active
### GUI session must be re-established. This action does not impact CLI
### sessions.
set ssl -quiet Strength=Strong
set user-security StrongPasswords=Disabled MinPasswordLength=8
set ldap Enabled=false

### Below command can only be executed by remote user (ldap/tacacs/radius) having a 'domain' privilege
### Locally authenticated users are not allowed to disable or enable local user authentication
### set local-users Enabled=true PrimaryRemoteAuthenticationMethod=none

set tacacs Enabled=false Port=49 Timeout=10 SecondaryPort=49 SecondaryTimeout=10 LoggingEnabled=false

set radius Enabled=false Port=1812 Timeout=10 SecondaryPort=1812 SecondaryTimeout=10


set role domain Order=local,ldap,radius,tacacs Operations=FirmwareUpdate,RestoreConfig,SaveConfig,SupportFiles
set role network Order=tacacs,radius,local Operations=PortMonitoring
set role server Order=ldap,local Operations=PortMonitoring
set role storage Order=radius,local Operations=

set serverid Type=Factory-Default


set session Timeout=15

set auto-deployment TftpMode=Auto


set qos CustomNoFCoE

set qos-map DOT1P Class=Best_Effort Values="0-7"

set qos-map DSCP Class=Best_Effort Values="AF11-CS7"

set qos-class Medium Enabled=true RealTime=false Share=25 EgressDOT1P=2 MaxShare=100
set qos-class Real_Time Enabled=true RealTime=true Share=10 EgressDOT1P=5 MaxShare=10
set qos-class Class1 Enabled=false RealTime=false MaxShare=100
set qos-class Class2 Enabled=false RealTime=false MaxShare=100
set qos-class Class3 Enabled=false RealTime=false MaxShare=100
set qos-class Class4 Enabled=false RealTime=false MaxShare=100
set qos-class Class5 Enabled=false RealTime=false MaxShare=100
set qos-class Best_Effort MaxShare=100

set qos-classifier Downlinks Classifiers=DOT1P,DSCP
set qos-classifier Uplinks Classifiers=DOT1P

set qos-map DOT1P Class=Best_Effort Values="0,1"
set qos-map DOT1P Class=Medium Values="2,3,4"
set qos-map DOT1P Class=Real_Time Values="5,6,7"
set qos-map DSCP Class=Best_Effort Values="AF11,AF12,AF13,CS0,CS1"
set qos-map DSCP Class=Medium Values="AF21,AF22,AF23,AF31,AF32,AF33,AF41,AF42,AF43,CS2,CS3,CS4"
set qos-map DSCP Class=Real_Time Values="CS5,CS6,CS7,EF"

set qos CustomWithFCoE

set qos-map DOT1P Class=Best_Effort Values="0-7"

set qos-map DSCP Class=Best_Effort Values="AF11-CS7"

set qos-class Medium Enabled=true RealTime=false Share=25 EgressDOT1P=2 MaxShare=100
set qos-class Real_Time Enabled=true RealTime=true Share=10 EgressDOT1P=5 MaxShare=10
set qos-class Class1 Enabled=false RealTime=false MaxShare=100
set qos-class Class2 Enabled=false RealTime=false MaxShare=100
set qos-class Class3 Enabled=false RealTime=false MaxShare=100
set qos-class Class4 Enabled=false RealTime=false MaxShare=100
set qos-class Best_Effort MaxShare=100

set qos-classifier Downlinks Classifiers=DOT1P,DSCP
set qos-classifier Uplinks Classifiers=DOT1P

set qos-map DOT1P Class=Best_Effort Values="0,1"
set qos-map DOT1P Class=Medium Values="2,3,4"
set qos-map DOT1P Class=Real_Time Values="5,6,7"
set qos-map DSCP Class=Best_Effort Values="AF11,AF12,AF13,CS0,CS1"
set qos-map DSCP Class=Medium Values="AF21,AF22,AF23,AF31,AF32,AF33,AF41,AF42,AF43,CS2,CS3,CS4"
set qos-map DSCP Class=Real_Time Values="CS5,CS6,CS7,EF"

set qos Passthrough


set domain MacType=Factory-Default

set mac-cache Enabled=true Refresh=5
set igmp Enabled=false
set enet-vlan -quiet VlanCapacity=Expanded
set statistics-throughput -quiet Enabled=true SampleRate=5m
set port-protect networkLoop=Enabled
set port-protect pauseFlood=Enabled
set lldp enhancedTlv=false
set lldp taggedLldp=false
set lacp-timer Default=Short

add uplinkset UplinkSet_OVF1385 ConnectionMode=Auto LacpTimer=Domain-Default
add uplinkport enc0:1:X1 UplinkSet=UplinkSet_OVF1385 Speed=Auto

add network-range -quiet UplinkSet=UplinkSet_OVF1385 nameprefix=Network_ vlanids=100,300 NAGs=Default SmartLink=Enabled

add network Network_iSCSI_1 -quiet NAGs=Default ConnectionMode=Failover VLanTunnel=Enabled
add uplinkport enc0:3:X3 Network=Network_iSCSI_1 Speed=Auto Role=Primary
set network Network_iSCSI_1 SmartLink=Enabled
add network Network_iSCSI_2 -quiet NAGs=Default ConnectionMode=Failover VLanTunnel=Enabled
add uplinkport enc0:4:X3 Network=Network_iSCSI_2 Speed=Auto Role=Primary
set network Network_iSCSI_2 SmartLink=Enabled
### PacketBufferOverallocationRatio is applicable only for
### HP 1/10Gb VC-Enet and HP 1/10Gb-F VC-Enet
### modules and deprecated for all other module types.

set advanced-networking -quiet PacketBufferOverallocationRatio=1 FlowControl=auto

set domain WwnType=Factory-Default


set link-dist-interval Interval=30


add profile Profile_bay5_F1385 -NoDefaultEnetConn -NoDefaultFcConn -NoDefaultFcoeConn -quiet NAG=Default HideUnusedFlexNICs=true BootMode=UEFI
add enet-connection Profile_bay5_F1385 Network=Network_100 PXE=Disabled SriovType=Disabled
add enet-connection Profile_bay5_F1385 Network=Network_300 PXE=Disabled SriovType=Disabled
add iscsi-connection Profile_bay5_F1385 SpeedType=Preferred Network=Network_iSCSI_1
### CHAP authentication is used. Username and Secret must be entered manually.
### CHAPM authentication is used. Username, Secret  and MutualUsername, MutualSecret must be entered manually.
set iscsi-boot-param Profile_bay5_F1385:1 BootOrder=Primary InitiatorName=iqn.2015-02.com.hpe:oneview-wpst23-bay5-dhcp-p Authentication=CHAPM ISCSIBootParamDHCP=Disabled TargetName=iqn.2003-10.com.lefthandnetworks:vsa-mg-116:1141:wpst23-bay5-dhcp2 LUN=0 TargetIP=192.168.21.59 TargetPort=3260 NetworkParamDHCP=Enabled Username=iqn.2015-02.com.hpe:oneview-wpst23-bay5-dhcp Secret=wpsthpvse123 MutualUsername=iqn.2015-02.com.hpe:oneview-wpst23-bay5-dhcp MutualSecret=hpvse123wpst
add iscsi-connection Profile_bay5_F1385 SpeedType=Preferred Network=Network_iSCSI_2
### CHAP authentication is used. Username and Secret must be entered manually.
### CHAPM authentication is used. Username, Secret  and MutualUsername, MutualSecret must be entered manually.
set iscsi-boot-param Profile_bay5_F1385:2 BootOrder=Secondary InitiatorName=iqn.2015-02.com.hpe:oneview-wpst23-bay5-dhcp-s Authentication=CHAPM ISCSIBootParamDHCP=Disabled TargetName=iqn.2003-10.com.lefthandnetworks:vsa-mg-116:1141:wpst23-bay5-dhcp2 LUN=0 TargetIP=192.168.21.59 TargetPort=3260 NetworkParamDHCP=Enabled Username=iqn.2015-02.com.hpe:oneview-wpst23-bay5-dhcp Secret=wpsthpvse123 MutualUsername=iqn.2015-02.com.hpe:oneview-wpst23-bay5-dhcp MutualSecret=hpvse123wpst

assign profile Profile_bay5_F1385 enc0:5

Poweroff server *
