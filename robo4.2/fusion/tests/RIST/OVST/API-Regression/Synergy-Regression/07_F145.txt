*** Settings ***
Resource    resource.txt
Documentation    Create server profiles with local storage and edit profiles with HBA RAID0

Suite Setup                     QUAL Suite Setup    ${admin_credentials}
Suite Teardown                  QUAL Suite Teardown

*** Test Cases ***
Add Server Profile with BIOS Settings
    [Tags]    LOCSERV
    [Documentation]        Create Server Profiles with BIOS settings and local storage
    Power off Servers in Profiles   ${server_profile_local_storage}
    ${responses}=  Add Server Profiles from variable   ${server_profile_local_storage}
    Run Keyword If  ${responses} is not ${null}     Wait For Task2  ${responses}   timeout=1800    interval=60
    Run Keyword If    ${expected_server_profile_local_storage} is not ${null}     Verify Resource  ${expected_server_profile_local_storage}
    Get Task Tree From Post Response  ${responses}

Edit Server Profile HBA
    [Tags]    EDITSERVHBA
    [Documentation]     Edit server profile HBA and BIOS settings
    Log   ${\n}Powering off the server ${edit_serverprofile_hba[0]['serverHardwareUri']}    console=True
    Power off Server    ${edit_serverprofile_hba[0]['serverHardwareUri']}
    ${responses}=  Edit Server Profile With Local Storage    ${edit_serverprofile_hba[0]}
    Wait For Task2    ${responses}    timeout=3000    interval=15
    Run Keyword If    ${expected_serverprofile_hba} is not ${null}     Verify Resource     ${expected_serverprofile_hba}
    Get Task Tree From Post Response  ${responses}

Edit Server Profile RAID
    [Tags]    EDITSERVRAID
    [Documentation]     Edit server profile RAID and BIOS settings
    Log   ${\n}Powering off the server ${edit_serverprofile_raid[0]['serverHardwareUri']}    console=True
    Power off Server    ${edit_serverprofile_raid[0]['serverHardwareUri']}
    ${responses}=  Edit Server Profile With Local Storage    ${edit_serverprofile_raid[0]}
    Wait For Task2    ${responses}    timeout=3000    interval=15
    Run Keyword If    ${edit_serverprofile_raid} is not ${null}     Verify Resource     ${edit_serverprofile_raid}
    Get Task Tree From Post Response  ${responses}

Remove Server Profiles with storage attached
    [Tags]    TEARDOWN     REMOVE-SPSV
    [Documentation]        Remove Server Profiles for BL servers with SAN Storage
    ${responses}=  Remove All Server Profiles Async
    Run Keyword If  ${responses} is not ${null}     Wait For Task2   ${responses}   timeout=1200    interval=10
    Run Keyword If   ${responses} is not ${Null}   Verify Server profile exists
