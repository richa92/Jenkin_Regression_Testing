*** Settings ***
Documentation     Verifying the features of F176 ie LIG , EG and LE : Get , post and delete calls 

Suite Setup 		Login to Fusion Via REST
#Suite Teardown		Run Keyword If Any Critical Tests Failed		Fatal Error		msg=Critical test case failed so test suite can't continue
Library			../UserInputs/functions.py
Resource		../Resources/resources.txt
Variables		../UserInputs/variables.py
*** Test Cases ***
		
Creation of LIG
	[Documentation]			Creating combinations of logical interconnect groups from the list provided in the variables.py file \n
	[Tags]	F176	Smoke	critical
	[setup]			Run Keywords	
    ${Lig_Length}=  Get Length  ${LIG_Names}
    :FOR  ${bay}  IN RANGE   0   ${Lig_Length}
    \	Run keyword and continue on Failure		Create LIG    ${LIG_Names[${bay}]}  ${bay_list[${bay}]}
  		
  		

***keywords ***
Create LIG
		[Arguments]    ${LIG_Name}    ${BAY_LIST}
   	    Logger		Creating LIG : ${LIG_Name}
  		${Lig_Payload}  Build LIG Payload  ${LIG_Name}    ${BAY_LIST}
  		${resp} = 	Fusion Api Create SAS Lig	${Lig_Payload}
		Validate the response	${resp}
  		
Validate the response 
	[Arguments]		${resp}
	${resp_uri} =	Get from dictionary		${resp}		uri
	Wait Until Keyword Succeeds  4 min    10 sec  Validate computedPercentComplete   ${resp}
	${resp} =	Fusion api get resource		${resp_uri}
	${taskstate} = 		Get from dictionary		${resp}		taskState
	logger		${taskstate}		DEBUG
	${taskerror} =		Get from dictionary		${resp}		taskErrors
	Run keyword If 		'${taskstate}' != 'Completed'		 Task Error		${taskerror}	${resp_uri}


Task Error
	[Arguments]		${taskerror}	${resp_uri}
	Logger	taskeror : ${taskerror}		DEBUG	
	${error_code} =		Get from dictionary		${taskerror[0]} 	errorCode
	${message} =	Get from dictionary 	${taskerror[0]}		message
	Fail	msg= Failed for the uri ${resp_uri} due to ${error_code} \n Additional Info : ${message}
	
	
	
	  		