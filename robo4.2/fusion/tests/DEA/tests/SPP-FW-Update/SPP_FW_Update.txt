*** Settings ***
Documentation     SPP Upload and Firmware Update of Enclosure, Servers and ICMs
            ...   =  USAGE =
            ...   | pybot | -L Trace | SPP_FW_Update.txt
            ...   -v APPLIANCE_IP:<OV IP> -v FUSION_USERNAME:<UName> -v  FUSION_PASSWORD:<Pwd> -v SPP_FilePath:SPPpath -v LE_Name:Logicalenclousrename
            ...   -v FirmwareBaseline:Baseline -v ForceInstallFirmware:True/False -v FirmwareUpdateOn:SharedInfrastructureAndServerProfiles/SharedInfrastructureOnly
            ...   -v LogicalInterconnectUpdateMode:parallel/orchestrated -v UpdateFirmwareOnUnmanagedInterconnect:True/False
            ...   -v FirmwareUpdateIsNonDisruptive:True/False

# CORE LIBRARIES
##############
Library           RoboGalaxyLibrary
Library           FusionLibrary
Library           MgmtFWLibrary
Library           Collections
Library           OperatingSystem

# Variables & RESOURCES
#########################
Variables         ${GIT_REPO_ROOT}/fusion/tests/DEA/variables/dea_variables.py
Resource          ${GIT_REPO_ROOT}/fusion/tests/DEA/resource/resource_all.txt
Resource          ${GIT_REPO_ROOT}/fusion/Resources/api/servers/logical_enclosure.txt
Resource          ${GIT_REPO_ROOT}/fusion/Resources/api/firmware/firmware.txt
Suite Setup       Run Keywords    Set Library Search Order  common  Log to console and log file  AND  Login to Fusion Via REST
Suite Teardown    Logout of Fusion Via REST

*** Test Cases ***
TC 01: Upload the SPP bundle and update the firmware
    [Documentation]    Upload the SPP bundle and update the firmware using the Logical Enclosure
    [Tags]    SPP    Automated
    ${resp} =     Fusion Api Upload Firmware Bundle      localfile=${SPP_FilePath}
    Sleep    120
    Power off ALL Servers
    Log to Console    Uploadsppdetails ${resp}
    ${ForceInstallFirmware}=    Convert to Boolean  ${ForceInstallFirmware}
    ${UpdateFirmwareOnUnmanagedInterconnect}=    Convert to Boolean  ${UpdateFirmwareOnUnmanagedInterconnect}
    ${FirmwareUpdateIsNonDisruptive}=    Convert to Boolean  ${FirmwareUpdateIsNonDisruptive}
    Update Logical Enclosure Firmware    ${LE_Name}  ${FirmwareBaseline}  ${ForceInstallFirmware}  ${FirmwareUpdateOn}  ${LogicalInterconnectUpdateMode}  
    ...    ${UpdateFirmwareOnUnmanagedInterconnect}  ${FirmwareUpdateIsNonDisruptive}
    Sleep  60