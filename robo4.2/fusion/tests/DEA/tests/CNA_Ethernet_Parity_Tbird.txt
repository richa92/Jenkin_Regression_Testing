*** Settings ***

Documentation     CNA_Ethernet_Parity_Tbird.txt - Ethernet Parity Test for Tbird
            ...   =  USAGE =
            ...   | pybot | -L Trace | -v APPLIANCE_IP:<APP_IPv4-IPv6> | SSH_HOST:10.15.13.254 | -v Adapter_Test:<Adapter_Name> | -v Enclosures:<Encl_Name> | CNA_Ethernet_Parity_Tbird.txt
            ...   =  Parameters  =
            ...   Fill in command required field for APPLIANCE_IP, Adapter_Test, and Enclosures.

Variables         ../variables/dea_variables.py
Variables         ../variables/data_variables.py
Resource          ../resource/resource_all.txt
Resource          ../resource/Altair_Resource.txt

Library           RoboGalaxyLibrary
Library           FusionLibrary
Library           Selenium2Library
Library           Collections
Library           OperatingSystem
Library           AltairLibrary

Suite Setup       Run Keywords    Login to Fusion Via REST    AND    Clean UP Environment    AND    Setup Ethernet Appliance

*** Test Cases ***

TC 108: Validate PXE boot for Tbird Gen9 server with Primary Boot in Legacy mode
    [Documentation]    Apply server profile with Primary Boot PXE and Legacy mode. Power on server and validate it successfully PXE for ${Adapter_Test}
    [Tags]    DEA    API    Automated    CNA    PXE    GEN9
    ${Adapter_Model} =  Get Adapter Name from List    ${Adapter_Test}  ${Tbird_Adapter_Models}
    ${Gen9_list} =  Get Server Type List    Gen9
    Should Not Be Empty    ${Gen9_list}    msg=No Gen9 server present in the enclosure
    ${result_list} =  Get Adapter Bay List    ${Gen9_list}  ${Adapter_Model}
    Should Not Be Empty    ${result_list}    msg=No Gen9 server with ${Adapter_Test} adapter present in the enclosure
    Power Off ALL Servers
    Remove All Server Profiles
    :FOR    ${x}    IN    @{result_list}
    \    ${server_profile_body}=    Build Ethernet Primary/Secondary Boot Legacy Mode Server Profile body     ${x}    ${server_profiles_eth[0]}  ${enet_connection_primary_boot}
    \    Create Server Profile    ${server_profile_body}
    \    ${server_state}=    Get Server State    ${x}
    \    Should Be Equal    ${server_state}    ProfileApplied
    \    ${server_status}=    Get Server Status    ${x}
    \    Should Be Equal    ${server_status}    OK
    \    ${profile_status}=    Get Server Profile Status    ${x}
    \    Should Be Equal    ${server_status}    OK
    Altair API Login
    ${OVsn_list} =    Get Server Serial Number from List   ${result_list}
    Remove Server from Altair    ${OVsn_list}
    Power on Server and PXE Boot    ${result_list}
    Log to Console    Wait 12 mins for server to apply configuration and boot up
    SLEEP    700
    ${Asn_list}=    Get Server Serial Number and Operating System from Altair
    Validate server PXE    ${OVsn_list}  ${Asn_list}

TC 109: Validate PXE boot for Tbird Gen9 server with Secondary Boot in Legacy mode
    [Documentation]    Apply server profile with Secondary Boot PXE and Legacy mode. Power on server and validate it successfully PXE for ${Adapter_Test}
    [Tags]    DEA    API    Automated    CNA    PXE    GEN9
    ${Adapter_Model} =  Get Adapter Name from List    ${Adapter_Test}  ${Tbird_Adapter_Models}
    ${Gen9_list} =  Get Server Type List    Gen9
    Should Not Be Empty    ${Gen9_list}    msg=No Gen9 server present in the enclosure
    ${result_list} =  Get Adapter Bay List    ${Gen9_list}  ${Adapter_Model}
    Should Not Be Empty    ${result_list}    msg=No Gen9 server with ${Adapter_Test} adapter present in the enclosure
    Power Off ALL Servers
    Remove All Server Profiles
    :FOR    ${x}    IN    @{result_list}
    \    ${server_profile_body}=    Build Ethernet Primary/Secondary/Secondary Boot Legacy Mode Server Profile body     ${x}    ${server_profiles_eth[0]}  ${enet_connection_secondary_boot}
    \    Create Server Profile    ${server_profile_body}
    \    ${server_state}=    Get Server State    ${x}
    \    Should Be Equal    ${server_state}    ProfileApplied
    \    ${server_status}=    Get Server Status    ${x}
    \    Should Be Equal    ${server_status}    OK
    \    ${profile_status}=    Get Server Profile Status    ${x}
    \    Should Be Equal    ${server_status}    OK
    Altair API Login
    ${OVsn_list} =    Get Server Serial Number from List   ${result_list}
    Remove Server from Altair    ${OVsn_list}
    Power on Server and PXE Boot    ${result_list}
    Log to Console    Wait 12 mins for server to apply configuration and boot up
    SLEEP    700
    ${Asn_list}=    Get Server Serial Number and Operating System from Altair
    Validate server PXE    ${OVsn_list}  ${Asn_list}

TC 110: Validate PXE boot for Tbird Gen9 server with Primary Boot in UEFI mode
    [Documentation]    Apply server profile with Primary Boot PXE and UEFI mode. Power on server and validate it successfully PXE for ${Adapter_Test}
    [Tags]    DEA    API    Automated    CNA    PXE    GEN9
    ${Adapter_Model} =  Get Adapter Name from List    ${Adapter_Test}  ${Tbird_Adapter_Models}
    ${Gen9_list} =  Get Server Type List    Gen9
    Should Not Be Empty    ${Gen9_list}    msg=No Gen9 server present in the enclosure
    ${result_list} =  Get Adapter Bay List    ${Gen9_list}  ${Adapter_Model}
    Should Not Be Empty    ${result_list}    msg=No Gen9 server with ${Adapter_Test} adapter present in the enclosure
    Power Off ALL Servers
    Remove All Server Profiles
    :FOR    ${x}    IN    @{result_list}
    \    ${server_profile_body}=    Build Ethernet Primary/Secondary Boot UEFI Mode Server Profile body     ${x}    ${server_profiles_eth[0]}  ${enet_connection_primary_boot}
    \    Create Server Profile    ${server_profile_body}
    \    ${server_state}=    Get Server State    ${x}
    \    Should Be Equal    ${server_state}    ProfileApplied
    \    ${server_status}=    Get Server Status    ${x}
    \    Should Be Equal    ${server_status}    OK
    \    ${profile_status}=    Get Server Profile Status    ${x}
    \    Should Be Equal    ${server_status}    OK
    Altair API Login
    ${OVsn_list} =    Get Server Serial Number from List   ${result_list}
    Remove Server from Altair    ${OVsn_list}
    Power on Server and PXE Boot    ${result_list}
    Log to Console    Wait 12 mins for server to apply configuration and boot up
    SLEEP    700
    ${Asn_list}=    Get Server Serial Number and Operating System from Altair
    Validate server PXE    ${OVsn_list}  ${Asn_list}

TC 111: Validate PXE boot for Tbird Gen9 server with Secondary Boot in UEFI mode
    [Documentation]    Apply server profile with Secondary Boot PXE and UEFI mode. Power on server and validate it successfully PXE for ${Adapter_Test}
    [Tags]    DEA    API    Automated    CNA    PXE    GEN9
    ${Adapter_Model} =  Get Adapter Name from List    ${Adapter_Test}  ${Tbird_Adapter_Models}
    ${Gen9_list} =  Get Server Type List    Gen9
    Should Not Be Empty    ${Gen9_list}    msg=No Gen9 server present in the enclosure
    ${result_list} =  Get Adapter Bay List    ${Gen9_list}  ${Adapter_Model}
    Should Not Be Empty    ${result_list}    msg=No Gen9 server with ${Adapter_Test} adapter present in the enclosure
    Power Off ALL Servers
    Remove All Server Profiles
    :FOR    ${x}    IN    @{result_list}
    \    ${server_profile_body}=    Build Ethernet Primary/Secondary/Secondary Boot UEFI Mode Server Profile body     ${x}    ${server_profiles_eth[0]}  ${enet_connection_secondary_boot}
    \    Create Server Profile    ${server_profile_body}
    \    ${server_state}=    Get Server State    ${x}
    \    Should Be Equal    ${server_state}    ProfileApplied
    \    ${server_status}=    Get Server Status    ${x}
    \    Should Be Equal    ${server_status}    OK
    \    ${profile_status}=    Get Server Profile Status    ${x}
    \    Should Be Equal    ${server_status}    OK
    Altair API Login
    ${OVsn_list} =    Get Server Serial Number from List   ${result_list}
    Remove Server from Altair    ${OVsn_list}
    Power on Server and PXE Boot    ${result_list}
    Log to Console    Wait 12 mins for server to apply configuration and boot up
    SLEEP    700
    ${Asn_list}=    Get Server Serial Number and Operating System from Altair
    Validate server PXE    ${OVsn_list}  ${Asn_list}

TC 112: Validate PXE boot for Tbird Gen9 server with Primary Boot in UEFIOptimized mode
    [Documentation]    Apply server profile with Primary Boot PXE and UEFIOptimized mode. Power on server and validate it successfully PXE for ${Adapter_Test}
    [Tags]    DEA    API    Automated    CNA    PXE    GEN9
    ${Adapter_Model} =  Get Adapter Name from List    ${Adapter_Test}  ${Tbird_Adapter_Models}
    ${Gen9_list} =  Get Server Type List    Gen9
    Should Not Be Empty    ${Gen9_list}    msg=No Gen9 server present in the enclosure
    ${result_list} =  Get Adapter Bay List    ${Gen9_list}  ${Adapter_Model}
    Should Not Be Empty    ${result_list}    msg=No Gen9 server with ${Adapter_Test} adapter present in the enclosure
    Power Off ALL Servers
    Remove All Server Profiles
    :FOR    ${x}    IN    @{result_list}
    \    ${server_profile_body}=    Build Ethernet Primary/Secondary Boot UEFIOptimized Mode Server Profile body     ${x}    ${server_profiles_eth[0]}  ${enet_connection_primary_boot}
    \    Create Server Profile    ${server_profile_body}
    \    ${server_state}=    Get Server State    ${x}
    \    Should Be Equal    ${server_state}    ProfileApplied
    \    ${server_status}=    Get Server Status    ${x}
    \    Should Be Equal    ${server_status}    OK
    \    ${profile_status}=    Get Server Profile Status    ${x}
    \    Should Be Equal    ${server_status}    OK
    Altair API Login
    ${OVsn_list} =    Get Server Serial Number from List   ${result_list}
    Remove Server from Altair    ${OVsn_list}
    Power on Server and PXE Boot    ${result_list}
    Log to Console    Wait 12 mins for server to apply configuration and boot up
    SLEEP    700
    ${Asn_list}=    Get Server Serial Number and Operating System from Altair
    Validate server PXE    ${OVsn_list}  ${Asn_list}

TC 113: Validate PXE boot for Tbird Gen9 server with Secondary Boot in UEFIOptimized
    [Documentation]    Apply server profile with Secondary Boot PXE and UEFIOptimized mode. Power on server and validate it successfully PXE for ${Adapter_Test}
    [Tags]    DEA    API    Automated    CNA    PXE    GEN9
    ${Adapter_Model} =  Get Adapter Name from List    ${Adapter_Test}  ${Tbird_Adapter_Models}
    ${Gen9_list} =  Get Server Type List    Gen9
    Should Not Be Empty    ${Gen9_list}    msg=No Gen9 server present in the enclosure
    ${result_list} =  Get Adapter Bay List    ${Gen9_list}  ${Adapter_Model}
    Should Not Be Empty    ${result_list}    msg=No Gen9 server with ${Adapter_Test} adapter present in the enclosure
    Power Off ALL Servers
    Remove All Server Profiles
    :FOR    ${x}    IN    @{result_list}
    \    ${server_profile_body}=    Build Ethernet Primary/Secondary/Secondary Boot UEFIOptimized Mode Server Profile body     ${x}    ${server_profiles_eth[0]}  ${enet_connection_secondary_boot}
    \    Create Server Profile    ${server_profile_body}
    \    ${server_state}=    Get Server State    ${x}
    \    Should Be Equal    ${server_state}    ProfileApplied
    \    ${server_status}=    Get Server Status    ${x}
    \    Should Be Equal    ${server_status}    OK
    \    ${profile_status}=    Get Server Profile Status    ${x}
    \    Should Be Equal    ${server_status}    OK
    Altair API Login
    ${OVsn_list} =    Get Server Serial Number from List   ${result_list}
    Remove Server from Altair    ${OVsn_list}
    Power on Server and PXE Boot    ${result_list}
    Log to Console    Wait 12 mins for server to apply configuration and boot up
    SLEEP    700
    ${Asn_list}=    Get Server Serial Number and Operating System from Altair
    Validate server PXE    ${OVsn_list}  ${Asn_list}