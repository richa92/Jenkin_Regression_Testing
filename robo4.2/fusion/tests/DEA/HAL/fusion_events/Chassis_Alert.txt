*** Settings ***
Documentation     Test suite to validate Chassis related events on OneView and FLM
...               It covers testing of:
...               ChassisAmbientThermal
...               ChassisAmbientThermalCleared
...               = GENERIC USAGE =
...               | pybot | -v ENC_SERIAL_NO:[enclosure serial #] | -v APPLIANCE_IP:<ipv4> | -v CIM_Linux_IP:<ipv4> |-v GIT_REPO_ROOT: | Chassis_Alert.txt |
...               = Variables =
...               | GIT_REPO_ROOT | Required: Repo root path if NOT defined in environment variable this is mgmtfw root location|
...               | ENC_SERIAL_NO | Optional: If omitted, will use the 1st enclosure detected in OV |
...               | APPLIANCE_IP | Required: OneView IPv4 address |
...               | CIM_Linux_IP | Required:CI Manager ipv4 under test |

Suite Setup       Configure Events Test Environment
Suite Teardown    Run Keywords    Logout of EM RIS    AND    Logout of Fusion Via REST

Variables         ${GIT_REPO_ROOT}/fusion/tests/DEA/variables/dea_variables.py
Variables         ${GIT_REPO_ROOT}/mgmtfw/tests/thunderbird/variables/tBird_variables.py
Resource          ${GIT_REPO_ROOT}${RESOURCE_ROOT}/resource_all.txt
Resource          ${GIT_REPO_ROOT}${EM_RESOURCE_ROOT}/thunderbird_all.txt
Library           RoboGalaxyLibrary
Library           MgmtFWLibrary
Library           json

*** Test cases ***

TC 01: Verify ChassisAmbientThermal and ChassisAmbientThermalCleared events
    [Documentation]    This test will verify ChassisAmbientThermal and ChassisAmbientThermalCleared events
    [Tags]    Chassis    Alert    Events    FLM2.00    OV3.10    QXCR1001529410
    ${last_fusion_event_id}=    get last fusion event ID
    # Future #
    # Execute Diags command to generate ChassisAmbientThermal alert
    #Verifying resource updated event in diags audit log with 50 recent entries
    ${diags_50}    ${diags_auditlog_file_path}=    Get Diags Audit Log 50 Recent Entries
    Set Test Variable    ${EM_Event_Logger}    ${diags_auditlog_file_path}
    Verify Audit Log Alert Event    ${EL_Chassis_Amb_Temp_Warning}    ${Chassis_Device}    1    450
    Verify Fusion Event Sent By EM    ${EL_Chassis_Amb_Temp_Warning}    ${last_fusion_event_id}
    # Future #
    # Execute Diags command to generate ChassisAmbientThermalCleared alert
    Verify Audit Log Alert Event    ${EL_Chassis_Amb_Temp_Cleared}    ${Chassis_Device}    1    450
    Verify Fusion Event Sent By EM    ${EL_Chassis_Amb_Temp_Cleared}    ${last_fusion_event_id}
    [Teardown]    Run Keyword If Test Failed    #Execute Diags command to generate ChassisAmbientThermalCleared alert