*** Settings ***
Documentation       Run this Automation Test Suite with features like SSH currently included in this suite.
...
Resource            ../../../../Resources/api/fusion_api_resource.txt
Resource            ../InternalResource.txt
Resource            NitroSSH.txt
Library             ../InternalFunctions.py
Variables           ../Data_Variables.py

Library             RoboGalaxyLibrary
Library             FusionLibrary

*** Test cases ***
Login
    [Documentation]    Login
    Set Log Level    TRACE
    Fusion Api Login Appliance      ${APPLIANCE_IP}     ${Appliance_credentials}

Set Suite Variables before running Automation Suite
    [Documentation]    Set Suite Variables before running Automation Suite
    Set Suite Variables before running Automation Suite  ${INTERCONNECT1}   ${INTERCONNECT2}

Update ICM with Latest Firmware
    [Documentation]    Update ICM with Latest Firmware
    Download ICM Firmware    ${linuxip}    ${linuxuser}    ${linuxpassword}    ${firmwareurl}    ${firmwareupdatepackage}    ${NitroIP1_IPV6}%eth1
    Copy Firmware to ICM     ${linuxip}    ${linuxuser}    ${linuxpassword}    ${firmwareurl}    ${firmwareupdatepackage}    ${NitroIP1_IPV6}%eth1
    FirmwareUpgrade Release Notes    ${linuxip}    ${linuxuser}    ${linuxpassword}    ${firmwareurl}    ${firmwareupdatepackage}    ${NitroIP1_IPV6}%eth1
    Sleep    60 secs
    Copy Firmware to ICM     ${linuxip}    ${linuxuser}    ${linuxpassword}    ${firmwareurl}    ${firmwareupdatepackage}    ${NitroIP2_IPV6}%eth1
    FirmwareUpgrade Release Notes    ${linuxip}    ${linuxuser}    ${linuxpassword}    ${firmwareurl}    ${firmwareupdatepackage}    ${NitroIP2_IPV6}%eth1
    Sleep    180 secs

Get Random Password for nitro
    [Documentation]    Get Random Password for nitro
    ${Random_Password}=    Get Random Password for nitro  ${APPLIANCE_IP}  ${SSH_USER}  ${SSH_PASS}  ${Enclosure1}   ${Enc1_nitro_Module_Bay_No}
    Set Suite Variable    ${Random_Password}

Verify Firmware updated to latest
    [Documentation]    Verify Firmware updated to latest
    ${ICM_version} =    Check ICM Firmware version    ${APPLIANCE_IP}  ${Random_Password}  ${NitroIP1_IPV4}
    ${Firmware_version} =    Split String From Right    ${firmwareupdatepackage}    -    4
    ${Firmware_version} =    Split String    ${Firmware_version[0]}    -    1
    Log to Console    ${Firmware_version}
    ${Firmware_version}=    Get From List    ${Firmware_version}    1
    Log to Console    ${Firmware_version}
    should contain    ${ICM_version}    ${Firmware_version}
