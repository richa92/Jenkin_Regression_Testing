#!/bin/env python27
# (C) Copyright 2018 Hewlett Packard Enterprise Development LP
"""
This module exposes the custom keyword  | Configure OS Networks |. It executes
the OS specific configure os network based on key - type.
"""
from redhat import RedHatNetConfig
from robot.api.deco import keyword
from RoboGalaxyLibrary.utilitylib.logging import logger as log
from vmware import VMwareNetConfig


class ConfigOSNetwork(object):
    """
    Wrapper class for network configuration
    """
    @keyword(name="Configure OS Networks")
    def configure_network(self, body):
        """
        Calls the appropriate configure network method based on the OS type

        Example:
          @{r}=    RG Configure Networks | <config>

        <config> is a dictionary and the supported key-value pairs are available
        in the respective functions.

        :param dict body: Key-value pairs containing network configuration
        :return list: List of network configuration status
        """
        if not body.get('host'):
            log.info('Target system information is required')
            raise AssertionError('Host information dictionary is missing.')

        t = body.get('host').get('os', None)
        if t is None:
            log.info('Operating System type is required')
            raise AssertionError('Operating system type attribute missing')

        if "redhat" in t.lower() or "red hat" in t.lower() or \
                "rhel" in t.lower():
            return RedHatNetConfig().configure_network(body)
        elif "vmware" in t.lower() or "esx" in t.lower():
            return VMwareNetConfig().configure_network(body)
        else:
            log.info('{} not supported'.format(body['host']['os']))
            raise AssertionError('OS type not supported')
