import paramiko
import os
import ssh


def sshcon(kvm_host, kvm_user, kvm_pass, cmd):
    client = paramiko.SSHClient()
    client.set_missing_host_key_policy(paramiko.AutoAddPolicy())
# client.load_host_keys(os.path.expanduser(os.path.join("~", ".ssh", "known_hosts")))
    client.connect(kvm_host, username=kvm_user, password=kvm_pass)
    stdin, stdout, stderr = client.exec_command(cmd)
    out = stdout.read()
    return out


# output=sshcon('amoghgoldeni.pulsar.net','root','hpvse1','service opentsack-nova-scheduler status')
# print output

    # client.exec_command(cmd)
# status = stdout.channel.recv_exit_status()

'''
        try:
            output = stdout.read()
        except:
            raise Exception("SSH Sockket timeout")
            client.close()
        return status, output
'''


'''
        sftp = client.open_sftp()
           sftp.put('C:\ ','/glance_images/images/0676aecb-4ca7-4439-830f-bdc3711b6df1')
'''

# sshcon('192.168.2.184','root','hpvse1')


'''
        client.exec_command(cmd)
        stdin, stdout, stderr= client.exec_command(cmd)
        status = stdout.channel.recv_exit_status()
        try:
            output = stdout.read()
        except:
            raise Exception("SSH Scoket timeout")
            client.close()
        return status, output
'''
